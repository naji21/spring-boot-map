/*
 Author: Naji
 Date: 2020-08-13 
*/

!function(e,t){"use strict";if(void 0===t)return alert("need for jQuery !");e._$=t,e.naji={version:"1.0.0",etc:{},toc:{},util:{},layer:{},control:{},service:{},manager:{},baseMap:{},animation:{}};var a=location.href.indexOf(location.host)+location.host.length,n=location.href.substring(a,location.href.indexOf("/",a+1));e.naji.contextPath=n,_$(document).ready(function(){e.njMapsPlatform=e.naji})}(window,jQuery),function(){"use strict";ol.layer.Vector.prototype.animateFeature=function(e){var n=this,i=e,o=0,t=n.on("postcompose",function(e){if(n.isStop)return i.extent=!1,void(e.frameState.animate=!0);var t=n.animations[o],a=t.getProperties();e.frameState.extent;i.vectorContext=e.vectorContext,i.frameState=e.frameState,i.extent||(i.extent=e.frameState.extent,i.start=e.frameState.time-i.interval,i.context=e.context);i.time=e.frameState.time-i.start,i.elapsed=i.time/a.duration,1<i.elapsed&&(i.elapsed=1);t.animate(i)||(i.nowNB++,i.nowNB<a.repeat?i.extent=!1:o<n.animations.length-1&&(o++,i.nowNB=0,i.extent=!1));e.frameState.animate=!0});return n.changed&&n.changed(),t}}(),function(){"use strict";ol.interaction.MouseWheelZoom.handleEvent=function(e){var t=this.getMap(),a=e.type;if(a!==ol.events.EventType.WHEEL&&a!==ol.events.EventType.MOUSEWHEEL)return!0;if(t.scrollCallBack){if(t.scrollCallBack.getAltKeyOnly()&&!ol.events.condition.altKeyOnly(e))return t.scrollCallBack.run(),!0;t.scrollCallBack.clear(),e.originalEvent.preventDefault(),e.originalEvent.stopPropagation()}else e.originalEvent.preventDefault(),e.originalEvent.stopPropagation();var n,i=e.map,o=e.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=e.coordinate),e.type==ol.events.EventType.WHEEL?(n=o.deltaY,ol.has.FIREFOX&&o.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(n/=ol.has.DEVICE_PIXEL_RATIO),o.deltaMode===WheelEvent.DOM_DELTA_LINE&&(n*=40)):e.type==ol.events.EventType.MOUSEWHEEL&&(n=-o.wheelDeltaY,ol.has.SAFARI&&(n/=3)),0===n)return!1;var r=Date.now();if(void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(n)<4?ol.interaction.MouseWheelZoom.Mode_.TRACKPAD:ol.interaction.MouseWheelZoom.Mode_.WHEEL),this.mode_===ol.interaction.MouseWheelZoom.Mode_.TRACKPAD){var s=i.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):s.setHint(ol.ViewHint.INTERACTING,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);var l=s.getResolution()*Math.pow(2,n/this.trackpadDeltaPerZoom_),p=s.getMinResolution(),c=s.getMaxResolution(),u=0;if(l<p?(l=Math.max(l,p/this.trackpadZoomBuffer_),u=1):c<l&&(l=Math.min(l,c*this.trackpadZoomBuffer_),u=-1),this.lastAnchor_){var y=s.calculateCenterZoom(l,this.lastAnchor_);s.setCenter(s.constrainCenter(y))}return s.setResolution(l),0===u&&this.constrainResolution_&&s.animate({resolution:s.constrainResolution(l,0<n?-1:1),easing:ol.easing.easeOut,anchor:this.lastAnchor_,duration:this.duration_}),0<u?s.animate({resolution:p,easing:ol.easing.easeOut,anchor:this.lastAnchor_,duration:500}):u<0&&s.animate({resolution:c,easing:ol.easing.easeOut,anchor:this.lastAnchor_,duration:500}),this.startTime_=r,!1}this.delta_+=n;var d=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),d),!1}}(),function(){"use strict";ol.interaction.njMapPointer=function(e){var t=e||{};if(ol.interaction.Pointer.call(this,{handleEvent:ol.interaction.njMapPointer.prototype.handleEvent,handleDownEvent:ol.interaction.njMapPointer.prototype.handleDownEvent,handleDragEvent:ol.interaction.njMapPointer.prototype.handleDragEvent,handleMoveEvent:ol.interaction.njMapPointer.prototype.handleMoveEvent,handleUpEvent:ol.interaction.njMapPointer.prototype.handleUpEvent}),this.dragEnd_=t.dragEnd?t.dragEnd:null,this.clickEnd_=t.clickEnd?t.clickEnd:null,this.layerFilter_=null,this.coordinate_=null,this.cursor_="pointer",this.feature_=null,this.previousCursor_=null,t.layers)if("function"==typeof t.layers)this.layerFilter_=t.layers;else{var a=t.layers;this.layerFilter_=function(e){return ol.array.includes(a,e)}}else this.layerFilter_=ol.functions.TRUE},ol.inherits(ol.interaction.njMapPointer,ol.interaction.Pointer),ol.interaction.njMapPointer.prototype.handleDownEvent=function(a){return!!a.map.forEachFeatureAtPixel(a.pixel,function(e,t){if(ol.functions.TRUE(e,t)&&e)return this.feature_=e,this.coordinate_=a.coordinate,e}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:0})},ol.interaction.njMapPointer.prototype.handleDragEvent=function(e){e.map;if(this.dragEnd_&&this.feature_){var t=e.coordinate[0]-this.coordinate_[0],a=e.coordinate[1]-this.coordinate_[1];this.feature_.getGeometry().translate(t,a),this.coordinate_[0]=e.coordinate[0],this.coordinate_[1]=e.coordinate[1],this.dragEnd_.call(this,this.feature_)}return!0},ol.interaction.njMapPointer.prototype.handleMoveEvent=function(e){if(this.cursor_){var t=e.map,a=t.getViewport();t.forEachFeatureAtPixel(e.pixel,function(e,t){if(ol.functions.TRUE(e,t)&&e)return e}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:0})?a.style.cursor!=this.cursor_&&(this.previousCursor_=a.style.cursor,a.style.cursor=this.cursor_):void 0!==this.previousCursor_&&(a.style.cursor=this.previousCursor_,this.previousCursor_=void 0)}},ol.interaction.njMapPointer.prototype.handleUpEvent=function(){return this.coordinate_=null,this.feature_=null,!1},ol.interaction.njMapPointer.prototype.handleEvent=function(e){if(!(e instanceof ol.MapBrowserPointerEvent))return!0;var t=e.map;if(this.clickEnd_&&ol.events.condition.singleClick(e)){var a=t.forEachFeatureAtPixel(e.pixel,function(e,t){if(ol.functions.TRUE(e,t)&&e)return e}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:0});this.clickEnd_.call(this,a)}var n=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==ol.MapBrowserEventType.POINTERDRAG)this.handleDragEvent_(e);else if(e.type==ol.MapBrowserEventType.POINTERUP){var i=this.handleUpEvent_(e);this.handlingDownUpSequence=i&&0<this.targetPointers.length}}else if(e.type==ol.MapBrowserEventType.POINTERDOWN){var o=this.handleDownEvent_(e);this.handlingDownUpSequence=o,n=this.shouldStopEvent(o)}else e.type==ol.MapBrowserEventType.POINTERMOVE&&this.handleMoveEvent_(e);return!n}}(),function(_){!function(e){var t,a,n=document.attachEvent,i=!1,o=e.fn.resize;if(e.fn.resize=function(e){return this.each(function(){this==_?o.call(jQuery(this),e):addResizeListener(this,e)})},e.fn.removeResize=function(e){return this.each(function(){removeResizeListener(this,e)})},!n){var r=(a=_.requestAnimationFrame||_.mozRequestAnimationFrame||_.webkitRequestAnimationFrame||function(e){return _.setTimeout(e,20)},function(e){return a(e)}),s=(t=_.cancelAnimationFrame||_.mozCancelAnimationFrame||_.webkitCancelAnimationFrame||_.clearTimeout,function(e){return t(e)});function l(e){var t=e.__resizeTriggers__,a=t.firstElementChild,n=t.lastElementChild,i=a.firstElementChild;n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight,i.style.width=a.offsetWidth+1+"px",i.style.height=a.offsetHeight+1+"px",a.scrollLeft=a.scrollWidth,a.scrollTop=a.scrollHeight}function p(t){var a=this;l(this),this.__resizeRAF__&&s(this.__resizeRAF__),this.__resizeRAF__=r(function(){var e;((e=a).offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height)&&(a.__resizeLast__.width=a.offsetWidth,a.__resizeLast__.height=a.offsetHeight,a.__resizeListeners__.forEach(function(e){e.call(a,t)}))})}var c=!1,u="",y="animationstart",d="Webkit Moz O ms".split(" "),h="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),g="",M=document.createElement("fakeelement");if(void 0!==M.style.animationName&&(c=!0),!1===c)for(var m=0;m<d.length;m++)if(void 0!==M.style[d[m]+"AnimationName"]){(g=d[m])+"Animation",u="-"+g.toLowerCase()+"-",y=h[m],c=!0;break}var j="resizeanim",f="@"+u+"keyframes "+j+" { from { opacity: 0; } to { opacity: 0; } } ",v=u+"animation: 1ms "+j+"; "}_.addResizeListener=function(t,e){n?t.attachEvent("onresize",e):(t.__resizeTriggers__||("static"==getComputedStyle(t).position&&(t.style.position="relative"),function(){if(!i){var e=(f||"")+".resize-triggers { "+(v||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',t=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e)),t.appendChild(a),i=!0}}(),t.__resizeLast__={},t.__resizeListeners__=[],(t.__resizeTriggers__=document.createElement("div")).className="resize-triggers",t.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',t.appendChild(t.__resizeTriggers__),l(t),t.addEventListener("scroll",p,!0),y&&t.__resizeTriggers__.addEventListener(y,function(e){e.animationName==j&&l(t)})),t.__resizeListeners__.push(e))},_.removeResizeListener=function(e,t){n?e.detachEvent("onresize",t):(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),e.__resizeListeners__.length||(e.removeEventListener("scroll",p),e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)))}}(jQuery)}(window),function(){"use strict";naji.njMap=function(o){var r=this;return this.olMap=null,this.mapCRS=null,this.maxExtent=null,this.useAltKeyOnly=null,this.layers=null,this.dataViewId=null,this.loadingSrcDiv=null,function(){var e=o||{};r.layers=[],r.mapCRS=void 0!==e.crs?e.crs.toUpperCase():"EPSG:3857",r.maxExtent=ol.proj.get(r.mapCRS).getExtent(),r.useAltKeyOnly="boolean"==typeof e.useAltKeyOnly&&e.useAltKeyOnly;var t=e.center;Array.isArray(t)||(t=[0,0]);var a=e.useMaxExtent?ol.proj.get(r.mapCRS).getExtent():void 0,n=new ol.View({zoom:2,center:t,extent:a,projection:r.mapCRS});r.olMap=new ol.Map({target:e.target,layers:[],renderer:"canvas",controls:r._createDefaultControls(),interactions:r._createDefaultInteractions(),view:n}),r.dataViewId=r.olMap.getViewport().getAttribute("data-view"),r._createScrollElement(),r._createLoadingElement(),r.olMap.on("change:view",function(){var e=r.olMap.getView().getProjection().getCode();r.mapCRS=e,r.maxExtent=ol.proj.get(r.mapCRS).getExtent();for(var t=r.olMap.getOverlays().getArray(),a=t.length-1;0<=a;a--){var n=t[a].get("origin");if(n){var i=ol.proj.transform(n.position,n.projection,r.mapCRS);t[a].setPosition(i),t[a].set("CRS",r.mapCRS)}}naji.njMapConfig.resetLoading(r.dataViewId)});var i=e.target instanceof Element?e.target:"#"+e.target;r.dataViewId=ol.getUid(n),_$(i).resize(function(){r.refresh()}),_$(window).resize(function(){r.refresh()}),console.log("####### njMap Init #######"),console.log("Projection : "+r.mapCRS)}(),{_this:r,refresh:r.refresh,getCRS:r.getCRS,getResolutions:r.getResolutions,getMatrixIds:r.getMatrixIds,getMap:r.getMap,getMaxExtent:r.getMaxExtent,setExtent:r.setExtent,getLayers:r.getLayers,getLayerById:r.getLayerById,getLayerByName:r.getLayerByName,getLayerByKey:r.getLayerByKey,setAltKeyOnly:r.setAltKeyOnly,removeLayer:r.removeLayer,addWMSLayer:r.addWMSLayer,addWFSLayer:r.addWFSLayer,addWCSLayer:r.addWCSLayer,addGSSWMTSLayer:r.addGSSWMTSLayer,addWMTSLayer:r.addWMTSLayer,addVectorLayer:r.addVectorLayer,addClusterLayer:r.addClusterLayer,addVector3DLayer:r.addVector3DLayer,calculateScale:r.calculateScale,getDataViewId:r.getDataViewId,getScaleForZoom:r.getScaleForZoom,setLoadingVisible:r.setLoadingVisible,removeAllListener:r.removeAllListener,removeAllInteraction:r.removeAllInteraction,setActiveAllInteraction:r.setActiveAllInteraction}},naji.njMap.prototype._createScrollElement=function(){var e=this._this||this,t='.ol-viewport[data-view="'+e.dataViewId+'"]',a=document.querySelector(t),n=document.createElement("div");n.setAttribute("altText",""),n.style.top="0px",n.style.zIndex=2,n.style.opacity=0,n.style.width="100%",n.style.height="100%",n.style.position="absolute",n.style.pointerEvents="none",n.style.transitionDuration="1s",n.style.backgroundColor="rgba( 0, 0, 0, 0.5 )";var i=document.createElement("p");i.textContent="지도를 확대/축소하려면 Alt를 누른 채 스크롤하세요.",i.style.left="0px",i.style.right="0px",i.style.top="50%",i.style.color="white",i.style.fontSize="25px",i.style.margin="0 auto",i.style.textAlign="center",i.style.position="absolute",i.style.transform="translateY(-50%)",n.appendChild(i),a.insertBefore(n,a.firstChild),e.olMap.scrollCallBack=new function(e,t){var a=this;function n(){a.altElement.style.opacity=0,a.altElement.style.transitionDuration="0.8s"}return this.tId=null,this.altElement=null,this.getAltKeyOnly=null,i=e,o=t,a.altElement=i,a.getAltKeyOnly=o,this.run=function(){a.altElement.style.opacity=1,a.altElement.style.transitionDuration="0.3s",window.clearTimeout(a.tId),a.tId=window.setTimeout(function(){n()},1500)},this.clear=function(){window.clearTimeout(a.tId),n()},{run:a.run,clear:a.clear,getAltKeyOnly:a.getAltKeyOnly};var i,o}(n,function(){return e.useAltKeyOnly})},naji.njMap.prototype._createLoadingElement=function(){var t=this._this||this,e='.ol-viewport[data-view="'+t.dataViewId+'"]',a=document.querySelector(e),n=document.createElement("div");n.id="loadingDIV",n.style.zIndex=1,n.style.top="0px",n.style.left="0px",n.style.right="0px",n.style.bottom="0px",n.style.display="none",n.style.margin="auto",n.style.position="absolute",n.style.pointerEvents="none",t.loadingSrcDiv=new Image,t.loadingSrcDiv.src=naji.njMapConfig.getLoadingImg(),t.loadingSrcDiv.onload=function(e){n.style.width=e.target.width+"px",n.style.height=e.target.height+"px",n.appendChild(t.loadingSrcDiv),a.insertBefore(n,a.firstChild)},naji.njMapConfig.addProgress(ol.getUid(t.olMap.getView()),function(e){n.style.display=e?"block":"none"})},naji.njMap.prototype._createDefaultInteractions=function(){var e=[new ol.interaction.DragPan({kinetic:!1}),new ol.interaction.DragZoom({duration:0,condition:ol.events.condition.shiftKeyOnly}),new ol.interaction.DragRotate({duration:0}),new ol.interaction.DoubleClickZoom({duration:0}),new ol.interaction.MouseWheelZoom({duration:0,constrainResolution:!0}),new ol.interaction.PinchZoom({duration:0,constrainResolution:!0}),new ol.interaction.PinchRotate({duration:0})];for(var t in e)e[t].set("necessary",!0);return e},naji.njMap.prototype._createDefaultControls=function(){var e=[new ol.control.Rotate,new ol.control.Zoom({duration:0})];for(var t in e)e[t].set("necessary",!0);return e},naji.njMap.prototype.getMap=function(){return(this._this||this).olMap},naji.njMap.prototype.getResolutions=function(e){for(var t=this._this||this,a=ol.extent.getWidth(t.maxExtent)/e,n=new Array(t.olMap.getView().getMaxZoom()),i=0;i<t.olMap.getView().getMaxZoom();++i)n[i]=a/Math.pow(2,i);return n},naji.njMap.prototype.getMatrixIds=function(){for(var e=this._this||this,t=new Array(e.olMap.getView().getMaxZoom()),a=0;a<e.olMap.getView().getMaxZoom();++a)t[a]=""+a;return t},naji.njMap.prototype.getCRS=function(){return(this._this||this).mapCRS},naji.njMap.prototype.getMaxExtent=function(){return(this._this||this).maxExtent},naji.njMap.prototype.setExtent=function(e){(this._this||this).olMap.getView().fit(e)},naji.njMap.prototype.getLayers=function(e){var t=this._this||this,a=[];if(t.layers&&e)for(var n in t.layers){var i=t.layers[n];i.getLayerType()===e&&a.push(i)}else a=t.layers;return a},naji.njMap.prototype.getLayerById=function(e){var t=this._this||this,a=null;if(t.layers)for(var n in t.layers){var i=t.layers[n];i.getId()===e&&(a=i)}return a},naji.njMap.prototype.getLayerByName=function(e){var t=this._this||this,a=null;if(t.layers)for(var n in t.layers){var i=t.layers[n];i.getName()===e&&(a=i)}return a},naji.njMap.prototype.getLayerByKey=function(e){var t=this._this||this,a=null;if(t.layers)for(var n in t.layers){var i=t.layers[n];i.getLayerKey()===e&&(a=i)}return a},naji.njMap.prototype.addWMSLayer=function(e){var a=this._this||this,t=e||{},n=void 0!==t.layer?t.layer:void 0,i=void 0!==t.useExtent&&t.useExtent,o=void 0!==t.extent?t.extent:void 0,r=void 0!==t.resolution?t.resolution:void 0,s=_$.Deferred();try{a.olMap.addLayer(n.getOlLayer()),a.layers.push(n);var l=n.getOlLayer().getSource();if(l.on(["imageloadstart","tileloadstart"],function(e){naji.njMapConfig.isUseLoading()&&naji.njMapConfig.loading(a.dataViewId,!0)}),l.on(["imageloadend","tileloadend"],function(){naji.njMapConfig.isUseLoading()&&naji.njMapConfig.loading(a.dataViewId,!1)}),l.on(["imageloaderror","tileloaderror"],function(){naji.njMapConfig.isUseLoading()&&naji.njMapConfig.loading(a.dataViewId,!1)}),i)if(Array.isArray(o)){for(var p in o)o[p]=parseFloat(o[p]);a.setExtent(o),r&&_olMap.getView().setResolution(r)}else{var c=new naji.service.njMapGetCapabilitiesWMS({useProxy:!0,version:"1.3.0",serviceURL:n.getServiceURL(),dataViewId:a.dataViewId});c.then(function(e){if(!e.state)return naji.njMapConfig.alert_Error(e.message),s.reject(e.message),s.promise();var t=ol.proj.transformExtent(c.data.serviceMetaData.maxExtent,c.data.serviceMetaData.crs,a.mapCRS);a.setExtent(t)}).fail(function(e){return naji.njMapConfig.alert_Error("Error : "+e),s.reject(!1),s.promise()})}s.resolve(!0)}catch(e){return naji.njMapConfig.alert_Error("Error : "+e),s.reject(!1),s.promise()}return s.promise()},naji.njMap.prototype.addWFSLayer=function(e){var a=this._this||this,t=e||{},n=void 0!==t.layer?t.layer:void 0,i=void 0!==t.useExtent&&t.useExtent,o=_$.Deferred();try{var r=n.getOlLayer();a.olMap.addLayer(r),a.layers.push(n),n.getFeatures(a.dataViewId).then(function(e){if(!e.state)return naji.njMapConfig.alert_Error(e.message),o.reject(e.message),o.promise();if(r.getSource().addFeatures(e.features),i){var t=ol.proj.transformExtent(r.getSource().getExtent(),n.srsName,a.mapCRS);a.setExtent(t)}o.resolve(!0)}).fail(function(e){return naji.njMapConfig.alert_Error("Error : "+e),o.reject(!1),o.promise()})}catch(e){return naji.njMapConfig.alert_Error("Error : "+e),o.reject(!1),o.promise()}return o.promise()},naji.njMap.prototype.addWCSLayer=function(e){var i=this._this||this,t=e||{},o=void 0!==t.layer?t.layer:void 0,a=void 0!==t.useExtent&&t.useExtent,r=(void 0!==t.extent&&t.extent,_$.Deferred());try{var s=o.getOlLayer();if(o.getBoundingBox()&&3<o.getBoundingBox().length){i.olMap.addLayer(s),i.layers.push(o),o.setMap(i.olMap,c),p(ol.proj.transformExtent(o.getBoundingBox(),"EPSG:4326",i.getCRS())),r.resolve(!0)}else{var l=new naji.service.njMapGetCapabilitiesWCS({useProxy:!0,version:o.version,serviceURL:o.getServiceURL(),dataViewId:i.dataViewId});l.then(function(e){if(!e.state)return naji.njMapConfig.alert_Error(e.message),i.deferred.reject(e.message),r.promise();var t=l.data.serviceMetaData.coverages;for(var a in t)if(t[a].Identifier===o.identifier){o.setBoundingBox(t[a].BBOX);break}if(i.olMap.addLayer(s),i.layers.push(o),o.setMap(i.olMap,c),n&&Array.isArray(n))p(n);else{var n=ol.proj.transformExtent(o.getBoundingBox(),"EPSG:4326",i.getCRS());p(n)}r.resolve(!0)})}r.resolve(!0)}catch(e){return naji.njMapConfig.alert_Error("Error : "+e),r.reject(!1),r.promise()}function p(e){if(a&&Array.isArray(e)){for(var t in e)e[t]=parseFloat(e[t]);i.setExtent(e)}}function c(e){naji.njMapConfig.isUseLoading()&&naji.njMapConfig.loading(i.dataViewId,e)}return r.promise()},naji.njMap.prototype.addGSSWMTSLayer=function(e){var a=this._this||this,t=e||{},n=void 0!==t.layer?t.layer:void 0,i=void 0!==t.useExtent&&t.useExtent,o=void 0!==t.extent?t.extent:void 0,r=void 0!==t.resolution?t.resolution:void 0,s=_$.Deferred();try{a.olMap.addLayer(n.getOlLayer()),a.layers.push(n);var l=n.getOlLayer().getSource();if(l.on(["imageloadstart","tileloadstart"],function(e){naji.njMapConfig.isUseLoading()&&naji.njMapConfig.loading(a.dataViewId,!0)}),l.on(["imageloadend","tileloadend"],function(){naji.njMapConfig.isUseLoading()&&naji.njMapConfig.loading(a.dataViewId,!1)}),l.on(["imageloaderror","tileloaderror"],function(){naji.njMapConfig.isUseLoading()&&naji.njMapConfig.loading(a.dataViewId,!1)}),i)if(Array.isArray(o)){for(var p in o)o[p]=parseFloat(o[p]);a.setExtent(o),r&&_olMap.getView().setResolution(r)}else{var c=new naji.service.njMapGetCapabilitiesWMS({useProxy:!0,version:"1.3.0",serviceURL:n.getServiceURL(),dataViewId:a.dataViewId});c.then(function(e){if(!e.state)return naji.njMapConfig.alert_Error(e.message),s.reject(e.message),s.promise();var t=ol.proj.transformExtent(c.data.serviceMetaData.maxExtent,c.data.serviceMetaData.crs,a.mapCRS);a.setExtent(t)}).fail(function(e){return naji.njMapConfig.alert_Error("Error : "+e),s.reject(!1),s.promise()})}s.resolve(!0)}catch(e){return naji.njMapConfig.alert_Error("Error : "+e),s.reject(!1),s.promise()}return s.promise()},naji.njMap.prototype.addWMTSLayer=function(e){var i=this._this||this,t=e||{},o=void 0!==t.layer?t.layer:void 0,a=void 0!==t.useExtent&&t.useExtent,r=(void 0!==t.extent&&t.extent,_$.Deferred());try{var s=o.getOlLayer();if(o.getWmtsCapabilities()&&o.getOriginExtent()){o.update(!0),i.olMap.addLayer(s),i.layers.push(o),p(ol.proj.transformExtent(o.getOriginExtent(),"EPSG:4326",i.getCRS())),c(),r.resolve(!0)}else{var l=new naji.service.njMapGetCapabilitiesWMTS({useProxy:!0,version:o.version,serviceURL:o.getServiceURL(),dataViewId:i.dataViewId});l.then(function(e){if(!e.state)return naji.njMapConfig.alert_Error(e.message),i.deferred.reject(e.message),r.promise();var t=l.data.olJson.Contents.Layer;for(var a in t)if(t[a].Identifier===o.layer){o.setOriginExtent(t[a].WGS84BoundingBox);break}if(o.setWmtsCapabilities(l.data),o.update(!0),i.olMap.addLayer(s),i.layers.push(o),n&&Array.isArray(n))p(n);else{var n=ol.proj.transformExtent(o.getOriginExtent(),"EPSG:4326",i.getCRS());p(n)}c(),r.resolve(!0)})}}catch(e){return naji.njMapConfig.alert_Error("Error : "+e),r.reject(!1),r.promise()}function p(e){if(a&&Array.isArray(e)){for(var t in e)e[t]=parseFloat(e[t]);i.setExtent(e)}}function c(){var e=o.getOlLayer().getSource();e.on("tileloadstart",function(e){naji.njMapConfig.isUseLoading()&&naji.njMapConfig.loading(i.dataViewId,!0)}),e.on("tileloadend",function(){naji.njMapConfig.isUseLoading()&&naji.njMapConfig.loading(i.dataViewId,!1)}),e.on("tileloaderror",function(){naji.njMapConfig.isUseLoading()&&naji.njMapConfig.loading(i.dataViewId,!1)})}return r.promise()},naji.njMap.prototype.addVectorLayer=function(e){var t=this._this||this,a=e||{},n=void 0!==a.layer?a.layer:void 0,i=void 0!==a.useExtent&&a.useExtent,o=_$.Deferred();try{var r=n.getOlLayer();if(t.olMap.addLayer(r),t.layers.push(n),i){var s=r.getSource().getExtent();if(s&&s[0]!==1/0){var l=ol.proj.transformExtent(r.getSource().getExtent(),n.srsName,t.mapCRS);t.setExtent(l)}}o.resolve(!0)}catch(e){return naji.njMapConfig.alert_Error("Error : "+e),o.reject(!1),o.promise()}return o.promise()},naji.njMap.prototype.addVector3DLayer=function(e){var t=this._this||this,a=e||{},n=void 0!==a.layer?a.layer:void 0,i=void 0!==a.useExtent&&a.useExtent,o=_$.Deferred();try{var r=n.getOlLayer();if(t.olMap.addLayer(r),t.layers.push(n),i){var s=r.getSource().getExtent();if(s&&s[0]!==1/0){var l=ol.proj.transformExtent(r.getSource().getExtent(),n.srsName,t.mapCRS);t.setExtent(l)}}o.resolve(!0)}catch(e){return naji.njMapConfig.alert_Error("Error : "+e),o.reject(!1),o.promise()}return o.promise()},naji.njMap.prototype.addClusterLayer=function(e){var t=this._this||this,a=e||{},n=void 0!==a.uClusterLayer?a.uClusterLayer:void 0,i=_$.Deferred();try{var o=n.getOlLayer();t.olMap.addLayer(o),t.layers.push(n),i.resolve(!0)}catch(e){return naji.njMapConfig.alert_Error("Error : "+e),i.reject(!1),i.promise()}return i.promise()},naji.njMap.prototype.refresh=function(){var e=this._this||this;if(e.olMap){var t=e.olMap.getView();t.dispatchEvent({type:"change:center"}),t.dispatchEvent({type:"change:rotation"}),t.dispatchEvent({type:"change:resolution"}),e.olMap.updateSize()}},naji.njMap.prototype.removeLayer=function(e){for(var t=this._this||this,a=0;a<t.layers.length;a++){var n=t.layers[a];n.getLayerKey()===e&&(n.destroy(),t.olMap.removeLayer(n.getOlLayer()),t.layers.splice(a,1))}},naji.njMap.prototype.getResolutionFromScale=function(e){return e/(39.37*_self.olMap.getView().getProjection().getMetersPerUnit()*96)},naji.njMap.prototype.getScaleFromResolution=function(e){return e*(39.37*_self.olMap.getView().getProjection().getMetersPerUnit()*96)},naji.njMap.prototype.calculateScale=function(c){var u=this._this||this,y=null,d=null,h=null,g=null,M=264583e-9;function m(e,t){var a=r(e),n=r(t),i=n[0]-a[0],o=n[1]-a[1];return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}function r(e){var t=new Array(2);if(null===h||h===g)return t[0]=e[0],t[1]=e[1],t;try{var a=ol.proj.transform(e,h,g);return t[0]=a[0],t[1]=a[1],t}catch(e){}}return function(e){var t=c||{};h=u.mapCRS,g=void 0!==t.originCRS?t.originCRS:u.getCRS(),d=void 0!==t.extent?t.extent:u.olMap.getView().calculateExtent(u.olMap.getSize());var a,n,i,o,r=ol.extent.getWidth(d),s=ol.extent.getHeight(d),l=u.olMap.getSize()[0],p=u.olMap.getSize()[1];y=s/p<=r/l?(i=[d[0],d[1]],o=[d[2],d[1]],m(i,o)/(l*M)):(a=[d[0],d[1]],n=[d[0],d[3]],m(a,n)/(p*M))}(),y},naji.njMap.prototype.getScaleForZoom=function(e){var t=this._this||this,a=t.olMap.getView().getResolutionForZoom(e),n=[0,0,a*t.olMap.getSize()[0],a*t.olMap.getSize()[1]];return t.calculateScale({extent:n,originCRS:t.getCRS()})},naji.njMap.prototype.removeAllListener=function(e){for(var t=this._this||this,a=ol.events.getListeners(t.olMap,e),n=a.length-1;0<=n;n--)ol.Observable.unByKey(a[n])},naji.njMap.prototype.removeAllInteraction=function(){for(var e=this._this||this,t=e.olMap.getInteractions().getArray(),a=t.length-1;0<=a;a--)t[a].get("necessary")||e.olMap.removeInteraction(t[a])},naji.njMap.prototype.setActiveAllInteraction=function(e){for(var t=(this._this||this).olMap.getInteractions().getArray(),a=t.length-1;0<=a;a--)t[a].setActive(e)},naji.njMap.prototype.setAltKeyOnly=function(e){var t=this._this||this;t.useAltKeyOnly!==e&&(t.useAltKeyOnly=e)},naji.njMap.prototype.setLoadingVisible=function(e){var t=this._this||this;t.loadingSrcDiv.style.display=e?"block":"none"},naji.njMap.prototype.getDataViewId=function(){return(this._this||this).dataViewId}}(),function(){"use strict";naji.njMapCapture=function(a){var n=this;return this.useSync=null,this.origin_njMap=null,this.appendElement=null,this.origin_njMapBaseMap=null,this.origin_njMapLayerManager=null,this.captureDivId=null,this.captureMapId=null,this.readyFunction=null,this.captureNjMap=null,this.captureElement=null,this.arrDeferred_ready=null,this.captureBaseMapId=null,this.captureUgBaseMap=null,this.captureLayerManager=null,function(){var e=a||{};if(n.useSync="boolean"==typeof e.useSync&&e.useSync,n.origin_njMap=void 0!==e.njMap?e.njMap:void 0,n.origin_njMapBaseMap=void 0!==e.njMapBaseMap?e.njMapBaseMap:void 0,n.origin_njMapLayerManager=void 0!==e.njMapLayerManager?e.njMapLayerManager:void 0,n.appendElement=void 0!==e.appendElement?e.appendElement:void 0,n.readyFunction="function"==typeof e.readyFunction?e.readyFunction:void 0,n.arrDeferred_ready=[],!n.origin_njMap)return naji.njMapConfig.alert_Error("njMap undefined");var t=naji.util.njMapUtil.generateUUID().split("-")[0];n.captureDivId="captureDiv_"+t,n.captureMapId="captureMap_"+t,n.captureBaseMapId="captureBaseMap_"+t,n._createCaptureElement(),n._setCaptureMap(),n._setCaptureLayer()}(),{_this:n,ready:n.ready,destroy:n.destroy,runCapture:n.runCapture,getnjMap:n.getnjMap,getnjMapBaseMap:n.getnjMapBaseMap,setBaseMapVisible:n.setBaseMapVisible,getnjMapLayerManager:n.getnjMapLayerManager,baseMapVisibleToggle:n.baseMapVisibleToggle}},naji.njMapCapture.prototype._createCaptureElement=function(){var e=this._this||this,t=document.createElement("div");t.id=e.captureDivId,t.style.width="100%",t.style.height="100%",t.style.overflow="hidden",t.style.position="relative",t.style.backgroundColor="white";var a=document.createElement("div");a.id=e.captureBaseMapId,naji.util.njMapUtil.setCssTextStyle(a,"z-Index","20"),naji.util.njMapUtil.setCssTextStyle(a,"width","100%"),naji.util.njMapUtil.setCssTextStyle(a,"height","100%"),naji.util.njMapUtil.setCssTextStyle(a,"position","absolute !important"),naji.util.njMapUtil.setCssTextStyle(a,"background-color","rgb(255, 255, 254)");var n=document.createElement("div");n.id=e.captureMapId,naji.util.njMapUtil.setCssTextStyle(n,"z-Index","30"),naji.util.njMapUtil.setCssTextStyle(n,"width","100%"),naji.util.njMapUtil.setCssTextStyle(n,"height","100%"),naji.util.njMapUtil.setCssTextStyle(n,"position","absolute !important"),t.appendChild(a),t.appendChild(n),e.captureElement=t},naji.njMapCapture.prototype._setCaptureMap=function(){var e=this._this||this;e.appendElement.insertBefore(e.captureElement,e.appendElement.firstChild),e.captureNjMap=new naji.njMap({target:document.getElementById(e.captureMapId),crs:e.origin_njMap.getCRS(),center:e.origin_njMap.getMap().getView().getCenter(),useMaxExtent:!0,useAltKeyOnly:!1});for(var t=e.captureNjMap.getMap().getControls().getArray(),a=t.length-1;0<=a;a--)e.captureNjMap.getMap().removeControl(t[a]);var n=e.captureNjMap.getMap().getInteractions().getArray();for(a=n.length-1;0<=a;a--)if(n[a]instanceof ol.interaction.DragRotate){e.captureNjMap.getMap().removeInteraction(n[a]);break}if(new naji.control.njMapDragPan({njMap:e.captureNjMap,useDragPan:!1,cursorCssName:"cursor-default",activeChangeListener:function(e){console.log("njMapDragPan : "+e)}}).setActive(!0),e.origin_njMapBaseMap){e.captureUgBaseMap=new naji.baseMap.njMapBaseMap({target:e.captureBaseMapId,njMap:e.captureNjMap,baseMapKey:"osm_none",useElementMargin:!1});var i=document.getElementById(e.captureBaseMapId);i.firstElementChild.style.top=null,i.firstElementChild.style.left=null,i.firstElementChild.style.overflow=null,i.firstElementChild.style.width="100%",i.firstElementChild.style.height="100%",e.captureUgBaseMap.setVisible(e.origin_njMapBaseMap.getVisible()),e.captureUgBaseMap.setOpacity(e.origin_njMapBaseMap.getOpacity());var o=e.origin_njMapBaseMap.getSelectedBaseMap();if(-1<o.indexOf("custom")){var r=e.origin_njMapBaseMap._this.baseMapList[o].object,s=r._this.uWMTSLayer,l=new naji.layer.njMapWMTSLayer({useProxy:!0,serviceURL:s.getServiceURL(),layer:s.layer,version:s.version,matrixSet:s.matrixSet,wmtsCapabilities:s.getWmtsCapabilities(),originExtent:s.getOriginExtent()}),p="custom_"+naji.util.njMapUtil.generateUUID().split("-")[0],c=new naji.baseMap.njMapBaseMapCustom({baseMapKey:p,uWMTSLayer:l,capabilities:s.getWmtsCapabilities(),isWorld:r.isWorlds(),isFactor:r.isFactors()});c._this.resolutions=r._this.resolutions,c._this.mapTypes[p].maxZoom=r._this.mapTypes[o].maxZoom,c._this.mapTypes[p].resolutions=r._this.mapTypes[o].resolutions,e.captureUgBaseMap.addBaseMapType(p,c),e.captureUgBaseMap.changeBaseMap(p)}else if(-1<o.indexOf("TMS")){var u=o.split("_")[0],y=new naji.baseMap.njMapBaseMapTMS_vWorld({baseCode:u,projection:e.origin_njMapBaseMap.getApiMap().getView().getProjection().getCode()});e.captureUgBaseMap.addBaseMapType(u,y),e.captureUgBaseMap.changeBaseMap(o);var d=e.captureUgBaseMap.getApiMap().getLayers().getArray();for(var a in d){var h=d[a].getSource().getUrls(),g=[];for(var M in h)g.push(naji.njMapConfig.getProxy()+h[M]);d[a].getSource().setUrls(g)}}else if(e.captureUgBaseMap.changeBaseMap(o),"osm_gray"===o){d=e.captureUgBaseMap.getApiMap().getLayers().getArray();for(var a in d)d[a].getSource().setUrl(naji.njMapConfig.getProxy()+"https://tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png")}}var m=e.origin_njMap.getMap().getView();m.setRotation(0),e.captureNjMap.getMap().setView(new ol.View({zoom:m.getZoom(),center:m.getCenter(),extent:ol.proj.get(e.origin_njMap.getCRS()).getExtent(),projection:m.getProjection().getCode(),maxZoom:m.getMaxZoom(),minZoom:m.getMinZoom(),resolution:m.getResolution(),resolutions:m.getResolutions(),rotation:0})),e.useSync&&e.captureNjMap.getMap().setView(m)},naji.njMapCapture.prototype._setCaptureLayer=function(){var l=this._this||this,p=[];if(l.origin_njMapLayerManager)l.captureLayerManager=new naji.manager.njMapLayerManager({njMap:l.captureNjMap,useMinMaxZoom:!0}),p=l.origin_njMapLayerManager.getAll(!0);else{var e=l.origin_njMap.getLayers();for(var t in e)p.push({njMapLayer:e[t]})}!function e(t){if(t<p.length){var a,n=p[t].njMapLayer;if(!n.getVisible())return e(t+1),!1;"WMS"===n.getLayerType()?a=l._addnjMapLayer().addWMSLayer:"WFS"===n.getLayerType()?a=l._addnjMapLayer().addWFSLayer:"Vector"===n.getLayerType()?a=l._addnjMapLayer().addVectorLayer:"Vector3D"===n.getLayerType()?a=l._addnjMapLayer().addVector3DLayer:"Cluster"===n.getLayerType()?a=l._addnjMapLayer().addClusterLayer:"WMTS"===n.getLayerType()?a=l._addnjMapLayer().addWMTSLayer:"WCS"===n.getLayerType()&&(a=l._addnjMapLayer().addWCSLayer);var i=a.create(n);if(i.setLayerVisible(n.getVisible()),i.getOlLayer().setZIndex(n.getOlLayer().getZIndex()),i.getOlLayer().setOpacity(n.getOlLayer().getOpacity()),l.captureLayerManager&&(i.setMinZoom(n.getMinZoom()),i.setMaxZoom(n.getMaxZoom())),l.origin_njMapLayerManager&&"WMS"===i.getLayerType()){var o=p[t].njMapToc,r=new naji.service.njMapGetCapabilitiesWMS({useProxy:!0,version:"1.3.0",serviceURL:i.getServiceURL(),dataViewId:l.captureNjMap.getDataViewId()});l.arrDeferred_ready.push(r),r.then(function(){var e=a.toc({key:o.tocKey,addLayer:i,saveData:JSON.parse(JSON.stringify(o.getSaveData())),capabilities:r.data});l.captureLayerManager&&l.captureLayerManager.add({njMapToc:e,njMapLayer:i})})}else l.captureLayerManager&&l.captureLayerManager.add({njMapLayer:i});var s=a.add(i);l.arrDeferred_ready.push(s),s.then(function(e){}),e(t+1)}else l.ready()}(0)},naji.njMapCapture.prototype._addnjMapLayer=function(e){var t=this._this||this;return{addWFSLayer:{create:function(e){return new naji.layer.njMapWFSLayer({useProxy:!0,serviceURL:e.getServiceURL(),layerName:e.layerName,srsName:t.captureNjMap.getCRS(),maxFeatures:e._this.maxFeatures,style:e._this.style,filter:e._this.filter})},add:function(e){return t.captureNjMap.addWFSLayer({uWFSLayer:e,useExtent:!1})}},addWCSLayer:{create:function(e){return new naji.layer.njMapWCSLayer({useProxy:!0,version:e.version,identifier:e.identifier,format:e._this.format,serviceURL:e.getServiceURL(),boundingBox:e.getBoundingBox(),useScaleRefresh:e.useScaleRefresh})},add:function(e){return t.captureNjMap.addWCSLayer({uWCSLayer:e,useExtent:!1,extent:null})}},addWMSLayer:{create:function(e){return new naji.layer.njMapWMSLayer({useProxy:!0,singleTile:e._this.singleTile,serviceURL:e.getServiceURL(),ogcParams:e.getOlLayer().getSource().getParams()})},add:function(e){return t.captureNjMap.addWMSLayer({uWMSLayer:e,useExtent:!1,extent:null,resolution:null})},toc:function(e){return new naji.toc.njMapWMSToc({tocKey:e.key,njMap:t.captureNjMap,njMapLayer:e.addLayer,loadData:e.saveData,capabilities:e.capabilities})}},addWMTSLayer:{create:function(e){return new naji.layer.njMapWMTSLayer({useProxy:!0,serviceURL:e.getServiceURL(),layer:e.layer,version:e.version,matrixSet:e.matrixSet,wmtsCapabilities:e.getWmtsCapabilities(),originExtent:e.getOriginExtent()})},add:function(e){return t.captureNjMap.addWMTSLayer({uWMTSLayer:e,useExtent:!1,extent:null})}},addVectorLayer:{create:function(e){var t=e._this.style;return"function"!=typeof t&&void 0!==t&&(t=naji.util.njMapUtil.cloneStyle(t)),new naji.layer.njMapVectorLayer({style:t,features:e.getFeatures(),srsName:e._this.srsName})},add:function(e){return t.captureNjMap.addVectorLayer({uVectorLayer:e,useExtent:!1})}},addClusterLayer:{create:function(e){var t=e._this.style;return new naji.layer.njMapClusterLayer({style:"function"==typeof t?t:naji.util.njMapUtil.cloneStyle(t),features:naji.util.njMapUtil.cloneFeatures(e.getFeatures()),distance:e._this.distance,useAnimation:e._this.useAnimation})},add:function(e){return t.captureNjMap.addClusterLayer({uClusterLayer:e,useExtent:!1})}},addVector3DLayer:{create:function(e){var t=e._this.style;return"function"!=typeof t&&void 0!==t&&(t=naji.util.njMapUtil.cloneStyle(t)),new naji.layer.njMapVector3DLayer({style:t,features:e.getFeatures(),initBuild:e._this.initBuild,srsName:e._this.srsName,labelColumn:e._this.labelColumn,heightColumn:e._this.heightColumn,maxResolution:e._this.maxResolution})},add:function(e){return t.captureNjMap.addVector3DLayer({uVector3DLayer:e,useExtent:!1})}}}},naji.njMapCapture.prototype.getnjMap=function(){return(this._this||this).captureNjMap},naji.njMapCapture.prototype.getnjMapBaseMap=function(){return(this._this||this).captureUgBaseMap},naji.njMapCapture.prototype.getnjMapLayerManager=function(){return(this._this||this).captureLayerManager},naji.njMapCapture.prototype.setBaseMapVisible=function(e){var t=this._this||this;t.captureUgBaseMap&&t.captureUgBaseMap.setVisible(e)},naji.njMapCapture.prototype.baseMapVisibleToggle=function(){var e=this._this||this;e.captureUgBaseMap&&e.captureUgBaseMap.visibleToggle()},naji.njMapCapture.prototype.runCapture=function(t){var e=this._this||this;if(document.getElementById(e.captureBaseMapId).style.overflow="",document.getElementById(e.captureBaseMapId).firstElementChild.style.overflow="","function"!=typeof t)return!1;var a="none";e.origin_njMapBaseMap&&(a=e.origin_njMapBaseMap.getSelectedBaseMap().split("_")[0]),-1<a.indexOf("naver")||-1<a.indexOf("daum")||-1<a.indexOf("baroEmap")?(document.getElementById(e.captureDivId).scrollIntoView(!1),html2canvas_etc(document.getElementById(e.captureDivId),{useCORS:!0,logging:!1,proxy:naji.njMapConfig.getProxy()}).then(function(e){t.call(this,e)})):(document.getElementById(e.captureDivId).scrollIntoView(!1),html2canvas_google(document.getElementById(e.captureDivId),{useCORS:!0,proxy:naji.njMapConfig.getProxy(),onrendered:function(e){t.call(this,e)}}))},naji.njMapCapture.prototype.destroy=function(e){var t=this._this||this;_$("#"+t.captureBaseMapId).empty(),t.captureNjMap.getMap().setTarget(null)},naji.njMapCapture.prototype.ready=function(){var e=this._this||this;$.when.apply($,e.arrDeferred_ready).then(function(){e.readyFunction&&e.readyFunction.call(e),e.captureNjMap.refresh()})}}(),function(){"use strict";naji.njMapConfig=function(e){return this.proxy=null,this.mobile=null,this.loading=null,this.browser=null,this.progress=null,this.flag_Proxy=null,this.alert_Error=null,this.loadingImg=null,this.useLoading=null,this.useMapProxy=null,this.progressObj={},this._checkMobile(),this._checkBrowser(),this._setIeCursor(),{_this:this,init:this.init,isMobile:this.isMobile,getProxy:this.getProxy,loading:this.getLoading,isMapProxy:this.isMapProxy,getBrowser:this.getBrowser,alert_Error:this.getAlert_Error,addProgress:this.addProgress,resetLoading:this.resetLoading,isUseLoading:this.isUseLoading,getLoadingImg:this.getLoadingImg,addLoadEventListener:this.addLoadEventListener}},naji.njMapConfig.prototype.init=function(e){var t=this._this||this,a=e||{};if(void 0!==a.proxy&&"string"==typeof a.proxy?(t.proxy=a.proxy,t.flag_Proxy=!0):(t.proxy="",t.flag_Proxy=!1),void 0!==a.alert_Error&&"function"==typeof a.alert_Error?t.alert_Error=a.alert_Error:t.alert_Error=t._defaultAlert_Error,void 0!==a.loadingImg&&"string"==typeof a.loadingImg)t.loadingImg=a.loadingImg;else{naji.contextPath;t.loadingImg=t.defaultLoadingImg}t.useLoading=void 0===a.useLoading||a.useLoading,t.useMapProxy=void 0!==a.useMapProxy&&a.useMapProxy},naji.njMapConfig.prototype.isMobile=function(){return(this._this||this).mobile},naji.njMapConfig.prototype.isMapProxy=function(){return(this._this||this).useMapProxy},naji.njMapConfig.prototype.getBrowser=function(){return(this._this||this).browser},naji.njMapConfig.prototype.getProxy=function(){var e=this._this||this;return void 0!==e.flag_Proxy?e.proxy:""},naji.njMapConfig.prototype.getAlert_Error=function(e){(this._this||this).alert_Error(e)},naji.njMapConfig.prototype._defaultAlert_Error=function(e){alert(e)},naji.njMapConfig.prototype.isUseLoading=function(){return(this._this||this).useLoading},naji.njMapConfig.prototype.resetLoading=function(e){var t=this._this||this;t.progressObj[e]&&t.progressObj[e].reset()},naji.njMapConfig.prototype.getLoading=function(e,t){var a=this._this||this;t?a.progressObj[e]&&a.progressObj[e].addLoading():a.progressObj[e]&&a.progressObj[e].addLoaded()},naji.njMapConfig.prototype._Progress=function(e,t){var a=this;return this.key=null,this.loaded=null,this.loading=null,this.interval=null,this.timeOut=null,this.loadingFunc=null,a.key=e,a.loaded=0,a.loading=0,a.loadingFunc=t,this.addLoading=function(){0===a.loading&&(a.loadingFunc(!0),_$(document).trigger("loadChangeEvent_"+a.key,!1)),++a.loading,a.update()},this.addLoaded=function(){setTimeout(function(){++a.loaded,a.update()},100)},this.update=function(){0!==a.loading&&0!==a.loaded&&a.loading<=a.loaded?(a.loading=0,a.loaded=0,clearInterval(a.interval),a.loadingFunc(!1),$(document).trigger("loadChangeEvent_"+a.key,!0)):clearTimeout(a.timeOut)},this.reset=function(){clearInterval(a.interval),a.interval=setInterval(a.update,1e3)},{reset:a.reset,addLoaded:a.addLoaded,addLoading:a.addLoading}},naji.njMapConfig.prototype._checkMobile=function(){var e=this._this||this;navigator.platform&&("win16|win32|win64|mac".indexOf(navigator.platform.toLowerCase())<0?e.mobile=!0:e.mobile=!1)},naji.njMapConfig.prototype._checkBrowser=function(){var e,t=this._this||this,a=navigator.appName,n=navigator.userAgent.toLowerCase();"Microsoft Internet Explorer"===a||-1<n.indexOf("trident")||-1<n.indexOf("edge/")?(e="ie","Microsoft Internet Explorer"===a?(n=/msie ([0-9]{1,}[\.0-9]{0,})/.exec(n),e+=parseInt(n[1])):-1<n.indexOf("trident")?e+=11:-1<n.indexOf("edge/")&&(e="edge")):-1<n.indexOf("safari")?e=-1<n.indexOf("opr")?"opera":-1<n.indexOf("chrome")?"chrome":"safari":-1<n.indexOf("firefox")&&(e="firefox"),t.browser=e},naji.njMapConfig.prototype._setIeCursor=function(){var e=this._this||this;if(e.browser&&-1<e.browser.indexOf("ie")){var t=document.createElement("style");t.type="text/css",document.getElementsByTagName("head")[0].appendChild(t);var a=["default","closeHand","identify","measureArea","measureDistance","zoomIn","zoomOut","zoomOut","point","line","polygon","rectangle","circle"];for(var n in a){var i=a[n],o=".cursor-"+i,r="cursor: url("+("../images/cursor/cursor_"+i+".cur")+"), auto !important;";(t.sheet||{}).insertRule?t.sheet.insertRule(o+"{"+r+"}",0):(t.styleSheet||t.sheet).addRule(o,r)}}},naji.njMapConfig.prototype.getLoadingImg=function(){var e=this._this||this;if(!e.loadingImg){var t=naji.contextPath+"/images/icon_loading.gif";e.loadingImg=t}return e.loadingImg},naji.njMapConfig.prototype.addProgress=function(e,t){var a=this._this||this;a.progressObj[e]=new a._Progress(e,t)},naji.njMapConfig.prototype.addLoadEventListener=function(e,t){this._this;setTimeout(function(){$(document).on("loadChangeEvent_"+e,t)},10)},naji.njMapConfig=new naji.njMapConfig}(),function(){"use strict";naji.njMapHttp=function(){return{requestData:this.requestData}},naji.njMapHttp.prototype.requestData=function(e){var t=this,a=e||{};return this.isUseLoading=naji.njMapConfig.isUseLoading(),this.deferred=_$.Deferred(),this.url=void 0!==a.url?a.url:"",this.type=void 0!==a.type?a.type:"GET",this.data=void 0!==a.data?a.data:{},this.contentType=void 0!==a.contentType?a.contentType:"application/x-www-form-urlencoded; charset=UTF-8",this.dataType=void 0!==a.dataType?a.dataType:"XML",this.dataViewId=void 0!==a.dataViewId?a.dataViewId:"",_$.ajax({url:t.url,type:t.type,data:t.data,dataType:t.dataType,contentType:t.contentType,beforeSend:function(){t.isUseLoading&&naji.njMapConfig.loading(t.dataViewId,!0)},complete:function(){t.isUseLoading&&naji.njMapConfig.loading(t.dataViewId,!1)},success:function(e){t.deferred.resolve(e)},error:function(e){t.deferred.reject(e)}}),t.deferred.promise()},naji.njMapHttp=new naji.njMapHttp}(),function(){"use strict";naji.njMapPopup=function(o){var r=this;return this.njMap=null,this.closeCallBack=null,this.content=null,this.removed=null,this.container=null,function(e){var t=o||{},a=void 0!==t.content?t.content:"",n=void 0!==t.position?t.position:void 0,i="boolean"==typeof t.show&&t.show;if(r.removed=!1,r.njMap=void 0!==t.njMap?t.njMap:void 0,r.closeCallBack="function"==typeof t.closeCallBack?t.closeCallBack:void 0,!r.njMap)return naji.njMapConfig.alert_Error("njMap undefined");r._init(n,a,i)}(),{_this:r,hide:r.hide,show:r.show,remove:r.remove,setContent:r.setContent,setPosition:r.setPosition}},naji.njMapPopup.prototype=Object.create(ol.Overlay.prototype),naji.njMapPopup.prototype.constructor=naji.njMapPopup,naji.njMapPopup.prototype._init=function(e,t,a){var n=this._this||this,i=document.createElement("div");i.className="ol-popup-header";var o=document.createElement("a");o.className="ol-popup-closer",o.href="#",o.addEventListener("click",function(e){n.container.style.display="none",o.blur(),n.closeCallBack&&n.closeCallBack(),e.preventDefault()},!1),i.appendChild(o),n.container=document.createElement("div"),n.container.className="ol-popup",n.container.style.transitionDuration="0.5s",n.container.addEventListener("mouseover",function(e){this.style.zIndex=1},!1),n.container.addEventListener("mouseout",function(e){this.style.zIndex=""},!1),n.container.appendChild(i),n.content=document.createElement("div"),n.content.className="ol-popup-content",n.container.appendChild(n.content),ol.Overlay.call(n,{insertFirst:!1,element:n.container,stopEvent:!0}),n.setContent(t),n.setPosition(e),n.njMap.getMap().addOverlay(n),a?n._panIntoCenter():n.container.style.display="none"},naji.njMapPopup.prototype._panIntoCenter=function(){var e=this._this||this;e.njMap.getMap().getView().animate({center:e.getPosition(),duration:500})},naji.njMapPopup.prototype._panIntoView=function(){var e=this._this||this;if(!e.getPosition())return!1;var t=e.njMap.getMap(),a=t.getSize(),n=e.getElement().clientWidth+20,i=e.getElement().clientHeight+20,o=n-60,r=e.getOffset(),s=t.getPixelFromCoordinate(e.getPosition()),l=s[0]-60,p=a[0]-(s[0]+o),c=s[1]-i+r[1],u=a[1]-(s[1]+20)-r[1],y=t.getView().getCenter(),d=t.getPixelFromCoordinate(y);p<0?d[0]-=p:l<0&&(d[0]+=l),c<0?d[1]+=c:u<0&&(d[1]-=u),t.getView().animate({center:t.getCoordinateFromPixel(d),duration:500})},naji.njMapPopup.prototype.show=function(e){var t=this._this||this;if(t.removed)return!1;t.container.style.display="block";var a=t.content;window.setTimeout(function(){a.scrollTop=0},100),e?t._panIntoCenter():t._panIntoView()},naji.njMapPopup.prototype.hide=function(){var e=this._this||this;if(e.removed)return!1;e.container.style.display="none",e.closeCallBack&&e.closeCallBack()},naji.njMapPopup.prototype.setContent=function(e){var t=this._this||this;"string"==typeof e&&(t.content.innerHTML=e)},naji.njMapPopup.prototype.setPosition=function(e,t){var a=this._this||this;a.set("origin",{position:e,projection:a.njMap.getCRS()}),ol.Overlay.prototype.setPosition.call(a,e),t&&a.show(!0)},naji.njMapPopup.prototype.remove=function(){var e=this._this||this;e.hide(),e.removed=!0,e.njMap.getMap().removeOverlay(e)}}(),function(){"use strict";naji.etc.njMapNavigationHistory=function(t){var a=this;return this.njMap=null,this.hasNext=null,this.hasPrevious=null,this.state=null,this.current=null,this.nextStack=null,this.previousStack=null,function(){var e=t||{};if(a.state=!0,a.current=[],a.nextStack=[],a.previousStack=[],a.njMap=void 0!==e.njMap?e.njMap:void 0,a.hasNext="function"==typeof e.hasNext?e.hasNext:void 0,a.hasPrevious="function"==typeof e.hasPrevious?e.hasPrevious:void 0,!a.njMap)return naji.njMapConfig.alert_Error("njMap undefined");a._init()}(),{_this:a,clear:a.clear,moveNext:a.moveNext,movePrevious:a.movePrevious}},naji.etc.njMapNavigationHistory.prototype._init=function(){var t=this._this||this,e=t.njMap.getMap();e.on("change:view",function(){window.setTimeout(function(){t.clear()},100)}),e.on("moveend",function(e){t.state&&(t.nextStack=[],t.previousStack.push({zoom:e.target.getView().getZoom(),center:e.target.getView().getCenter()}),t._historyCheckListener())}),e.dispatchEvent({type:"moveend"})},naji.etc.njMapNavigationHistory.prototype.movePrevious=function(){var e=this._this||this;if(1<e.previousStack.length){var t=e.previousStack.pop(),a=e.previousStack.pop();e.nextStack.push(t),e.previousStack.push(a),e._changeMapArea(a)}},naji.etc.njMapNavigationHistory.prototype.moveNext=function(){var e=this._this||this;if(0<e.nextStack.length){var t=e.nextStack.pop();e.previousStack.push(t),e._changeMapArea(t)}},naji.etc.njMapNavigationHistory.prototype._changeMapArea=function(e){var t=this._this||this,a=t.njMap.getMap();t.state=!1,a.getView().setZoom(e.zoom),a.getView().setCenter(e.center),t._historyCheckListener(),window.setTimeout(function(){t.state=!0},500)},naji.etc.njMapNavigationHistory.prototype._historyCheckListener=function(){var e=this._this||this;e.hasNext&&(0<e.nextStack.length?e.hasNext.call(this,!0):e.hasNext.call(this,!1)),e.hasPrevious&&(1<e.previousStack.length?e.hasPrevious.call(this,!0):e.hasPrevious.call(this,!1))},naji.etc.njMapNavigationHistory.prototype.clear=function(){var e=this._this||this;e.state=!0,e.nextStack=[],e.previousStack=[],e.njMap.getMap().dispatchEvent({type:"moveend"})}}(),function(){"use strict";naji.etc.njMapRender3D=function(e){var t,a=this,n=null;return this.style=null,this.layer=null,this.easing=null,this.initBuild=null,this.labelColumn=null,this.defaultHeight=null,this.heightColumn=null,this.maxResolution=null,this.animateDuration=null,this.res=null,this.center=null,this.height=null,this.matrix=null,this.listener=null,this.animate=null,this.toHeight=null,this.buildState=null,this.elapsedRatio=null,t=e||{},a.style=void 0!==t.style?t.style:void 0,a.layer=void 0!==t.layer?t.layer:void 0,a.easing=void 0!==t.easing?t.easing:ol.easing.easeOut,a.initBuild="boolean"!=typeof t.initBuild||t.initBuild,a.labelColumn=a.labelColumn=void 0!==t.labelColumn?t.labelColumn:"",a.heightColumn=a.heightColumn=void 0!==t.heightColumn?t.heightColumn:"",a.animateDuration="number"==typeof t.animateDuration?t.animateDuration:1e3,a.defaultHeight=t.defaultHeight="number"==typeof t.defaultHeight?t.defaultHeight:0,a.maxResolution=t.maxResolution="number"==typeof t.maxResolution?t.maxResolution:.6,n=ol.Object.call(a,t),a._init(),naji.util.njMapUtil.objectMerge(n,{_this:a,isBuild3D:a.isBuild3D,setBuild3D:a.setBuild3D,buildToggle:a.buildToggle})},naji.etc.njMapRender3D.prototype=Object.create(ol.Object.prototype),naji.etc.njMapRender3D.prototype.constructor=naji.etc.njMapRender3D,naji.etc.njMapRender3D.prototype._init=function(){var e=this._this||this;e._setStyle(e.style),e._setLayer(e.layer),e.height=e._getHfn(e.heightColumn)},naji.etc.njMapRender3D.prototype._setStyle=function(e){var t=this._this||this;if(e instanceof ol.style.Style?t._style=e:t._style=new ol.style.Style,t._style.getStroke()||t._style.setStroke(new ol.style.Stroke({width:1,color:"RED"})),t._style.getFill()||t._style.setFill(new ol.style.Fill({color:"rgba(0,0,255,0.5)"})),e&&e.getGeometry()){var a=e.getGeometry();"function"==typeof a?t.set("geometry",a):t.set("geometry",function(){return a})}else t.set("geometry",function(e){return e.getGeometry()})},naji.etc.njMapRender3D.prototype._setLayer=function(e){var t=this._this||this;t._layer=e,t.listener_&&t.listener_.forEach(function(e){ol.Observable.unByKey(e)}),t.listener_=e.on(["postcompose","postrender"],t._onPostcompose.bind(t)),t.setBuild3D(t.initBuild)},naji.etc.njMapRender3D.prototype._onPostcompose=function(e){var t=this._this||this,a=e.frameState.viewState.resolution;if(!(a>t.get("maxResolution"))){if(njMap.getMap().getRenderer().getLayerRenderer(t.layer).declutterTree_.clear(),t.res=400*a,t.animate){var n=e.frameState.time-t.animate;n<t.animateDuration?(t.elapsedRatio=t.easing(n/t.animateDuration),e.frameState.animate=!0):(t.animate=!1,t.height=t.toHeight)}var i=e.frameState.pixelRatio,o=e.context,r=t.matrix=e.frameState.coordinateToPixelTransform;r||((r=e.frameState.coordinateToPixelMatrix)[2]=r[4],r[3]=r[5],r[4]=r[12],r[5]=r[13]),t.center=[o.canvas.width/2/i,o.canvas.height/i];var s=t.layer.getSource().getFeaturesInExtent(e.frameState.extent);o.save(),o.scale(i,i);var l=t.style;o.lineWidth=l.getStroke().getWidth(),o.fillStyle=ol.color.asString(l.getFill().getColor()),o.strokeStyle=ol.color.asString(l.getStroke().getColor());for(var p=[],c=0;c<s.length;c++)p.push(t._getFeature3D(s[c],t._getFeatureHeight(s[c])));t._drawFeature3D(o,p),o.restore()}},naji.etc.njMapRender3D.prototype._getFeature3D=function(e,t){var a=this._this||this,n=a.get("geometry")(e),i=n.getCoordinates();switch(n.getType()){case"Polygon":i=[i];case"MultiPolygon":for(var o=[],r=0;r<i.length;r++)for(var s=0;s<i[r].length;s++){for(var l=[],p=0;p<i[r][s].length;p++)l.push(a._hvector(i[r][s][p],t));o.push(l)}return{type:"MultiPolygon",feature:e,geom:o};case"Point":return{type:"Point",feature:e,geom:a._hvector(i,h)};default:return{}}},naji.etc.njMapRender3D.prototype._getHfn=function(t){var e=this._this||this;switch(typeof t){case"function":return t;case"string":var a=e.get("defaultHeight");return function(e){return Number(e.get(t))||a};case"number":return function(){return t};default:return function(){return 10}}},naji.etc.njMapRender3D.prototype._hvector=function(e,t){var a=this._this||this,n=[e[0]*a.matrix[0]+e[1]*a.matrix[1]+a.matrix[4],e[0]*a.matrix[2]+e[1]*a.matrix[3]+a.matrix[5]];return{p0:n,p1:[n[0]+t/a.res*(n[0]-a.center[0]),n[1]+t/a.res*(n[1]-a.center[1])]}},naji.etc.njMapRender3D.prototype._getFeatureHeight=function(e){var t=this._this||this;if(t.animate){var a=t.height(e),n=t.toHeight(e);return a*(1-t.elapsedRatio)+t.elapsedRatio*n}return t.height(e)},naji.etc.njMapRender3D.prototype._drawFeature3D=function(e,t){var a,n,i,o,r=this._this||this;for(a=0;a<t.length;a++)switch(t[a].type){case"MultiPolygon":for(n=0;n<t[a].geom.length;n++)for(i=t[a].geom[n],o=0;o<i.length;o++)e.beginPath(),e.moveTo(i[o].p0[0],i[o].p0[1]),e.lineTo(i[o].p1[0],i[o].p1[1]),e.stroke();break;case"Point":var s=t[a].geom;e.beginPath(),e.moveTo(s.p0[0],s.p0[1]),e.lineTo(s.p1[0],s.p1[1]),e.stroke()}for(a=0;a<t.length;a++)switch(t[a].type){case"MultiPolygon":for(e.beginPath(),n=0;n<t[a].geom.length;n++){if(i=t[a].geom[n],0==n)for(e.moveTo(i[0].p1[0],i[0].p1[1]),o=1;o<i.length;o++)e.lineTo(i[o].p1[0],i[o].p1[1]);else for(e.moveTo(i[0].p1[0],i[0].p1[1]),o=i.length-2;0<=o;o--)e.lineTo(i[o].p1[0],i[o].p1[1]);e.closePath()}if(e.fill("evenodd"),e.stroke(),d=(i=t[a]).feature.get(r.labelColumn)){var l=naji.util.njMapGeoSpatialUtil.getGeomCenter(i.feature.getGeometry()),p=r._hvector(l,r._getFeatureHeight(i.feature)).p1,c=e.fillStyle,u=e.measureText(d),y=Number(e.font.match(/\d+(\.\d+)?/g).join([]));e.fillStyle="rgba(255,255,255,0.5)",e.fillRect(p[0]-u.width/2-5,p[1]-y-5,u.width+10,y+10),e.strokeRect(p[0]-u.width/2-5,p[1]-y-5,u.width+10,y+10),e.font="bold 12px Verdana",e.fillStyle="black",e.textAlign="center",e.textBaseline="bottom",e.fillText(d,p[0],p[1]),e.fillStyle=c}break;case"Point":var d;if(d=(i=t[a]).feature.get(r.labelColumn)){p=i.geom.p1,c=e.fillStyle;e.fillStyle=e.strokeStyle,e.textAlign="center",e.textBaseline="bottom",e.fillText(d,p[0],p[1]);u=e.measureText(d),y=Number(e.font.match(/\d+(\.\d+)?/g).join([]));e.fillStyle="rgba(255,255,255,0.5)",e.fillRect(p[0]-u.width/2-5,p[1]-y-5,u.width+10,y+10),e.strokeRect(p[0]-u.width/2-5,p[1]-y-5,u.width+10,y+10),e.fillStyle=c}}},naji.etc.njMapRender3D.prototype._animating=function(){var e=this._this||this;return e.animate&&(new Date).getTime()-e.animate>e.animateDuration&&(e.animate=!1),!!e.animate},naji.etc.njMapRender3D.prototype.setBuild3D=function(e){var t=this._this||this;e?(t.buildState=!0,t.toHeight=t._getHfn(t.heightColumn)):(t.buildState=!1,t.toHeight=t._getHfn(0)),t.animate=(new Date).getTime(),t.layer.changed()},naji.etc.njMapRender3D.prototype.buildToggle=function(){var e=this._this||this;e.setBuild3D(!e.buildState)},naji.etc.njMapRender3D.prototype.isBuild3D=function(){var e=this._this||this;e.setBuild3D(!e.buildState)}}(),function(){"use strict";naji.util.njMapGeoSpatialUtil=function(){return{toRadians:this.toRadians,toDegrees:this.toDegrees,getGeomCenter:this.getGeomCenter,getLargestPolygon:this.getLargestPolygon,getLargestLineString:this.getLargestLineString,lineToArcTransForm:this.lineToArcTransForm,getRadianBtwPoints:this.getRadianBtwPoints,getDegreeBtwPoints:this.getDegreeBtwPoints,getDistanceBtwPotins:this.getDistanceBtwPotins}},naji.util.njMapGeoSpatialUtil.prototype.toRadians=function(e){return e/180*Math.PI},naji.util.njMapGeoSpatialUtil.prototype.toDegrees=function(e){return 180*e/Math.PI},naji.util.njMapGeoSpatialUtil.prototype.getRadianBtwPoints=function(e,t){var a=e[0],n=e[1],i=t[0],o=t[1];return Math.atan2(o-n,i-a)},naji.util.njMapGeoSpatialUtil.prototype.getDegreeBtwPoints=function(e,t){var a=this.getRadianBtwPoints(e,t);return this.toDegrees(a)},naji.util.njMapGeoSpatialUtil.prototype.getDistanceBtwPotins=function(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))},naji.util.njMapGeoSpatialUtil.prototype.lineToArcTransForm=function(e,o){var T=this,w=[],C=[];return function(){for(var e=o.slice(),t=0;t<e.length;t++){var a=e[t].getGeometry();if(a)if(a instanceof ol.geom.LineString)C.push(new ol.Feature({geometry:a}));else if(a instanceof ol.geom.MultiLineString)for(var n=a.getLineStrings(),i=0;i<n.length;i++)C.push(new ol.Feature({geometry:n[i]}))}!function(){for(var e=0;e<C.length;e++){for(var t=[],a=C[e].getGeometry().getCoordinates(),n=0;n<a.length-1;n++){var i=a[n],o=a[n+1],r=T.getDistanceBtwPotins(i,o),s=(y=o,d=r/5,void 0,h=(u=i)[0],g=u[1],M=y[0],m=y[1],j=h+(M-h)/5*3,f=g+(m-g)/5*3,S=(v=M-h)<0?-1:1,(_=m-g)<0?-1:1,b=Math.atan(_/v),L=S*Math.cos(b),x=S*Math.sin(b),[j-d*x,f+d*L]),l={type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[i,s,o]}},p=turf.bezier(l,3e3,1.5);t=t.concat(p.geometry.coordinates)}var c=new ol.Feature({geometry:new ol.geom.LineString(t)});w.push(c)}var u,y,d,h,g,M,m,j,f,v,_,S,b,L,x}()}(),w},naji.util.njMapGeoSpatialUtil.prototype.getLargestLineString=function(e){return!(!e||e.getType()!==ol.geom.GeometryType.MULTI_LINE_STRING)&&e.getLineStrings().reduce(function(e,t){return e.getLength()>t.getLength()?e:t})},naji.util.njMapGeoSpatialUtil.prototype.getLargestPolygon=function(e){return!(!e||e.getType()!==ol.geom.GeometryType.MULTI_POLYGON)&&e.getPolygons().reduce(function(e,t){return e.getArea()>t.getArea()?e:t})},naji.util.njMapGeoSpatialUtil.prototype.getGeomCenter=function(e){if(!e||!e instanceof ol.geom.Geometry)return!1;var t=[],a=e;switch(a.getType()){case ol.geom.GeometryType.POINT:case ol.geom.GeometryType.MULTI_POINT:t=a.getFlatCoordinates();break;case ol.geom.GeometryType.CIRCLE:t=a.getCenter();break;case ol.geom.GeometryType.LINE_STRING:t=a.getFlatMidpoint();break;case ol.geom.GeometryType.MULTI_LINE_STRING:t=this.getLargestLineString(a).getFlatMidpoint();break;case ol.geom.GeometryType.POLYGON:t=a.getFlatInteriorPoint();break;case ol.geom.GeometryType.MULTI_POLYGON:t=this.getLargestPolygon(a).getFlatInteriorPoint()}return t},naji.util.njMapGeoSpatialUtil=new naji.util.njMapGeoSpatialUtil}(),function(){"use strict";naji.util.njMapUtil=function(){return{isXMLDoc:this.isXMLDoc,xmlToJson:this.xmlToJson,objectMerge:this.objectMerge,cloneStyle:this.cloneStyle,cloneFeature:this.cloneFeature,cloneFeatures:this.cloneFeatures,cloneGeometry:this.cloneGeometry,generateUUID:this.generateUUID,appendParams:this.appendParams,setCssTextStyle:this.setCssTextStyle,numberWithCommas:this.numberWithCommas}},naji.util.njMapUtil.prototype.numberWithCommas=function(e){if(!e)return 0;var t=e.toString().split(".");return t[0].replace(/\B(?=(\d{3})+(?!\d))/g,",")+(t[1]?"."+t[1]:"")},naji.util.njMapUtil.prototype.xmlToJson=function(e){var t={};if(1==e.nodeType){if(0<e.attributes.length){t["@attributes"]={};for(var a=0;a<e.attributes.length;a++){var n=e.attributes.item(a);t["@attributes"][n.nodeName]=n.nodeValue}}}else 3==e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes())for(var i=0;i<e.childNodes.length;i++){var o=e.childNodes.item(i),r=o.nodeName;if(void 0===t[r])t[r]=this.xmlToJson(o);else{if(void 0===t[r].push){var s=t[r];t[r]=[],t[r].push(s)}t[r].push(this.xmlToJson(o))}}return t},naji.util.njMapUtil.prototype.isXMLDoc=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},naji.util.njMapUtil.prototype.appendParams=function(e,t){var a=[];Object.keys(t).forEach(function(e){null!==t[e]&&void 0!==t[e]&&a.push(e+"="+encodeURIComponent(t[e]))});var n=a.join("&");return(e=-1===(e=e.replace(/[?&]$/,"")).indexOf("?")?e+"?":e+"&")+n},naji.util.njMapUtil.prototype.generateUUID=function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==e?t:3&t|8).toString(16)})},naji.util.njMapUtil.prototype.objectMerge=function(){var e,t,a,n,i,o,r=arguments[0]||{},s=1,l=arguments.length,p=!1;for("boolean"==typeof r&&(p=r,r=arguments[s]||{},s++),"object"==typeof r||jQuery.isFunction(r)||(r={}),s===l&&(r=this,s--);s<l;s++)if(null!=(e=arguments[s]))for(t in e)a=r[t],r!==(n=e[t])&&(p&&n&&(jQuery.isPlainObject(n)||(i=Array.isArray(n)))?(o=i?(i=!1,a&&Array.isArray(a)?a:[]):a&&jQuery.isPlainObject(a)?a:{},r[t]=jQuery.extend(p,o,n)):void 0!==n&&(r[t]=n));return r},naji.util.njMapUtil.prototype.setCssTextStyle=function(e,t,a){var n,i=e.style.cssText.match(new RegExp("(?:[;\\s]|^)("+t.replace("-","\\-")+"\\s*:(.*?)(;|$))"));i?(n=i.index+i[0].indexOf(i[1]),e.style.cssText=e.style.cssText.substring(0,n)+t+": "+a+";"+e.style.cssText.substring(n+i[1].length)):e.style.cssText+=" "+t+": "+a+";"},naji.util.njMapUtil.prototype.cloneGeometry=function(e){return ol.geom[e.getType()].prototype.clone.call(e)},naji.util.njMapUtil.prototype.cloneFeature=function(e){var t=new ol.Feature(e.getProperties());t.setGeometryName(e.getGeometryName());var a=e.getGeometry();a&&t.setGeometry(this.cloneGeometry(a));var n=e.getStyle();return n&&t.setStyle(n),t},naji.util.njMapUtil.prototype.cloneFeatures=function(e){if(!Array.isArray(e))return!1;var t=[];for(var a in e)t.push(this.cloneFeature(e[a]));return t},naji.util.njMapUtil.prototype.cloneStyle=function(e){var t=e.getGeometry();return t&&t.clone&&(t=this.cloneGeometry(t)),new ol.style.Style({geometry:t,fill:e.getFill()?e.getFill().clone():void 0,image:e.getImage()?e.getImage().clone():void 0,stroke:e.getStroke()?e.getStroke().clone():void 0,text:e.getText()?e.getText().clone():void 0,zIndex:e.getZIndex()})},naji.util.njMapUtil=new naji.util.njMapUtil}(),function(){"use strict";ol.format.filter.dwithin=function(e,t,a,n,i){function o(e,t,a,n,i){ol.format.filter.Spatial.call(this,"DWithin",e,t,a),this.distance=n,this.units=i||"m"}function r(e,t,a){a[a.length-1].srsName=t.srsName,ol.format.WFS.writeOgcPropertyName_(e,t.geometryName),ol.format.GML3.prototype.writeGeometryElement(e,t.geometry,a);var n=ol.xml.createElementNS("http://www.opengis.net/ogc","Distance");n.setAttribute("units",t.units),ol.format.XSD.writeStringTextNode(n,t.distance+""),e.appendChild(n)}return ol.format.filter.DWithin=o,ol.inherits(ol.format.filter.DWithin,ol.format.filter.Spatial),ol.format.WFS.GETFEATURE_SERIALIZERS_["http://www.opengis.net/ogc"].DWithin=ol.xml.makeChildAppender(r),new ol.format.filter.DWithin(e,t,a,n,i)}}(),function(){"use strict";naji.service.njMapDescribeFeatureType=function(e){var t,a=this;return this.version=null,this.useProxy=null,this.typeName=null,this.serviceURL=null,this.dataViewId=null,this.promise=null,t=e||{},a.version=void 0!==t.version?t.version:"1.1.0",a.useProxy=void 0===t.useProxy||t.useProxy,a.typeName=void 0!==t.typeName?t.typeName:"",a.dataViewId=void 0!==t.dataViewId?t.dataViewId:"",a.serviceURL="string"==typeof t.serviceURL?t.serviceURL:"",a._callAjax(),a.promise},naji.service.njMapDescribeFeatureType.prototype._getAttribute=function(){return{SERVICE:"WFS",VERSION:this.version,REQUEST:"DescribeFeatureType",TYPENAME:this.typeName}},naji.service.njMapDescribeFeatureType.prototype._callAjax=function(){var i=this;i.promise=_$.Deferred();var e=naji.util.njMapUtil.appendParams(i.serviceURL,i._getAttribute());i.useProxy&&(e=naji.njMapConfig.getProxy()+e),new naji.njMapHttp.requestData({url:e,type:"GET",loading:!0,contentType:"",dataType:"XML",dataViewId:i.dataViewId}).then(function(e){var t={state:!1,message:void 0,data:{xmlJson:void 0,document:e,serviceMetaData:void 0}};try{var a=naji.util.njMapUtil.xmlToJson(e);if("ogc:ServiceExceptionReport"===e.childNodes[0].nodeName||"ServiceExceptionReport"===e.childNodes[0].nodeName){var n=a["ogc:ServiceExceptionReport"]["ogc:ServiceException"]["#text"];t.state=!1,t.message="ServiceExceptionReport : \n"+n}else if("ows:ExceptionReport"===e.childNodes[0].nodeName||"ExceptionReport"===e.childNodes[0].nodeName){n=a["ows:ExceptionReport"]["ows:Exception"]["ows:ExceptionText"]["#text"];t.state=!1,t.message="ExceptionReport : \n"+n}else t.state=!0,t.data.xmlJson=a,t.data.serviceMetaData=i._getServiceMetaData(a);i.promise.resolveData=t,i.promise.resolve(t)}catch(e){i.promise.reject(e)}},function(e){i.promise.reject(e)})},naji.service.njMapDescribeFeatureType.prototype._getServiceMetaData=function(e){var t={},a=!1,n="the_geom",i=e["xsd:schema"]["xsd:complexType"]["xsd:complexContent"]["xsd:extension"]["xsd:sequence"]["xsd:element"];for(var o in i){var r=i[o]["@attributes"].name,s=i[o]["@attributes"].type;a||"gml"!==s.split(":")[0]?t[r]=s.split(":")[1]:(a=!0,n=r)}return{sequence:t,geometryName:n}}}(),function(){"use strict";naji.service.njMapGetFeature=function(n){var i=this;return this.filter=null,this.srsName=null,this.useProxy=null,this.serviceURL=null,this.typeName=null,this.maxFeatures=null,this.outputFormat=null,this.dataViewId=null,this.deferred=null,function(){var e=n||{};i.deferred=_$.Deferred(),i.filter=void 0!==e.filter?e.filter:void 0,i.useProxy=void 0===e.useProxy||e.useProxy,i.serviceURL=void 0!==e.serviceURL?e.serviceURL:"",i.srsName=void 0!==e.srsName?e.srsName:"EPSG:3857",i.typeName=void 0!==e.typeName?e.typeName:[],i.maxFeatures=void 0!==e.maxFeatures?e.maxFeatures:1e3,i.outputFormat=void 0!==e.outputFormat?e.outputFormat:"text/xml; subtype=gml/3.1.1",i.dataViewId=void 0!==e.dataViewId?e.dataViewId:"";var t=(new ol.format.WFS).writeGetFeature({filter:i.filter,srsName:i.srsName,featureTypes:[i.typeName],maxFeatures:i.maxFeatures,outputFormat:i.outputFormat}),a=i.serviceURL;i.useProxy&&(a=naji.njMapConfig.getProxy()+a),new naji.njMapHttp.requestData({url:a,dataType:"",type:"POST",contentType:"text/xml",dataViewId:i.dataViewId,data:(new XMLSerializer).serializeToString(t)}).then(function(e){var t={state:!1,message:null,features:null,typeName:i.typeName};try{if(naji.util.njMapUtil.isXMLDoc(e)){var a=naji.util.njMapUtil.xmlToJson(e);if("ogc:ServiceExceptionReport"===e.childNodes[0].nodeName||"ServiceExceptionReport"===e.childNodes[0].nodeName){var n=a["ogc:ServiceExceptionReport"]["ogc:ServiceException"]["#text"];t.state=!1,t.message="ServiceExceptionReport : <br>"+n}else if("ows:ExceptionReport"===e.childNodes[0].nodeName||"ExceptionReport"===e.childNodes[0].nodeName){n=a["ows:ExceptionReport"]["ows:Exception"]["ows:ExceptionText"]["#text"];t.state=!1,t.message="ExceptionReport : <br>"+n}else t.state=!0,t.features=(new ol.format.WFS).readFeatures(e)}else t.state=!0,t.features=(new ol.format.GeoJSON).readFeatures(e);i.deferred.resolve(t)}catch(e){i.deferred.reject(e)}}).fail(function(e){i.deferred.reject(e)})}(),i.deferred.promise()}}(),function(){"use strict";naji.service.njMapGetCapabilitiesDefault=function(e){var t,a=this;return this.service=null,this.version=null,this.useProxy=null,this.serviceURL=null,this.dataViewId=null,this.request=null,t=e||{},a.request="GetCapabilities",a.useProxy=void 0===t.useProxy||t.useProxy,a.service="string"==typeof t.service?t.service:"WMS",a.serviceURL="string"==typeof t.serviceURL?t.serviceURL:"",a._setVersion(t.version),a.dataViewId=void 0!==t.dataViewId?t.dataViewId:"",{getAttribute:a.getAttribute}},naji.service.njMapGetCapabilitiesDefault.prototype._setVersion=function(e){var t=this._this||this;if(e)t.version=e;else switch(t.service){case"WMS":t.version="1.3.0";break;case"WFS":t.version="1.1.0";break;case"WCS":t.version="1.1.1";break;case"WMTS":t.version="1.0.0";break;default:t.version="1.3.0"}},naji.service.njMapGetCapabilitiesDefault.prototype.getAttribute=function(){var e=this._this||this;return{SERVICE:e.service,VERSION:e.version,REQUEST:e.request}},naji.service.njMapGetCapabilitiesDefault.prototype.callAjax=function(){var e=this._this||this,i=_$.Deferred(),t=naji.util.njMapUtil.appendParams(e.serviceURL,e.getAttribute());return e.useProxy&&(t=naji.njMapConfig.getProxy()+t),new naji.njMapHttp.requestData({url:t,type:"GET",loading:!0,contentType:"",dataType:"XML",dataViewId:e.dataViewId}).then(function(e){var t={state:!1,message:null,xmlJson:null,document:e};try{var a=naji.util.njMapUtil.xmlToJson(e);if(t.xmlJson=a,"ogc:ServiceExceptionReport"===e.childNodes[0].nodeName||"ServiceExceptionReport"===e.childNodes[0].nodeName){var n=a["ogc:ServiceExceptionReport"]["ogc:ServiceException"]["#text"];t.state=!1,t.message="ServiceExceptionReport : <br>"+n}else if("ows:ExceptionReport"===e.childNodes[0].nodeName||"ExceptionReport"===e.childNodes[0].nodeName){n=a["ows:ExceptionReport"]["ows:Exception"]["ows:ExceptionText"]["#text"];t.state=!1,t.message="ExceptionReport : <br>"+n}else t.state=!0;i.resolve(t)}catch(e){i.reject(e)}}).fail(function(e){i.reject(e)}),i.promise()}}(),function(){"use strict";naji.service.njMapGetCapabilitiesWCS=function(e){var t,a=this;return this.promise=null,(t=e||{}).service="WCS",naji.service.njMapGetCapabilitiesDefault.call(a,t),a.promise=a.callAjax(),a.promise.then(function(e){(new ol.format.WMSCapabilities).read(e.document);var t={olJson:void 0,xmlJson:e.xmlJson,document:e.document,serviceMetaData:a.getServiceMetaDataWCS(e.xmlJson)};a.promise.data=t}),a.promise},naji.service.njMapGetCapabilitiesWCS.prototype=Object.create(naji.service.njMapGetCapabilitiesDefault.prototype),naji.service.njMapGetCapabilitiesWCS.prototype.constructor=naji.service.njMapGetCapabilitiesWCS,naji.service.njMapGetCapabilitiesWCS.prototype.getServiceMetaDataWCS=function(e){var t=e,a=t["wcs:Capabilities"]["@attributes"].version,n=t["wcs:Capabilities"]["ows:ServiceIdentification"]["ows:Title"];n=n?n["#text"]:"null";var i=t["wcs:Capabilities"]["ows:ServiceIdentification"]["ows:Abstract"];i=i?i["#text"]:"null";var o=t["wcs:Capabilities"]["ows:ServiceIdentification"]["ows:Fees"];o=o?o["#text"]:"null";var r=t["wcs:Capabilities"]["ows:ServiceIdentification"]["ows:AccessConstraints"];r=r?r["#text"]:"null";var s=[],l=t["wcs:Capabilities"]["ows:ServiceIdentification"]["ows:Keywords"];if(l)for(var p in l=l["ows:Keyword"])s.push(l[p]["#text"]);var c=t["wcs:Capabilities"]["ows:ServiceProvider"]["ows:ProviderName"];c=c?c["#text"]:"null";var u=t["wcs:Capabilities"]["ows:ServiceProvider"]["ows:ProviderSite"];u=u?u["#text"]:"null";var y=t["wcs:Capabilities"]["wcs:Contents"]["wcs:SupportedFormat"],d=[];for(var p in y)d.push(y[p]["#text"]);var h=t["wcs:Capabilities"]["wcs:Contents"]["wcs:CoverageSummary"];Array.isArray(h)||(h=[h]);var g=[];for(var p in h){var M=h[p]["ows:WGS84BoundingBox"];M=M?M["ows:LowerCorner"]["#text"]:h[p]["ows:BoundingBox"]["ows:LowerCorner"]["#text"];var m=h[p]["ows:WGS84BoundingBox"];m=m?m["ows:UpperCorner"]["#text"]:h[p]["ows:BoundingBox"]["ows:UpperCorner"]["#text"];var j,f=[];f[0]=parseFloat(M.split(" ")[0]),f[1]=parseFloat(M.split(" ")[1]),f[2]=parseFloat(m.split(" ")[0]),f[3]=parseFloat(m.split(" ")[1]),j="2.0.1"===a?(j=h[p]["wcs:CoverageId"])?j["#text"]:h[p].CoverageId["#text"]:(j=h[p]["wcs:Identifier"])?j["#text"]:h[p].Identifier["#text"],g.push({Identifier:j,BBOX:f})}return{crs:"EPSG:4326",fees:o,title:n,abstract:i,coverages:g,keywords:s,providerSite:u,providerName:c,accessconstraints:r,supportedFormats:d}}}(),function(){"use strict";naji.service.njMapGetCapabilitiesWFS=function(e){var t,a=this;return this.promise=null,(t=e||{}).service="WFS",naji.service.njMapGetCapabilitiesDefault.call(a,t),a.promise=a.callAjax(),a.promise.then(function(e){(new ol.format.WMSCapabilities).read(e.document);var t={xmlJson:e.xmlJson,document:e.document,serviceMetaData:a.getServiceMetaDataWFS(e.xmlJson)};a.promise.data=t}),a.promise},naji.service.njMapGetCapabilitiesWFS.prototype=Object.create(naji.service.njMapGetCapabilitiesDefault.prototype),naji.service.njMapGetCapabilitiesWFS.prototype.constructor=naji.service.njMapGetCapabilitiesWFS,naji.service.njMapGetCapabilitiesWFS.prototype.getServiceMetaDataWFS=function(e){var t=e,a=t["wfs:WFS_Capabilities"]["ows:ServiceIdentification"]["ows:Title"]["#text"],n=t["wfs:WFS_Capabilities"]["ows:ServiceIdentification"]["ows:Abstract"]["#text"],i=t["wfs:WFS_Capabilities"]["ows:ServiceIdentification"]["ows:Fees"]["#text"],o=t["wfs:WFS_Capabilities"]["ows:ServiceIdentification"]["ows:AccessConstraints"]["#text"],r="EPSG:4326",s=[],l=t["wfs:WFS_Capabilities"]["ows:ServiceIdentification"]["ows:Keywords"]["ows:Keyword"];for(var p in l)s.push(l[p]["#text"]);var c=t["wfs:WFS_Capabilities"]["ows:ServiceProvider"]["ows:ProviderName"],u=t["wfs:WFS_Capabilities"]["ows:ServiceProvider"]["ows:ProviderSite"];void 0!==c&&(c=c["#text"]),void 0!==u&&(u=u["#text"]);var y=[],d=t["wfs:WFS_Capabilities"].FeatureTypeList;if(d&&d.FeatureType){var h=d.FeatureType;if(Array.isArray(h))for(var p in r=h[0].DefaultSRS["#text"],h){var g={Title:h[p].Title["#text"],Name:h[p].Name["#text"]};y.push(g)}else{r=h.DefaultSRS["#text"];g={Title:h.Title["#text"],Name:h.Name["#text"]};y.push(g)}}return{crs:r,fees:i,title:a,abstract:n,keywords:s,providerSite:u,providerName:c,accessconstraints:o,layers:y}}}(),function(){"use strict";naji.service.njMapGetCapabilitiesWMS=function(e){var t,n=this;return this.promise=null,(t=e||{}).service="WMS",naji.service.njMapGetCapabilitiesDefault.call(n,t),n.promise=n.callAjax(),n.promise.then(function(e){var t=(new ol.format.WMSCapabilities).read(e.document),a={olJson:t,xmlJson:e.xmlJson,document:e.document,serviceMetaData:n.getServiceMetaDataWMS(t)};n.promise.data=a}),n.promise},naji.service.njMapGetCapabilitiesWMS.prototype=Object.create(naji.service.njMapGetCapabilitiesDefault.prototype),naji.service.njMapGetCapabilitiesWMS.prototype.constructor=naji.service.njMapGetCapabilitiesWMS,naji.service.njMapGetCapabilitiesWMS.prototype.getServiceMetaDataWMS=function(e){var t=e,a=t.Service.Name,n=t.version,i="",o=t.Capability.Request.GetCapabilities.Format;for(var r in o)i+=o[r]+(o.length-1==r?"":", ");var s="",l=t.Capability.Request.GetMap.Format;for(var r in l)s+=l[r]+(l.length-1==r?"":", ");var p="",c=t.Capability.Request.GetFeatureInfo.Format;for(var r in c)p+=c[r]+(c.length-1==r?"":", ");var u="",y=t.Capability.Exception;for(var r in y)u+=y[r]+(y.length-1==r?"":", ");var d,h,g=t.Capability.Layer.EX_GeographicBoundingBox,M=t.Capability.Layer.BoundingBox[0].extent,m=t.Capability.Layer.BoundingBox[0].crs,j=t.Service.Title,f=t.Service.OnlineResource,v=t.Service.Abstract,_=t.Service.Fees,S=t.Service.AccessConstraints;return void 0!==t.Service.ContactInformation&&(d=t.Service.ContactInformation.ContactPersonPrimary.ContactPerson,h=t.Service.ContactInformation.ContactPersonPrimary.ContactOrganization),"CRS:84"!==m&&"EPSG:4326"!==m||(M=[-185.8007812499999,-46.07323062540835,472.67578125000006,65.94647177615741]),{crs:m,fees:_,title:j,WGS84:g,service:a,version:n,keywordList:t.Service.KeywordList,abstract:v,maxExtent:M,getMapFormat:s,contactPerson:d,onlineResource:f,exceptionFormat:u,accessConstraints:S,contactOrganization:h,getFeatureInfoFormat:p,getCapabilitiesFormat:i}}}(),function(){"use strict";naji.service.njMapGetCapabilitiesWMTS=function(e){var t,u=this;return this.promise=null,(t=e||{}).service="WMTS",naji.service.njMapGetCapabilitiesDefault.call(u,t),u.promise=u.callAjax(),u.promise.then(function(e){var t=(new ol.format.WMTSCapabilities).read(e.document),a=e.xmlJson,n=u.getServiceMetaDataWMTS(t),i=a.Capabilities.Contents.Layer.Style;if(void 0!==i){var o=i["ows:LegendURL"];void 0!==o&&(o=o["ows:OnlineResource"]["@attributes"]["xlink:href"],n.legendURL=o)}var r=a.Capabilities["ows:ServiceIdentification"];if(void 0!==r&&(r["ows:Abstract"]&&(n.abstract=r["ows:Abstract"]["#text"]),r["ows:AccessConstraints"]&&(n.accessconstraints=r["ows:AccessConstraints"]["#text"]),r["ows:Fees"]&&(n.fees=r["ows:Fees"]["#text"]),r["ows:Keywords"])){var s=r["ows:Keywords"]["ows:Keyword"],l=[];if(void 0!==s)if(Array.isArray(s))for(var p in s)l.push(s[p]["#text"]);else l.push(s["#text"]);n.keywords=l}var c={olJson:t,xmlJson:e.xmlJson,document:e.document,serviceMetaData:n};u.promise.data=c}),u.promise},naji.service.njMapGetCapabilitiesWMTS.prototype=Object.create(naji.service.njMapGetCapabilitiesDefault.prototype),naji.service.njMapGetCapabilitiesWMTS.prototype.constructor=naji.service.njMapGetCapabilitiesWMTS,naji.service.njMapGetCapabilitiesWMTS.prototype.getServiceMetaDataWMTS=function(e){var t=e,a=t.Contents.TileMatrixSet;a=Array.isArray(a)?a[0].SupportedCRS:a.SupportedCRS;var n=t.ServiceIdentification.Title,i=t.ServiceIdentification.Abstract,o=t.ServiceIdentification.Fees,r=t.ServiceIdentification.AccessConstraints,s=[],l=t.ServiceIdentification.Keywords;if(void 0!==l)if(Array.isArray(l))for(var p in l)s.push(l[p].Keyword);else s.push(l.Keyword);return{crs:a,fees:o,title:n,abstract:i,keywords:s,accessconstraints:r}}}(),function(){"use strict";naji.layer.njMapLayerDefault=function(e){var t,a=this;return this.useProxy=null,this.serviceURL=null,this.useGetFeature=null,this.olLayer=null,this.id=null,this.name=null,this.layerKey=null,this.layerType=null,this.isUseLoading=null,this.tocVisibleFlag=null,this.layerVisibleFlag=null,this.scaleVisibleFlag=null,this.minZoom=null,this.maxZoom=null,t=e||{},a.isUseLoading=naji.njMapConfig.isUseLoading(),a.useProxy=void 0!==t.useProxy&&t.useProxy,a.serviceURL=void 0!==t.serviceURL?t.serviceURL:"",a.useGetFeature=void 0!==t.useGetFeature&&t.useGetFeature,a.id=void 0!==t.id?t.id:"",a.name=void 0!==t.name?t.name:"",a.layerKey=naji.util.njMapUtil.generateUUID(),a.layerType=void 0!==t.layerType?t.layerType:"",a.tocVisibleFlag=void 0===t.tocVisible||t.tocVisible,a.layerVisibleFlag=void 0===t.layerVisible||t.layerVisible,a.scaleVisibleFlag=void 0===t.scaleVisible||t.scaleVisible,a.minZoom=void 0!==t.minZoom?t.minZoom:0,a.maxZoom=void 0!==t.maxZoom?t.maxZoom:21,{destroy:a.destroy,setMinZoom:a.setMinZoom,setMaxZoom:a.setMaxZoom,getMinZoom:a.getMinZoom,getMaxZoom:a.getMaxZoom,getVisible:a.getVisible,getLayerVisible:a.getLayerVisible,getOlLayer:a.getOlLayer,getId:a.getId,getName:a.getName,getLayerKey:a.getLayerKey,getLayerType:a.getLayerType,getServiceURL:a.getServiceURL,visibleToggle:a.visibleToggle,setTocVisible:a.setTocVisible,setScaleVisible:a.setScaleVisible,setLayerVisible:a.setLayerVisible,getUseGetFeature:a.getUseGetFeature,setUseGetFeature:a.setUseGetFeature}},naji.layer.njMapLayerDefault.prototype.getServiceURL=function(){return(this._this||this).serviceURL},naji.layer.njMapLayerDefault.prototype.getId=function(){return(this._this||this).id},naji.layer.njMapLayerDefault.prototype.getName=function(){return(this._this||this).name},naji.layer.njMapLayerDefault.prototype.getLayerKey=function(){return(this._this||this).layerKey},naji.layer.njMapLayerDefault.prototype.getLayerType=function(){return(this._this||this).layerType},naji.layer.njMapLayerDefault.prototype.getOlLayer=function(){return(this._this||this).olLayer},naji.layer.njMapLayerDefault.prototype.getVisible=function(){var e=this._this||this;return e.olLayer.getVisible()&&e.layerVisibleFlag&&e.tocVisibleFlag&&e.scaleVisibleFlag},naji.layer.njMapLayerDefault.prototype.getLayerVisible=function(){return(this._this||this).layerVisibleFlag},naji.layer.njMapLayerDefault.prototype.setLayerVisible=function(e){var t=this._this||this;return"boolean"==typeof e&&(e?t.tocVisibleFlag&&t.scaleVisibleFlag&&t.olLayer.setVisible(!0):t.olLayer.setVisible(!1),t.layerVisibleFlag=e,{OpenLayersVisible:t.olLayer.getVisible(),LayerVisible:t.layerVisibleFlag,TocVisible:t.tocVisibleFlag,ScaleVisible:t.scaleVisibleFlag})},naji.layer.njMapLayerDefault.prototype.visibleToggle=function(){var e=this._this||this;e.setLayerVisible(!e.layerVisibleFlag)},naji.layer.njMapLayerDefault.prototype.setTocVisible=function(e){var t=this._this||this;return"boolean"==typeof e&&(e?t.layerVisibleFlag&&t.scaleVisibleFlag&&t.olLayer.setVisible(!0):t.olLayer.setVisible(!1),t.tocVisibleFlag=e,{OpenLayersVisible:t.olLayer.getVisible(),LayerVisible:t.layerVisibleFlag,TocVisible:t.tocVisibleFlag,ScaleVisible:t.scaleVisibleFlag})},naji.layer.njMapLayerDefault.prototype.setScaleVisible=function(e){var t=this._this||this;return"boolean"==typeof e&&(e?t.layerVisibleFlag&&t.tocVisibleFlag&&t.olLayer.setVisible(!0):t.olLayer.setVisible(!1),t.scaleVisibleFlag=e,{OpenLayersVisible:t.olLayer.getVisible(),LayerVisible:t.layerVisibleFlag,TocVisible:t.tocVisibleFlag,ScaleVisible:t.scaleVisibleFlag})},naji.layer.njMapLayerDefault.prototype.setMinZoom=function(e){var t=this._this||this;t.minZoom=e,t.olLayer.dispatchEvent({type:"change:zoom"})},naji.layer.njMapLayerDefault.prototype.setMaxZoom=function(e){var t=this._this||this;t.maxZoom=e,t.olLayer.dispatchEvent({type:"change:zoom"})},naji.layer.njMapLayerDefault.prototype.getMinZoom=function(){return(this._this||this).minZoom},naji.layer.njMapLayerDefault.prototype.getMaxZoom=function(){return(this._this||this).maxZoom},naji.layer.njMapLayerDefault.prototype.getUseGetFeature=function(){return(this._this||this).useGetFeature},naji.layer.njMapLayerDefault.prototype.setUseGetFeature=function(e){var t=this._this||this;t.useGetFeature="boolean"==typeof e&&e},naji.layer.njMapLayerDefault.prototype.destroy=function(){this._this}}(),function(){"use strict";naji.layer.njMapClusterLayer=function(e){var t,a=this,n=null;return this.style=null,this.distance=null,this.features=null,this.clusters=null,this.animation=null,this.oldcluster=null,this.useAnimation=null,(t=e||{}).layerType="Cluster",t.useGetFeature=!1,n=naji.layer.njMapLayerDefault.call(a,t),a.clusters=[],a.oldcluster=new ol.source.Vector,a.animation={start:!1},a.style=void 0!==t.style?t.style:a._defaultStyle,a.features=void 0!==t.features?t.features:[],a.distance="number"==typeof t.distance?t.distance:50,a.useAnimation="boolean"!=typeof t.useAnimation||t.useAnimation,a._init(),naji.util.njMapUtil.objectMerge(n,{_this:a,setDistance:a.setDistance,setUseAnimation:a.setUseAnimation})},naji.layer.njMapClusterLayer.prototype=Object.create(naji.layer.njMapLayerDefault.prototype),naji.layer.njMapClusterLayer.prototype.constructor=naji.layer.njMapClusterLayer,naji.layer.njMapClusterLayer.prototype._init=function(e){var i=this._this||this;i.olLayer=new ol.layer.Vector({source:new ol.source.Cluster({distance:i.distance,source:new ol.source.Vector({features:i.features})}),style:function(e,t){var a=e.get("features").length,n=o[a];n||(n="function"==typeof i.style?i.style.call(this,e,t):i.style,o[a]=n);return[n]}}),i.setUseAnimation(i.useAnimation),i.olLayer.set("animationMethod",ol.easing.easeOut),i.olLayer.getSource().on("change",i._saveCluster,i),i.olLayer.on("precompose",i._animate,i),i.olLayer.on("postcompose",i._postanimate,i);var o={}},naji.layer.njMapClusterLayer.prototype._defaultStyle=function(e,t){var a=e.get("features").length,n=25<a?"192,0,0":8<a?"255,128,0":"0,128,0",i=Math.max(8,Math.min(.75*a,20)),o=[0,o=2*Math.PI*i/6,o,o,o,o,o];return new ol.style.Style({image:new ol.style.Circle({radius:i,stroke:new ol.style.Stroke({color:"rgba("+n+",0.5)",width:15,lineDash:o,lineCap:"butt"}),fill:new ol.style.Fill({color:"rgba("+n+",1)"})}),text:new ol.style.Text({text:a.toString(),fill:new ol.style.Fill({color:"#fff"})})})},naji.layer.njMapClusterLayer.prototype.setUseAnimation=function(e){(this._this||this).olLayer.set("animationDuration",e?700:0)},naji.layer.njMapClusterLayer.prototype.setDistance=function(e){var t=(this._this||this).olLayer.getSource();ol.source.Cluster.prototype.setDistance.call(t,e)},naji.layer.njMapClusterLayer.prototype._saveCluster=function(){var e=this._this||this;if(e.oldcluster.clear(),e.olLayer.get("animationDuration")){var t=e.olLayer.getSource().getFeatures();t.length&&t[0].get("features")&&(e.oldcluster.addFeatures(e.clusters),e.clusters=t.slice(0),e.sourceChanged=!0)}},naji.layer.njMapClusterLayer.prototype._getClusterForFeature=function(e,t){this._this;for(var a=0;t[a];a++){var n=t[a].get("features");if(n&&n.length)for(var i,o=0;i=n[o];o++)if(e===i)return t[a]}return!1},naji.layer.njMapClusterLayer.prototype._stopAnimation=function(){var e=this._this||this;e.animation.start=!1,e.animation.cA=[],e.animation.cB=[]},naji.layer.njMapClusterLayer.prototype._animate=function(e){var t=this._this||this,a=t.olLayer.get("animationDuration");if(a){var n=e.frameState.viewState.resolution,i=t.animation,o=e.frameState.time;if(i.resolution!=n&&t.sourceChanged){var r=e.frameState.extent;i.resolution<n?(r=ol.extent.buffer(r,100*n),i.cA=t.oldcluster.getFeaturesInExtent(r),i.cB=t.olLayer.getSource().getFeaturesInExtent(r),i.revers=!1):(r=ol.extent.buffer(r,100*n),i.cA=t.olLayer.getSource().getFeaturesInExtent(r),i.cB=t.oldcluster.getFeaturesInExtent(r),i.revers=!0),i.clusters=[];for(var s,l=0;s=i.cA[l];l++){var p=s.get("features");if(p&&p.length)(h=t._getClusterForFeature(p[0],i.cB))&&i.clusters.push({f:s,pt:h.getGeometry().getCoordinates()})}if(i.resolution=n,t.sourceChanged=!1,!i.clusters.length||1e3<i.clusters.length)return void t._stopAnimation();o=i.start=(new Date).getTime()}if(i.start){var c=e.vectorContext,u=(o-i.start)/a;1<u&&(t._stopAnimation(),u=1),u=t.olLayer.get("animationMethod")(u);var y=t.olLayer.getStyle(),d="function"==typeof y?y:y.length?function(){return y}:function(){return[y]};e.context.save(),e.context.globalAlpha=t.olLayer.getOpacity();var h,g=e.frameState.pixelRatio;for(l=0;h=i.clusters[l];l++){var M=h.f.getGeometry().getCoordinates();i.revers?(M[0]=h.pt[0]+u*(M[0]-h.pt[0]),M[1]=h.pt[1]+u*(M[1]-h.pt[1])):(M[0]=M[0]+u*(h.pt[0]-M[0]),M[1]=M[1]+u*(h.pt[1]-M[1]));for(var m,j=d(h.f,n),f=new ol.geom.Point(M),v=0;m=j[v];v++){var _,S=!ol.Map.prototype.getFeaturesAtPixel&&m.getImage();S&&(_=S.getScale(),S.setScale(_*g)),c.setStyle?(c.setStyle(m),c.drawGeometry(f)):(c.setImageStyle(S),c.setTextStyle(m.getText()),c.drawPointGeometry(f)),S&&S.setScale(_)}}e.context.restore(),e.frameState.animate=!0,e.context.save(),e.context.beginPath(),e.context.rect(0,0,0,0),e.context.clip(),t.clip_=!0}}},naji.layer.njMapClusterLayer.prototype._postanimate=function(e){var t=this._this||this;t.clip_&&(e.context.restore(),t.clip_=!1)}}(),function(){"use strict";naji.layer.njMapGSSWMTSLayer=function(n){var i=this,o=null;return this.layer=null,this.style=null,this.version=null,this.matrixSet=null,this.tileGrid=null,this.zoomOffset=null,this.format=null,this.originExtent=null,this.wmtsCapabilities=null,function(){var e=n||{};e.layerType="GSS_WMTS",e.useGetFeature=!1,o=naji.layer.njMapLayerDefault.call(i,e),i.version=void 0!==e.version?e.version:"1.0.0",i.layer=void 0!==e.layer?e.layer:"",i.style=void 0!==e.style?e.style:"",i.matrixSet=void 0!==e.matrixSet?e.matrixSet:"",i.originExtent=i._setOriginExtent(e.originExtent),i.tileGrid=i._setTileGrid(e),i.zoomOffset=void 0!==e.zoomOffset?e.zoomOffset:-1,i.format=void 0!==e.format?e.format:"image/png";var t=i.serviceURL;i.useProxy&&(-1===t.indexOf("?")?t+="??":t.indexOf("?")===t.length-1&&(t=t.replace("?","??")),t=naji.njMapConfig.getProxy()+t);var a=new ol.source.WMTS({url:t,layer:i.layer,matrixSet:i.matrixSet,tileGrid:i.tileGrid,zoomOffset:i.zoomOffset,format:i.format});i.olLayer=new ol.layer.Tile({opacity:e.opacity,source:a})}(),naji.util.njMapUtil.objectMerge(o,{_this:i,layer:i.layer,version:i.version,matrixSet:i.matrixSet,setTileGrid:i._setTileGrid,getTileGrid:i.getTileGrid,getOriginExtent:i.getOriginExtent,setOriginExtent:i._setOriginExtent})};var e=naji.layer.njMapGSSWMTSLayer;e.prototype=Object.create(naji.layer.njMapLayerDefault.prototype),(e.prototype.constructor=e).prototype._setOriginExtent=function(e){var t=this._this||this;return e&&3<e.length?t.originExtent=e:t.originExtent=void 0,t.originExtent},e.prototype._setTileGrid=function(e){var t=this._this||this;return t.tileGrid=new ol.tilegrid.WMTS({origin:e.origin,tileSize:e.tileSize,resolutions:e.resolutions,matrixIds:e.matrixIds}),t.tileGrid},e.prototype.getOriginExtent=function(){return(this._this||this).originExtent},e.prototype.getTileGrid=function(){return(this._this||this).tileGrid},e.prototype.setUseGetFeature=function(){(this._this||this).useGetFeature=!1}}(),function(){"use strict";naji.layer.njMapVector3DLayer=function(e){var t,a=this,n=null;return this.style=null,this.initBuild=null,this.features=null,this.srsName=null,this.labelColumn=null,this.heightColumn=null,this.maxResolution=null,this.njMapRender3D=null,(t=e||{}).layerType="Vector3D",t.useGetFeature=!0,n=naji.layer.njMapLayerDefault.call(a,t),a.style=void 0!==t.style?t.style:void 0,a.features=void 0!==t.features?t.features:[],a.srsName=void 0!==t.srsName?t.srsName:"EPSG:3857",a.labelColumn=void 0!==t.labelColumn?t.labelColumn:"",a.initBuild="boolean"!=typeof t.initBuild||t.initBuild,a.heightColumn=void 0!==t.heightColumn?t.heightColumn:"",a.maxResolution="number"==typeof t.maxResolution?t.maxResolution:.6,a._init(),naji.util.njMapUtil.objectMerge(n,{_this:a,clear:a.clear,srsName:a.srsName,getFeatures:a.getFeatures,addFeatures:a.addFeatures,getRender3D:a.getRender3D})},naji.layer.njMapVector3DLayer.prototype=Object.create(naji.layer.njMapLayerDefault.prototype),naji.layer.njMapVector3DLayer.prototype.constructor=naji.layer.njMapVector3DLayer,naji.layer.njMapVector3DLayer.prototype._init=function(){var e=this._this||this;e.olLayer=new ol.layer.Vector({declutter:!0,source:new ol.source.Vector({features:e.features})}),e.njMapRender3D=new naji.etc.njMapRender3D({style:e.style,layer:e.olLayer,initBuild:e.initBuild,labelColumn:e.labelColumn,heightColumn:e.heightColumn,maxResolution:e.maxResolution})},naji.layer.njMapVector3DLayer.prototype.getRender3D=function(){return(this._this||this).njMapRender3D},naji.layer.njMapVector3DLayer.prototype.addFeatures=function(e){(this._this||this).olLayer.getSource().addFeatures(e)},naji.layer.njMapVector3DLayer.prototype.getFeatures=function(){return(this._this||this).olLayer.getSource().getFeatures()},naji.layer.njMapVector3DLayer.prototype.clear=function(){(this._this||this).olLayer.getSource().clear()}}(),function(){"use strict";naji.layer.njMapVectorLayer=function(e){var t,a=this,n=null;return this.style=null,this.features=null,this.srsName=null,this.declutter=null,(t=e||{}).layerType="Vector",t.useGetFeature=!0,n=naji.layer.njMapLayerDefault.call(a,t),a.style=void 0!==t.style?t.style:void 0,a.features=void 0!==t.features?t.features:[],a.srsName=void 0!==t.srsName?t.srsName:"EPSG:3857",a.declutter="boolean"!=typeof t.declutter||t.declutter,a.olLayer=new ol.layer.Vector({opacity:t.opacity,declutter:!1,style:a.style,source:new ol.source.Vector({features:a.features})}),naji.util.njMapUtil.objectMerge(n,{_this:a,clear:a.clear,srsName:a.srsName,getFeatures:a.getFeatures,addFeatures:a.addFeatures})},naji.layer.njMapVectorLayer.prototype=Object.create(naji.layer.njMapLayerDefault.prototype),naji.layer.njMapVectorLayer.prototype.constructor=naji.layer.njMapVectorLayer,naji.layer.njMapVectorLayer.prototype.addFeatures=function(e){(this._this||this).olLayer.getSource().addFeatures(e)},naji.layer.njMapVectorLayer.prototype.getFeatures=function(){return(this._this||this).olLayer.getSource().getFeatures()},naji.layer.njMapVectorLayer.prototype.clear=function(){(this._this||this).olLayer.getSource().clear()}}(),function(){"use strict";naji.layer.njMapWCSLayer=function(e){var t,a=this,n=null;return this.format=null,this.version=null,this.identifier=null,this.coverageId=null,this.boundingBox=null,this.useScaleRefresh=null,this.key_moveEnd=null,this.key_changeView=null,(t=e||{}).layerType="WCS",t.useGetFeature=!1,n=naji.layer.njMapLayerDefault.call(a,t),a.version=void 0!==t.version?t.version:"1.1.1",a.format=void 0!==t.format?t.format:"image/jpeg",a.identifier=void 0!==t.identifier?t.identifier:"",a.coverageId=void 0!==t.coverageId?t.coverageId:"",a.useScaleRefresh="boolean"==typeof t.useScaleRefresh&&t.useScaleRefresh,a.boundingBox=a._setBoundingBox(t.boundingBox),a.olLayer=new ol.layer.Image({}),naji.util.njMapUtil.objectMerge(n,{_this:a,setMap:a.setMap,update:a._update,version:a.version,identifier:a.identifier,useScaleRefresh:a.useScaleRefresh,setBoundingBox:a._setBoundingBox,getBoundingBox:a.getBoundingBox})},naji.layer.njMapWCSLayer.prototype=Object.create(naji.layer.njMapLayerDefault.prototype),naji.layer.njMapWCSLayer.prototype.constructor=naji.layer.njMapWCSLayer,naji.layer.njMapWCSLayer.prototype._setBoundingBox=function(e){var t=this._this||this;return e&&3<e.length?(t.boundingBox=e.slice(),e[4]||t.boundingBox.push("EPSG:4326")):t.boundingBox=void 0,t.boundingBox},naji.layer.njMapWCSLayer.prototype.setMap=function(e,t){var a=this._this||this;a._update(e.getView(),t),e&&a.useScaleRefresh&&(ol.Observable.unByKey(a.key_moveEnd),a.key_moveEnd=e.on("moveend",function(){a._update(e.getView(),t)})),a.key_changeView=e.once("change:view",function(){a.setMap(e,t)})},naji.layer.njMapWCSLayer.prototype._update=function(e,n){var t=this._this||this,a=e.calculateExtent();if(a=ol.proj.transformExtent(a,e.getProjection(),"EPSG:4326"),!ol.extent.intersects(a,t.boundingBox))return!1;var i={SERVICE:"WCS",REQUEST:"GetCoverage",FORMAT:t.format,VERSION:t.version,IDENTIFIER:t.identifier,COVERAGEID:t.identifier,BOUNDINGBOX:t.boundingBox};if("2.0.1"===t.version?delete i.IDENTIFIER:delete i.COVERAGEID,t.useScaleRefresh){var o=turf.polygon([[[a[0],a[1]],[a[0],a[3]],[a[2],a[3]],[a[2],a[1]],[a[0],a[1]]]]),r=turf.polygon([[[t.boundingBox[0],t.boundingBox[1]],[t.boundingBox[0],t.boundingBox[3]],[t.boundingBox[2],t.boundingBox[3]],[t.boundingBox[2],t.boundingBox[1]],[t.boundingBox[0],t.boundingBox[1]]]]),s=turf.intersect(o,r).geometry.coordinates[0],l=[s[0][0],s[0][1],s[2][0],s[2][1]];if(l[0]>l[2]){var p=l[2];l[2]=l[0],l[0]=p}if(l[1]>l[3]){p=l[3];l[3]=l[1],l[1]=p}i.BOUNDINGBOX=l}i.BOUNDINGBOX.push("EPSG:4326"),t.useProxy?t.getGetCoverageURL=naji.njMapConfig.getProxy()+naji.util.njMapUtil.appendParams(t.getServiceURL(),i):t.getGetCoverageURL=naji.util.njMapUtil.appendParams(t.getServiceURL(),i),n(!0),t.olLayer.setSource(new ol.source.ImageStatic({url:t.getGetCoverageURL,projection:"EPSG:4326",imageExtent:i.BOUNDINGBOX,imageLoadFunction:function(e,t){var a=e.getImage();a.onload=function(){n(!1)},a.onerror=function(){n(!1)},a.src=t}}))},naji.layer.njMapWCSLayer.prototype.getBoundingBox=function(){return(this._this||this).boundingBox},naji.layer.njMapWCSLayer.prototype.setUseGetFeature=function(){(this._this||this).useGetFeature=!1},naji.layer.njMapWCSLayer.prototype.destroy=function(){var e=this._this||this;ol.Observable.unByKey(e.key_moveEnd),ol.Observable.unByKey(e.key_changeView)}}(),function(){"use strict";naji.layer.njMapWFSLayer=function(e){var t,a=this,n=null;return this.filter=null,this.style=null,this.srsName=null,this.layerName=null,this.maxFeatures=null,(t=e||{}).layerType="WFS",t.useGetFeature=!0,n=naji.layer.njMapLayerDefault.call(a,t),a.filter=void 0!==t.filter?t.filter:void 0,a.style=void 0!==t.style?t.style:void 0,a.layerName=void 0!==t.layerName?t.layerName:"",a.srsName=void 0!==t.srsName?t.srsName:"EPSG:3857",a.maxFeatures=void 0!==t.maxFeatures?t.maxFeatures:1e3,a.olLayer=new ol.layer.Vector({opacity:t.opacity,declutter:!0,style:a.style,source:new ol.source.Vector}),naji.util.njMapUtil.objectMerge(n,{_this:a,srsName:a.srsName,layerName:a.layerName,getFeatures:a.getFeatures})},naji.layer.njMapWFSLayer.prototype=Object.create(naji.layer.njMapLayerDefault.prototype),naji.layer.njMapWFSLayer.prototype.constructor=naji.layer.njMapWFSLayer,naji.layer.njMapWFSLayer.prototype.getFeatures=function(e){var t=this._this||this;return new naji.service.njMapGetFeature({srsName:t.srsName,useProxy:t.useProxy,serviceURL:t.getServiceURL(),typeName:t.layerName,maxFeatures:t.maxFeatures,outputFormat:"application/json",filter:t.filter,dataViewId:e})}}(),function(){"use strict";naji.layer.njMapWFSVectorLayer=function(a){var n=this,i=null;return this.id=null,this.style=null,this.srsName=null,this.declutter=null,this.url=null,function(){var e=a||{};e.layerType="WFS_Vector",e.useGetFeature=!1,i=naji.layer.njMapLayerDefault.call(n,e),n.id=void 0!==e.id?e.id:void 0,n.style=void 0!==e.style?e.style:void 0,n.srsName=void 0!==e.srsName?e.srsName:"EPSG:3857",n.declutter="boolean"!=typeof e.declutter||e.declutter;var t=n.serviceURL;n.useProxy&&(t=naji.njMapConfig.getProxy()+t),n.url=t+"?service=WFS&version=1.1.0&request=GetFeature&typename="+e.layerName+"&outputFormat=application/json&srsname="+e.srsName+"&bbox=",n.olLayer=new ol.layer.Vector({id:n.id,declutter:!1,style:n.style,source:new ol.source.Vector({format:new ol.format.GeoJSON,url:function(e){return n.url+e.join(",")+","+n.srsName},strategy:ol.loadingstrategy.bbox})})}(),naji.util.njMapUtil.objectMerge(i,{_this:n,clear:n.clear,srsName:n.srsName})},naji.layer.njMapWFSVectorLayer.prototype=Object.create(naji.layer.njMapLayerDefault.prototype),naji.layer.njMapWFSVectorLayer.prototype.constructor=naji.layer.njMapWFSVectorLayer,naji.layer.njMapWFSVectorLayer.prototype.clear=function(){(this._this||this).olLayer.getSource().clear()}}(),function(){"use strict";naji.layer.njMapWMSLayer=function(n){var i=this,o=null;return this.singleTile=null,this.ogcParams=null,this.wfsServiceURL=null,function(){var e=n||{};e.layerType="WMS",e.useGetFeature=!0,o=naji.layer.njMapLayerDefault.call(i,e),e.wfsServiceURL?i.wfsServiceURL=e.wfsServiceURL:i.wfsServiceURL=i.serviceURL.replace("/wms","/wfs"),i.singleTile=void 0!==e.singleTile&&e.singleTile,i.ogcParams=void 0!==e.ogcParams?e.ogcParams:{};var t=i.serviceURL;if(i.useProxy&&(-1===t.indexOf("?")?t+="??":t.indexOf("?")===t.length-1&&(t=t.replace("?","??")),t=naji.njMapConfig.getProxy()+t),i.singleTile){var a=new ol.source.ImageWMS({url:t,params:i.ogcParams});i.olLayer=new ol.layer.Image({opacity:e.opacity,source:a})}else{a=new ol.source.TileWMS({url:t,params:i.ogcParams});i.olLayer=new ol.layer.Tile({opacity:e.opacity,source:a})}}(),naji.util.njMapUtil.objectMerge(o,{_this:i,ogcParams:i.ogcParams,getWFSServiceURL:i.getWFSServiceURL})},naji.layer.njMapWMSLayer.prototype=Object.create(naji.layer.njMapLayerDefault.prototype),naji.layer.njMapWMSLayer.prototype.constructor=naji.layer.njMapWMSLayer,naji.layer.njMapWMSLayer.prototype.getWFSServiceURL=function(){return(this._this||this).wfsServiceURL}}(),function(){"use strict";naji.layer.njMapWMTSLayer=function(e){var t,a=this,n=null;return this.layer=null,this.style=null,this.version=null,this.matrixSet=null,this.originExtent=null,this.wmtsCapabilities=null,(t=e||{}).layerType="WMTS",t.useGetFeature=!1,n=naji.layer.njMapLayerDefault.call(a,t),a.version=void 0!==t.version?t.version:"1.0.0",a.layer=void 0!==t.layer?t.layer:"",a.style=void 0!==t.style?t.style:"",a.matrixSet=void 0!==t.matrixSet?t.matrixSet:"",a.originExtent=a._setOriginExtent(t.originExtent),a.wmtsCapabilities=a._setWmtsCapabilities(t.wmtsCapabilities),a._update(!1),a.olLayer=new ol.layer.Tile({opacity:t.opacity,source:null}),naji.util.njMapUtil.objectMerge(n,{_this:a,layer:a.layer,version:a.version,update:a._update,matrixSet:a.matrixSet,getOriginExtent:a.getOriginExtent,setOriginExtent:a._setOriginExtent,getWmtsCapabilities:a.getWmtsCapabilities,setWmtsCapabilities:a._setWmtsCapabilities})};var e=naji.layer.njMapWMTSLayer;e.prototype=Object.create(naji.layer.njMapLayerDefault.prototype),(e.prototype.constructor=e).prototype._setOriginExtent=function(e){var t=this._this||this;return e&&3<e.length?t.originExtent=e:t.originExtent=void 0,t.originExtent},e.prototype._setWmtsCapabilities=function(e){var t=this._this||this;return t.wmtsCapabilities=e||void 0,t.wmtsCapabilities},e.prototype._update=function(e){var t=this._this||this;if(t.olLayer&&e){var a=new ol.source.WMTS.optionsFromCapabilities(t.wmtsCapabilities.olJson,{layer:t.layer,style:t.style,matrixSet:t.matrixSet});if(t.useProxy)for(var n in a.urls)a.urls[n]=naji.njMapConfig.getProxy()+a.urls[n];t.olLayer.setSource(new ol.source.WMTS(a))}},e.prototype.getOriginExtent=function(){return(this._this||this).originExtent},e.prototype.getWmtsCapabilities=function(){return(this._this||this).wmtsCapabilities},e.prototype.setUseGetFeature=function(){(this._this||this).useGetFeature=!1}}(),function(){"use strict";naji.toc.njMapTocDefault=function(e){var t,a=this;return this.tocKey=null,this.tocTitle=null,this.njMap=null,this.njMapLayer=null,this.menuOpen=null,this.groupOpen=null,this.legendOpen=null,this.tocListDivId=null,this.tocDivId=null,this.tocAccorId=null,this.zTreeAttribute=null,t=e||{},a.njMap=void 0!==t.njMap?t.njMap:void 0,a.njMapLayer=void 0!==t.njMapLayer?t.njMapLayer:void 0,a.tocKey=void 0!==t.tocKey?t.tocKey:void 0,a.tocTitle=void 0!==t.tocTitle?t.tocTitle:void 0,a.tocListDivId=void 0!==t.tocListDivId?t.tocListDivId:void 0,a.menuOpen="boolean"!=typeof t.menuOpen||t.menuOpen,a.groupOpen="boolean"!=typeof t.groupOpen||t.groupOpen,a.legendOpen="boolean"!=typeof t.legendOpen||t.legendOpen,a.njMap?a.njMapLayer?a.tocListDivId||(a.tocListDivId=naji.util.njMapUtil.generateUUID().split("-")[0],_$("body").append(_$("<div/>",{id:a.tocListDivId,css:{display:"none"}}))):naji.njMapConfig.alert_Error("njMapLayer undefined"):naji.njMapConfig.alert_Error("njMap undefined"),{tocKey:a.tocKey,remove:a.remove,njMap:a.njMap,njMapLayer:a.njMapLayer,getTocDivId:a.getTocDivId,tocExpandAll:a.tocExpandAll,tocCheckAllNodes:a.tocCheckAllNodes}},naji.toc.njMapTocDefault.prototype.createTocDiv=function(e,t){var a,n,i=this._this||this,o=null,r=null;i.tocDivId="TOC_"+naji.util.njMapUtil.generateUUID().split("-")[0],i.tocAccorId="accor_"+naji.util.njMapUtil.generateUUID().split("-")[0],n="collapse_"+naji.util.njMapUtil.generateUUID().split("-")[0],a='<img class="tocIMG_'+e+'">',(o=_$("<div/>",{id:i.tocAccorId})).addClass("panel-group"),o.html('<div class="panel-group" ><div class="panel panel-default"><div class="panel-heading" onclick="javascript:_$(\'#collapseOne\').collapse(\'toggle\');"><h4 class="panel-title"><a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#accordion1" href="#collapseOne" aria-expanded="false">sampleTOC_1</a><i class="indicator glyphicon glyphicon-chevron-down pull-right"></i></h4></div><div id="collapseOne" class="panel-collapse collapse" aria-expanded="false" style="height: 0px;"><div class="panel-body" style="padding: 5px;"><div style="overflow: auto; width: 100%;" class="ztree" id="TOC_1"></div><div class="tocEventDIV"><div class="tocEventDIV sub"><a onclick="javascript:_$.fn.zTree.getZTreeObj(\''+i.tocDivId+"').checkAllNodes("+!0+');"><span class="glyphicon glyphicon-check"></span></a><a onclick="javascript:_$.fn.zTree.getZTreeObj(\''+i.tocDivId+"').checkAllNodes("+!1+');"><span class="glyphicon glyphicon-unchecked"></span></a><a onclick="javascript:_$.fn.zTree.getZTreeObj(\''+i.tocDivId+"').expandAll("+!0+');"><span class="glyphicon glyphicon-resize-full"></span></a><a onclick="javascript:_$.fn.zTree.getZTreeObj(\''+i.tocDivId+"').expandAll("+!1+');"><span class="glyphicon glyphicon-resize-small"></span></a></div></div></div></div></div></div>');"WMS"!==e&&"WebWMS"!==e||o.find(".panel-body").prepend('<table class="table" style="border: 1px solid #cecece; margin-bottom: 10px;"><tbody><tr><td>CRS</td><td id="CRS_TEXT"></td></tr><tr><td>BBOX</td><td id="BBOX_TEXT" style="word-break: break-all; white-space:pre-line;"></td></tr></tbody></table>'),(r=o.find(".panel-heading")).attr("onclick",r.attr("onclick").replace("collapseOne",n)),r.find(".accordion-toggle").attr("data-parent","#"+i.tocAccorId),r.find(".accordion-toggle").attr("href","#"+n),r.find(".accordion-toggle").text(" "+t),r.find(".accordion-toggle").prepend(_$(a)),o.find(".panel-collapse").attr("id",n).find(".ztree").attr("id",i.tocDivId),_$("#"+i.tocListDivId).prepend(o),i.menuOpen&&$("#"+n).collapse("show")},naji.toc.njMapTocDefault.prototype.zTreeAttribute_Legend=function(e){var t=new(this._this||this)._zTreeFuncs;return{view:{selectedMulti:!1,expandSpeed:"fast",addDiyDom:t.addDIYDom_Legend},check:{autoCheckTrigger:!0,enable:!0,chkboxType:{Y:"",N:""}},data:{simpleData:{enable:!0}},edit:{enable:!0,showRemoveBtn:!1,showRenameBtn:!1,drag:{autoExpandTrigger:!0,prev:t.dropPrev,inner:t.dropInner,next:t.dropNext}},callback:{onCheck:e.layerSetVisible,beforeDrop:e.layerOrderChange,beforeDrag:t.beforeDrag},async:{enable:!0}}},naji.toc.njMapTocDefault.prototype.tocExpandAll=function(e){var t=this._this||this;_$.fn.zTree.getZTreeObj(t.tocDivId).expandAll(e)},naji.toc.njMapTocDefault.prototype.tocCheckAllNodes=function(e){var t=this._this||this;_$.fn.zTree.getZTreeObj(t.tocDivId).checkAllNodes(e)},naji.toc.njMapTocDefault.prototype.getTocDivId=function(){return(this._this||this).tocDivId},naji.toc.njMapTocDefault.prototype.remove=function(){var e=this._this||this;_$.fn.zTree.destroy(e.tocDivId),_$("#"+e.tocAccorId).remove()},naji.toc.njMapTocDefault.prototype._zTreeFuncs=function(){var s=this;return s.curDragNodes=null,{dropPrev:function(e,t,a){var n=a.getParentNode();if(n&&!1===n.dropInner)return!1;for(var i=0,o=s.curDragNodes.length;i<o;i++){var r=s.curDragNodes[i].getParentNode();if(r&&r!==a.getParentNode()&&!1===r.childOuter)return!1}return!0},dropInner:function(e,t,a){if(a&&!1===a.dropInner)return!1;for(var n=0,i=s.curDragNodes.length;n<i;n++){if(!a&&!1===s.curDragNodes[n].dropRoot)return!1;if(s.curDragNodes[n].parentTId&&s.curDragNodes[n].getParentNode()!==a&&!1===s.curDragNodes[n].getParentNode().childOuter)return!1}return!0},dropNext:function(e,t,a){var n=a.getParentNode();if(n&&!1===n.dropInner)return!1;for(var i=0,o=s.curDragNodes.length;i<o;i++){var r=s.curDragNodes[i].getParentNode();if(r&&r!==a.getParentNode()&&!1===r.childOuter)return!1}return!0},beforeDrag:function(e,t){for(var a=0,n=t.length;a<n;a++){if(!1===t[a].drag)return s.curDragNodes=null,!1;if(t[a].parentTId&&!1===t[a].getParentNode().childDrag)return s.curDragNodes=null,!1}return s.curDragNodes=t,!0},addDIYDom_Legend:function(e,t){if(!t.parentNode||2===t.parentNode.id){var a=_$("#"+t.tId+"_a");t.isLegend&&t.LegendURL&&(a.empty(),a.css("height","auto"),a.append("<img src='"+t.LegendURL+"' title='"+t.name+"'>"))}}}}}(),function(){"use strict";naji.toc.njMapWCSToc=function(e){var t,i=this,a=null;function n(e,t,a){var n;n=a.isGroupLayer?!(!a.checked||!a.children[0].checked):!(!a.checked||!a.getParentNode().checked),i.njMapLayer.setTocVisible(n)}return this.coverage=null,t=e||{},a=naji.toc.njMapTocDefault.call(i,t),i.coverage=void 0!==t.coverage?t.coverage:"",i.createTocDiv("WCS",i.tocTitle),i.zTreeAttribute=i.zTreeAttribute_Legend(n),i._createWCSToc(),naji.util.njMapUtil.objectMerge(a,{_this:i})},naji.toc.njMapWCSToc.prototype=Object.create(naji.toc.njMapTocDefault.prototype),naji.toc.njMapWCSToc.prototype.constructor=naji.toc.njMapWCSToc,naji.toc.njMapWCSToc.prototype._createWCSToc=function(){var e,t=this._this||this,a=t._getWCSNodeTozTree(t._getWCSLayerData());return e=(t.isWebMap,a),_$.fn.zTree.init(_$("#"+t.tocDivId),t.zTreeAttribute,e),e},naji.toc.njMapWCSToc.prototype._getWCSNodeTozTree=function(e){var t={id:e.Coverage,name:e.Coverage,children:[],open:!0,drop:!1,inner:!1,checked:!0,Coverage:e.Coverage,isGroupLayer:!1,Extent:null,chkDisabled:!1};return{id:"root",name:e.Coverage,children:[t],open:!0,drop:!1,inner:!1,checked:!0,isGroupLayer:!0,Extent:null,chkDisabled:!1}},naji.toc.njMapWCSToc.prototype._getWCSLayerData=function(){var e=this._this||this;return{KEY:e.tocKey,Coverage:e.coverage}}}(),function(){"use strict";naji.toc.njMapWebWMSToc=function(a){var r=this,n=null;function i(e,t,a){r._olWMSLayerRefresh()}function o(e,t,a,n){var i=!1;if(!t[0])return!1;var o=t[0].tId.split("_")[1];return e.split("_")[1]===o&&(a.isGroupLayer?(i=!!a.drop,"ROOT"===a.LayerName&&"inner"!==n&&(i=!1)):i="inner"!==n,r._layerOrderChangeListener(i))}return this.symbolSize=null,this.capabilities=null,this.visibleState=null,this.selectLayers=null,this.key_zoomEnd=null,this.showLayerNames=null,this.key_changeResolution=null,function(){var e=a||{};n=naji.toc.njMapTocDefault.call(r,e);var t=e.symbolSize;if(Array.isArray(t)?r.symbolSize=t:r.symbolSize=[20,20],r.loadData=void 0!==e.loadData?e.loadData:void 0,r.visibleState=void 0!==e.visibleState?e.visibleState:{},r.selectLayers=void 0!==e.selectLayers?e.selectLayers:[],r.capabilities=void 0!==e.capabilities?e.capabilities:void 0,!r.capabilities)return naji.njMapConfig.alert_Error("capabilities undefined");r.createTocDiv("WebWMS",r.tocTitle),r.zTreeAttribute=r.zTreeAttribute_Legend({layerSetVisible:i,layerOrderChange:o}),r._createWMSToc(!1),r._createReloadBtn(),r._activeChangeResolution(),_$("#"+r.tocAccorId).find("#CRS_TEXT").text(r.capabilities.serviceMetaData.crs),_$("#"+r.tocAccorId).find("#BBOX_TEXT").text(r.capabilities.serviceMetaData.maxExtent.toString()),r.njMap.getMap().getView().dispatchEvent({type:"change:resolution"})}(),naji.util.njMapUtil.objectMerge(n,{_this:r,reLoad:r.reLoad,getSaveData:r.getSaveData,getShowLayerNames:r.getShowLayerNames})},naji.toc.njMapWebWMSToc.prototype=Object.create(naji.toc.njMapTocDefault.prototype),naji.toc.njMapWebWMSToc.prototype.constructor=naji.toc.njMapWebWMSToc,naji.toc.njMapWebWMSToc.prototype._layerOrderChangeListener=function(e){var t=this._this||this;return e&&(t._olWMSLayerRefresh(),setTimeout(function(){t._olWMSLayerRefresh()},100)),e},naji.toc.njMapWebWMSToc.prototype._createWMSToc=function(e){var t=this._this||this,a=t._getWMSNodeTozTree(t._getWMSLayerData().Layers);if(!e&&t.loadData){var n=t._getLayerDataObject(a,{});a=t._setLoadData(n,_$.extend(!0,{},t.loadData))}return void 0!==t.selectLayers&&(a=t._getSelectLayers(a,t.selectLayers)),_$.fn.zTree.init(_$("#"+t.tocDivId),t.zTreeAttribute,a),a},naji.toc.njMapWebWMSToc.prototype._getSelectLayers=function(e,t){var a,n=[];n=(this._this||this)._getNoneGroupLayers(e,n);var i=[];for(var o in t){var r=t[o];for(var s in n){n[s].LayerName===r&&(i.push(n.slice(s,s+1)[0]),n.splice(s,1))}}return a=i,e.children=a,e},naji.toc.njMapWebWMSToc.prototype._getWMSNodeTozTree=function(e){for(var t=this._this||this,a={id:null,name:null,children:[],drop:!0,drag:!0,open:!0,checked:!0,dropInner:!0,chkDisabled:!1,Extent:null,LayerName:null,LegendURL:null,MinScale:0,MaxScale:1/0,scaleVisible:!0,isGroupLayer:!1},n=0;n<e.length;n++){a.name=e[n].Title,a.id=e[n].LayerName,a.LayerName=e[n].LayerName,"boolean"==typeof t.visibleState[a.LayerName]&&(a.checked=t.visibleState[a.LayerName]),a.LegendURL=e[n].LegendURL;var i=e[n].MinScale;void 0!==i&&(a.MinScale=i);var o=e[n].MaxScale;void 0!==o&&(a.MaxScale=o),a.Extent=e[n].Extent,a.isGroupLayer=e[n].isGroupLayer,a.isGroupLayer&&(a.open=!!t.groupOpen),"ROOT"===a.id&&(a.open=!0,a.drag=!1);var r=e[n].ChildLayers;if(0<r.length)for(var s=0;s<r.length;s++)a.children.push(t._getWMSNodeTozTree([r[s]]));else a.drop=!1,a.dropInner=!1,a.iconSkin="pIconFeatureLayer",t.legendOpen||(a.open=!1),a.children.push({drag:!1,drop:!1,open:!1,nocheck:!0,isLegend:!0,dropInner:!1,LayerName:"leg_"+a.LayerName,LegendURL:a.LegendURL})}return a},naji.toc.njMapWebWMSToc.prototype._getWMSLayerData=function(){var e=this._this||this,t={CRS:e.capabilities.serviceMetaData.crs,MaxExtent:e.capabilities.serviceMetaData.maxExtent,Layers:[]},a=e.capabilities.xmlJson.WMS_Capabilities.Capability.Layer,n=e._getWMSCapabilitieLayerData([a]);return t.Layers.push(n),t},naji.toc.njMapWebWMSToc.prototype._getWMSCapabilitieLayerData=function(e){var t=this._this||this,a={LayerName:null,Title:null,Extent:null,MinScale:null,MaxScale:null,LegendURL:null,isGroupLayer:!1,isVisible:!0,ChildLayers:[]};for(var n in e){var i=e[n].Title;void 0!==i&&(i=i["#text"]);var o=e[n].Name;void 0!==o&&(o=o["#text"]);var r=e[n].BoundingBox;void 0!==r&&(Array.isArray(r)&&(r=r[0]),r=r["@attributes"],r=[parseFloat(r.minx),parseFloat(r.miny),parseFloat(r.maxx),parseFloat(r.maxy)]);var s=e[n].MinScaleDenominator;void 0!==s&&(s=parseFloat(s["#text"]));var l=e[n].MaxScaleDenominator;void 0!==l&&(l=parseFloat(l["#text"]));var p,c=e[n].Style;void 0!==c&&(Array.isArray(c)&&(c=c[0]),void 0!==c.LegendURL&&(p=c.LegendURL.OnlineResource["@attributes"]["xlink:href"],p+="&SYMBOL_WIDTH="+t.symbolSize[0],p+="&SYMBOL_HEIGHT="+t.symbolSize[1]));var u=e[n].Layer;if(Array.isArray(u)||void 0===u||(u=[u]),Array.isArray(u)){a.isGroupLayer=!0;for(var y=u.length;0<=--y;)a.ChildLayers.push(t._getWMSCapabilitieLayerData([u[y]]))}a.LayerName=o,a.Title=i,a.Extent=r,a.MinScale=s,a.MaxScale=l,a.LegendURL=p}return a},naji.toc.njMapWebWMSToc.prototype._getNoneGroupLayers=function(e,t){var a=this._this||this;for(var n in e=[e]){var i=e[n];if(i.isGroupLayer){var o=i.children;for(var r in o){var s=o[r];a._getNoneGroupLayers(s,t)}}else t.push(i)}return t},naji.toc.njMapWebWMSToc.prototype._activeChangeResolution=function(e){var t=this._this||this,a=t.njMap.getMap().getView();function n(e){t.key_changeResolution=e.on("change:resolution",function(){var e;e=t.njMap.calculateScale({extent:t.njMap.getMap().getView().calculateExtent(t.njMap.getMap().getSize()),originCRS:t.capabilities.serviceMetaData.crs}),e=Math.ceil(e),function e(t,a){t.isLegend||(t.MinScale<=a&&a<t.MaxScale?(t.scaleVisible=!0,t.chkDisabled=!1):(t.scaleVisible=!1,t.chkDisabled=!0));var n=t.children;if(Array.isArray(n))for(var i=0;i<n.length;i++){var o=n[i];e(o,a)}}(_$.fn.zTree.getZTreeObj(t.tocDivId).getNodes()[0],e),_$.fn.zTree.getZTreeObj(t.tocDivId).refresh(),t._olWMSLayerRefresh()})}t.njMap.getMap().on("change:view",function(e){ol.Observable.unByKey(t.key_changeResolution),n(e.target.getView())}),n(a)},naji.toc.njMapWebWMSToc.prototype.setZtreeLayerData=function(){var e=this._this||this,t=[],a=_$.fn.zTree.getZTreeObj(e.tocDivId).getNodes()[0];return t=void 0===(t=e._getZtreeLayerData(a,t,"show"))?"":t.toString(),e.showLayerNames=t},naji.toc.njMapWebWMSToc.prototype._getZtreeLayerData=function(e,t,a){var n=this._this||this,i=[e];for(var o in i){var r=i[o];if("show"===a&&!1===r.checked||"show"===a&&!0===r.chkDisabled)return;if(r.isGroupLayer)for(var s=r.children,l=s.length;0<=--l;){var p=s[l];n._getZtreeLayerData(p,t,a)}else t.push(r.LayerName)}return t},naji.toc.njMapWebWMSToc.prototype._olWMSLayerRefresh=function(){var e=this._this||this,t=e.njMapLayer.getOlLayer();t.getSource().getParams().LAYERS=e.setZtreeLayerData(),t.getSource().getParams().refTime=(new Date).getMilliseconds(),t.getSource().updateParams(t.getSource().getParams()),""===t.getSource().getParams().LAYERS?e.njMapLayer.setTocVisible(!1):e.njMapLayer.getVisible()||e.njMapLayer.setTocVisible(!0)},naji.toc.njMapWebWMSToc.prototype._getLayerDataObject=function(e,t){var a=this._this||this,n=e.children;if(Array.isArray(n))for(var i=0;i<n.length;i++){var o=n[i];t[e.LayerName]=e,a._getLayerDataObject(o,t)}else t[e.LayerName]=e;return t},naji.toc.njMapWebWMSToc.prototype.getSaveData=function(){var e=this._this||this,t=$.fn.zTree.getZTreeObj(e.tocDivId).getNodes()[0];return e._getSaveData(_$.extend(!0,{},t))},naji.toc.njMapWebWMSToc.prototype._getSaveData=function(e){var t=this._this||this,a=["open","checked","children","LayerName"];for(var n in e)e.hasOwnProperty(n)&&-1===_$.inArray(n,a)&&delete e[n];var i=e.children;if(Array.isArray(i))for(var o=0;o<i.length;o++){var r=i[o];t._getSaveData(r)}return e},naji.toc.njMapWebWMSToc.prototype._setLoadData=function(e,t){var a=this._this||this,n=["open","checked","children"],i=e[t.LayerName];for(var o in i)i.hasOwnProperty(o)&&-1===$.inArray(o,n)&&(t[o]=i[o]);var r=t.children;if(Array.isArray(r))for(var s=0;s<r.length;s++){var l=r[s];a._setLoadData(e,l)}return t},naji.toc.njMapWebWMSToc.prototype._createReloadBtn=function(){var e=this._this||this,t=$("<a/>",{click:function(){e.reLoad()}}).append($("<span/>",{class:"glyphicon glyphicon-refresh",title:"새로고침"}));_$("#"+e.tocDivId).parent().find(".tocEventDIV.sub").prepend(t)},naji.toc.njMapWebWMSToc.prototype.getShowLayerNames=function(e){var t=(this._this||this).showLayerNames.split(",");return e&&(t=t.reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[])),t},naji.toc.njMapWebWMSToc.prototype.reLoad=function(){var e=this._this||this;$.fn.zTree.destroy(e.tocDivId),e._createWMSToc(!0),e.njMap.getMap().getView().dispatchEvent({type:"change:resolution"})},naji.toc.njMapWebWMSToc.prototype.remove=function(){var e=this._this||this;naji.toc.njMapTocDefault.prototype.remove.call(this),ol.Observable.unByKey(e.key_changeResolution)}}(),function(){"use strict";naji.toc.njMapWFSToc=function(e){var t,i=this,a=null;function n(e,t,a){var n;n=a.isGroupLayer?!(!a.checked||!a.children[0].checked):!(!a.checked||!a.getParentNode().checked),i.njMapLayer.setTocVisible(n)}return this.layerTitle=null,this.layerName=null,t=e||{},a=naji.toc.njMapTocDefault.call(i,t),i.layerTitle=void 0!==t.layerTitle?t.layerTitle:"",i.layerName=void 0!==t.layerName?t.layerName:"",i.createTocDiv("WFS",i.tocTitle),i.zTreeAttribute=i.zTreeAttribute_Legend({layerSetVisible:n}),i._createWFSToc(),naji.util.njMapUtil.objectMerge(a,{_this:i})},naji.toc.njMapWFSToc.prototype=Object.create(naji.toc.njMapTocDefault.prototype),naji.toc.njMapWFSToc.prototype.constructor=naji.toc.njMapWFSToc,naji.toc.njMapWFSToc.prototype._createWFSToc=function(){var e,t=this._this||this,a=t._getWFSNodeTozTree(t._getWFSLayerData());return e=(t.isWebMap,a),_$.fn.zTree.init(_$("#"+t.tocDivId),t.zTreeAttribute,e),e},naji.toc.njMapWFSToc.prototype._getWFSNodeTozTree=function(e){var t={id:e.LayerName,name:e.LayerTitle,open:!0,drag:!1,drop:!1,checked:!0,LayerName:e.LayerName,isGroupLayer:!1,Extent:null,chkDisabled:!1};return{id:"ROOT",name:e.LayerTitle,children:[t],open:!0,drag:!1,drop:!1,checked:!0,LayerName:e.LayerName,isGroupLayer:!0,Extent:null,chkDisabled:!1,iconSkin:"pIconFeatureLayer"}},naji.toc.njMapWFSToc.prototype._getWFSLayerData=function(){var e=this._this||this;return{KEY:e.tocKey,LayerName:e.layerName,LayerTitle:e.layerTitle}}}(),function(){"use strict";naji.toc.njMapWMSToc=function(n){var r=this,i=null;function o(e,t,a){r._olWMSLayerRefresh(!1)}function s(e,t,a,n){var i=!1;if(!t[0])return!1;var o=t[0].tId.split("_")[1];return e.split("_")[1]===o&&(a.isGroupLayer?(i=!!a.drop,"ROOT"===a.LayerName&&"inner"!==n&&(i=!1)):i="inner"!==n,r._layerOrderChangeListener(i))}return this.loadData=null,this.symbolSize=null,this.capabilities=null,this.visibleState=null,this.key_zoomEnd=null,this.showLayerNames=null,this.key_changeResolution=null,function(e){var t=n||{};i=naji.toc.njMapTocDefault.call(r,t);var a=t.symbolSize;if(Array.isArray(a)?r.symbolSize=a:r.symbolSize=[20,20],r.loadData=void 0!==t.loadData?t.loadData:void 0,r.visibleState=void 0!==t.visibleState?t.visibleState:{},r.capabilities=void 0!==t.capabilities?t.capabilities:void 0,!r.capabilities)return naji.njMapConfig.alert_Error("capabilities undefined");r.createTocDiv("WMS",r.tocTitle),r.zTreeAttribute=r.zTreeAttribute_Legend({layerSetVisible:o,layerOrderChange:s}),r._createWMSToc(!1),r._createReloadBtn(),r._activeChangeResolution(),_$("#"+r.tocAccorId).find("#CRS_TEXT").text(r.capabilities.serviceMetaData.crs),_$("#"+r.tocAccorId).find("#BBOX_TEXT").text(r.capabilities.serviceMetaData.maxExtent.toString()),r.njMap.getMap().getView().dispatchEvent({type:"change:resolution"})}(),naji.util.njMapUtil.objectMerge(i,{_this:r,reLoad:r.reLoad,getSaveData:r.getSaveData,getShowLayerNames:r.getShowLayerNames})},naji.toc.njMapWMSToc.prototype=Object.create(naji.toc.njMapTocDefault.prototype),naji.toc.njMapWMSToc.prototype.constructor=naji.toc.njMapWMSToc,naji.toc.njMapWMSToc.prototype._layerOrderChangeListener=function(e){var t=this._this||this;return e&&(t._olWMSLayerRefresh(!0),setTimeout(function(){t._olWMSLayerRefresh(!0)},100)),e},naji.toc.njMapWMSToc.prototype._createWMSToc=function(e){var t=this._this||this,a=t._getWMSNodeTozTree(t._getWMSLayerData().Layers);if(!e&&t.loadData){var n=t._getLayerDataObject(a,{});a=t._setLoadData(n,_$.extend(!0,{},t.loadData))}return _$.fn.zTree.init(_$("#"+t.tocDivId),t.zTreeAttribute,a),a},naji.toc.njMapWMSToc.prototype._getWMSNodeTozTree=function(e){for(var t=this._this||this,a={id:null,name:null,children:[],drop:!0,drag:!0,open:!0,checked:!0,dropInner:!0,chkDisabled:!1,Extent:null,LayerName:null,LegendURL:null,MinScale:0,MaxScale:1/0,scaleVisible:!0,isGroupLayer:!1},n=0;n<e.length;n++){a.name=e[n].Title,a.id=e[n].LayerName,a.LayerName=e[n].LayerName,"boolean"==typeof t.visibleState[a.LayerName]&&(a.checked=t.visibleState[a.LayerName]),a.LegendURL=e[n].LegendURL;var i=e[n].MinScale;void 0!==i&&(a.MinScale=i);var o=e[n].MaxScale;void 0!==o&&(a.MaxScale=o),a.Extent=e[n].Extent,a.isGroupLayer=e[n].isGroupLayer,a.isGroupLayer&&(a.open=!!t.groupOpen),"ROOT"===a.id&&(a.open=!0,a.drag=!1);var r=e[n].ChildLayers;if(0<r.length)for(var s=0;s<r.length;s++)a.children.push(t._getWMSNodeTozTree([r[s]]));else a.drop=!1,a.dropInner=!1,a.iconSkin="pIconFeatureLayer",t.legendOpen||(a.open=!1),a.LayerName&&a.LegendURL&&a.children.push({drag:!1,drop:!1,open:!1,nocheck:!0,isLegend:!0,dropInner:!1,name:a.LayerName,LayerName:"leg_"+a.LayerName,LegendURL:a.LegendURL})}return a},naji.toc.njMapWMSToc.prototype._getWMSLayerData=function(){var e=this._this||this,t={CRS:e.capabilities.serviceMetaData.crs,MaxExtent:e.capabilities.serviceMetaData.maxExtent,Layers:[]},a=e.capabilities.xmlJson.WMS_Capabilities.Capability.Layer,n=e._getWMSCapabilitieLayerData([a]);return t.Layers.push(n),t},naji.toc.njMapWMSToc.prototype._getWMSCapabilitieLayerData=function(e){var t=this._this||this,a={LayerName:null,Title:null,Extent:null,MinScale:null,MaxScale:null,LegendURL:null,isGroupLayer:!1,isVisible:!0,ChildLayers:[]};for(var n in e){var i=e[n].Title;void 0!==i&&(i=i["#text"]);var o=e[n].Name;void 0!==o&&(o=o["#text"]);var r=e[n].BoundingBox;void 0!==r&&(Array.isArray(r)&&(r=r[0]),r=r["@attributes"],r=[parseFloat(r.minx),parseFloat(r.miny),parseFloat(r.maxx),parseFloat(r.maxy)]);var s=e[n].MinScaleDenominator;void 0!==s&&(s=parseFloat(s["#text"]));var l=e[n].MaxScaleDenominator;void 0!==l&&(l=parseFloat(l["#text"]));var p,c=e[n].Style;void 0!==c&&(Array.isArray(c)&&(c=c[0]),void 0!==c.LegendURL&&(p=c.LegendURL.OnlineResource["@attributes"]["xlink:href"],p+="&SYMBOL_WIDTH="+t.symbolSize[0],p+="&SYMBOL_HEIGHT="+t.symbolSize[1]));var u=e[n].Layer;if(Array.isArray(u)||void 0===u||(u=[u]),Array.isArray(u)){a.isGroupLayer=!0;for(var y=u.length;0<=--y;)a.ChildLayers.push(t._getWMSCapabilitieLayerData([u[y]]))}a.LayerName=o,a.Title=i,a.Extent=r,a.MinScale=s,a.MaxScale=l,a.LegendURL=p}return a},naji.toc.njMapWMSToc.prototype._getNoneGroupLayers=function(e,t){var a=this._this||this;for(var n in e=[e]){var i=e[n];if(i.isGroupLayer){var o=i.children;for(var r in o){var s=o[r];a._getNoneGroupLayers(s,t)}}else t.push(i)}return t},naji.toc.njMapWMSToc.prototype._activeChangeResolution=function(e){var t=this._this||this,a=t.njMap.getMap().getView();function n(e){t.key_changeResolution=e.on("change:resolution",function(){var e;e=t.njMap.calculateScale({extent:t.njMap.getMap().getView().calculateExtent(t.njMap.getMap().getSize()),originCRS:t.capabilities.serviceMetaData.crs}),e=Math.ceil(e),function e(t,a){t.isLegend||(t.MinScale<=a&&a<t.MaxScale?(t.scaleVisible=!0,t.chkDisabled=!1):(t.scaleVisible=!1,t.chkDisabled=!0));var n=t.children;if(Array.isArray(n))for(var i=0;i<n.length;i++){var o=n[i];e(o,a)}}(_$.fn.zTree.getZTreeObj(t.tocDivId).getNodes()[0],e),_$.fn.zTree.getZTreeObj(t.tocDivId).refresh(),t._olWMSLayerRefresh(!1)})}t.njMap.getMap().on("change:view",function(e){ol.Observable.unByKey(t.key_changeResolution),n(e.target.getView())}),n(a)},naji.toc.njMapWMSToc.prototype.setZtreeLayerData=function(){var e=this._this||this,t=[],a=_$.fn.zTree.getZTreeObj(e.tocDivId).getNodes()[0];return t=void 0===(t=e._getZtreeLayerData(a,t,"show"))?"":t.toString(),e.showLayerNames=t},naji.toc.njMapWMSToc.prototype._getZtreeLayerData=function(e,t,a){var n=this._this||this,i=[e];for(var o in i){var r=i[o];if("show"===a&&!1===r.checked||"show"===a&&!0===r.chkDisabled)return;if(r.isGroupLayer)for(var s=r.children,l=s.length;0<=--l;){var p=s[l];n._getZtreeLayerData(p,t,a)}else t.push(r.LayerName)}return t},naji.toc.njMapWMSToc.prototype._olWMSLayerRefresh=function(e){var t=this._this||this,a=t.njMapLayer.getOlLayer();a.getSource().getParams().LAYERS=t.setZtreeLayerData(),e&&(a.getSource().getParams().refTime=(new Date).getMilliseconds()),a.getSource().updateParams(a.getSource().getParams()),""===a.getSource().getParams().LAYERS?t.njMapLayer.setTocVisible(!1):t.njMapLayer.getVisible()||t.njMapLayer.setTocVisible(!0)},naji.toc.njMapWMSToc.prototype._getLayerDataObject=function(e,t){var a=this._this||this,n=e.children;if(Array.isArray(n))for(var i=0;i<n.length;i++){var o=n[i];t[e.LayerName]=e,a._getLayerDataObject(o,t)}else t[e.LayerName]=e;return t},naji.toc.njMapWMSToc.prototype.getSaveData=function(){var e=this._this||this,t=$.fn.zTree.getZTreeObj(e.tocDivId).getNodes()[0];return e._getSaveData(_$.extend(!0,{},t))},naji.toc.njMapWMSToc.prototype._getSaveData=function(e){var t=this._this||this,a=["open","checked","children","LayerName"];for(var n in e)e.hasOwnProperty(n)&&-1===_$.inArray(n,a)&&delete e[n];var i=e.children;if(Array.isArray(i))for(var o=0;o<i.length;o++){var r=i[o];t._getSaveData(r)}return e},naji.toc.njMapWMSToc.prototype._setLoadData=function(e,t){var a=this._this||this,n=["open","checked","children"],i=e[t.LayerName];for(var o in i)i.hasOwnProperty(o)&&-1===$.inArray(o,n)&&(t[o]=i[o]);var r=t.children;if(Array.isArray(r))for(var s=0;s<r.length;s++){var l=r[s];a._setLoadData(e,l)}return t},naji.toc.njMapWMSToc.prototype._createReloadBtn=function(){var e=this._this||this,t=$("<a/>",{click:function(){e.reLoad()}}).append($("<span/>",{class:"glyphicon glyphicon-refresh",title:"새로고침"}));_$("#"+e.tocDivId).parent().find(".tocEventDIV.sub").prepend(t)},naji.toc.njMapWMSToc.prototype.getShowLayerNames=function(e){var t=(this._this||this).showLayerNames.split(",");return e&&(t=t.reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[])),t},naji.toc.njMapWMSToc.prototype.reLoad=function(){var e=this._this||this;$.fn.zTree.destroy(e.tocDivId),e._createWMSToc(!0),e.njMap.getMap().getView().dispatchEvent({type:"change:resolution"})},naji.toc.njMapWMSToc.prototype.remove=function(){var e=this._this||this;naji.toc.njMapTocDefault.prototype.remove.call(this),ol.Observable.unByKey(e.key_changeResolution)}}(),function(){"use strict";naji.toc.njMapWMTSToc=function(e){var t,i=this,a=null;function n(e,t,a){var n;n=a.isGroupLayer?!(!a.checked||!a.children[0].checked):!(!a.checked||!a.getParentNode().checked),i.njMapLayer.setTocVisible(n)}return this.matrixSet=null,this.layerName=null,this.legendURL=null,t=e||{},a=naji.toc.njMapTocDefault.call(i,t),i.layerName=void 0!==t.layerName?t.layerName:"",i.matrixSet=void 0!==t.matrixSet?t.matrixSet:"",i.legendURL=void 0!==t.legendURL?t.legendURL:"",i.createTocDiv("WMTS",i.tocTitle),i.zTreeAttribute=i.zTreeAttribute_Legend({layerSetVisible:n}),i._createWMTSToc(),naji.util.njMapUtil.objectMerge(a,{_this:i})},naji.toc.njMapWMTSToc.prototype=Object.create(naji.toc.njMapTocDefault.prototype),naji.toc.njMapWMTSToc.prototype.constructor=naji.toc.njMapWMTSToc,naji.toc.njMapWMTSToc.prototype._createWMTSToc=function(){var e,t=this._this||this,a=t._getWMTSNodeTozTree(t._getWMTSLayerData());return e=(t.isWebMap,a),_$.fn.zTree.init(_$("#"+t.tocDivId),t.zTreeAttribute,e),e},naji.toc.njMapWMTSToc.prototype._getWMTSNodeTozTree=function(e){var t={id:e.LayerName,name:e.LayerName,open:!0,drag:!1,drop:!1,checked:!0,LayerName:e.LayerName,MatrixSet:e.MatrixSet,isGroupLayer:!1,Extent:null,chkDisabled:!1,LegendURL:e.LegendURL};return{id:"ROOT",name:e.LayerName,children:[t],open:!0,drag:!1,drop:!1,checked:!0,isGroupLayer:!0,LegendURL:null,Extent:null,chkDisabled:!1,iconSkin:"pIconFeatureLayer"}},naji.toc.njMapWMTSToc.prototype._getWMTSLayerData=function(){var e=this._this||this;return{KEY:e.tocKey,LayerName:e.layerName,LayerTitle:e.layerName,MatrixSet:e.matrixSet,LegendURL:e.legendURL}}}(),function(){"use strict";naji.baseMap.njMapBaseMapDefault=function(e){var t,a=this;return this.target=null,this.apiMap=null,this.isWorld=null,this.isFactor=null,this.baseCode=null,this.mapTypes=null,this.projection=null,this.maxExtent=null,this.isAvailable=null,this.resolutions=null,t=e||{},a.isWorld=void 0===t.isWorld||t.isWorld,a.isFactor=void 0===t.isFactor||t.isFactor,a.apiMap=void 0!==t.apiMap?t.apiMap:void 0,a.mapTypes=void 0!==t.mapTypes?t.mapTypes:{},a.projection=void 0!==t.projection?t.projection:"EPSG:3857",a.baseCode=void 0!==t.baseCode?t.baseCode:"custom_code",a.resolutions=void 0!==t.resolutions?t.resolutions:void 0,a.maxExtent=void 0!==t.maxExtent?t.maxExtent:ol.proj.get("EPSG:3857").getExtent(),{isWorlds:a.isWorlds,isFactors:a.isFactors,getApiMap:a.getApiMap,updateSize:a.updateSize,setMapType:a.setMapType,isAvailables:a.isAvailables,syncMapZoom:a.syncMapZoom,syncMapCenter:a.syncMapCenter,syncMapRotation:a.syncMapRotation,getUsableKeys:a.getUsableKeys,createBaseMap:a.createBaseMap,getTypeProperties:a.getTypeProperties}},naji.baseMap.njMapBaseMapDefault.prototype.createBaseMap=function(e,t){},naji.baseMap.njMapBaseMapDefault.prototype.syncMapZoom=function(e){},naji.baseMap.njMapBaseMapDefault.prototype.syncMapCenter=function(e){},naji.baseMap.njMapBaseMapDefault.prototype.syncMapRotation=function(e){},naji.baseMap.njMapBaseMapDefault.prototype.setMapType=function(e){},naji.baseMap.njMapBaseMapDefault.prototype.updateSize=function(){},naji.baseMap.njMapBaseMapDefault.prototype.getTypeProperties=function(e){var t=this._this||this;return{minZoom:t.mapTypes[e].minZoom,maxZoom:t.mapTypes[e].maxZoom,baseCode:t.baseCode,projection:t.projection,maxExtent:t.maxExtent,resolutions:t.resolutions,id:t.mapTypes[e].id}},naji.baseMap.njMapBaseMapDefault.prototype.checkIsAvailable=function(e){var t=this._this||this;try{new Function(e.toString())(),t.isAvailable=!0}catch(e){t.isAvailable=!1}},naji.baseMap.njMapBaseMapDefault.prototype.getUsableKeys=function(){var e=this._this||this,t=[],a=e.mapTypes;for(var n in a)-1<n.indexOf("custom_")?t.push(e.baseCode):t.push(e.baseCode+"_"+n);return t},naji.baseMap.njMapBaseMapDefault.prototype.getSyncData=function(e){this._this;var t=e.target;return t instanceof ol.Map&&(t=t.getView()),{view:t,center:t.getCenter(),rotation:t.getRotation(),projection:t.getProjection(),resolution:t.getResolution(),zoom:Math.round(t.getZoom())}},naji.baseMap.njMapBaseMapDefault.prototype.isAvailables=function(){return(this._this||this).isAvailable},naji.baseMap.njMapBaseMapDefault.prototype.isWorlds=function(){return(this._this||this).isWorld},naji.baseMap.njMapBaseMapDefault.prototype.isFactors=function(){return(this._this||this).isFactor},naji.baseMap.njMapBaseMapDefault.prototype.getApiMap=function(){return(this._this||this).apiMap}}(),function(){"use strict";naji.baseMap.njMapBaseMap=function(t){var a=this;return this.target=null,this.njMap=null,this.useElementMargin=null,this.UUID=null,this.nowMapView=null,this.baseMapList=null,this.nowBaseMapKey=null,this.key_changeCenter=null,this.key_elementResize=null,this.key_changeRotation=null,this.key_changeResolution=null,function(){var e=t||{};if(a.UUID=naji.util.njMapUtil.generateUUID().split("-")[0],a.target=void 0!==e.target?e.target:void 0,a.njMap=void 0!==e.njMap?e.njMap:void 0,a.nowBaseMapKey=void 0!==e.baseMapKey?e.baseMapKey:"osm_normal",a.useElementMargin=void 0===e.useElementMargin||e.useElementMargin,!a.njMap)return naji.njMapConfig.alert_Error("njMap undefined");a.addBaseMapType("osm",new naji.baseMap.njMapBaseMapOSM),a.addBaseMapType("bing",new naji.baseMap.njMapBaseMapBing),a.addBaseMapType("daum",new naji.baseMap.njMapBaseMapDaum),a.addBaseMapType("naver",new naji.baseMap.njMapBaseMapNaver),a.addBaseMapType("google",new naji.baseMap.njMapBaseMapGoogle),a.addBaseMapType("vWorld",new naji.baseMap.njMapBaseMapVWorld),a.addBaseMapType("stamen",new naji.baseMap.njMapBaseMapStamen),a.addBaseMapType("baroEmap",new naji.baseMap.njMapBaseMapBaroEmap),a._callBaseMapType(a.nowBaseMapKey),a.setVisible(!0)}(),{_this:a,remove:a.remove,setVisible:a.setVisible,getVisible:a.getVisible,getApiMap:a.getApiMap,setOpacity:a.setOpacity,getOpacity:a.getOpacity,visibleToggle:a.visibleToggle,changeBaseMap:a.changeBaseMap,addBaseMapType:a.addBaseMapType,getSelectedBaseMap:a.getSelectedBaseMap,getUsableBaseMapList:a.getUsableBaseMapList}},naji.baseMap.njMapBaseMap.prototype._callBaseMapType=function(e){var t=this._this||this;if(!t._isBaseMapUsable(e))return naji.njMapConfig.alert_Error(e+" undefined"),!1;$("#"+t.target).prepend($("<div>",{id:t.UUID,style:"width: 100%; height: 100%; position: relative; overflow: hidden"})),naji.util.njMapUtil.setCssTextStyle($("#"+t.target)[0],"overflow","hidden !important");var a=e.split("_")[0],n=e.split("_")[1];-1<a.indexOf("custom")&&(n=a=e);var i=t.baseMapList[a].object,o=i.getTypeProperties(n);i.createBaseMap(t.UUID,n,function(e){naji.njMapConfig.loading(t.njMap.getDataViewId(),e)});var r=t._createView(i,n);t._activeChangeResolution(i),t._transformLayerProjection(t.njMap.getMap().getView().getProjection().getCode(),o.projection),t.njMap.getMap().setView(r),t._setElementMargin(),t.njMap.refresh(),_$("#"+t.target).resize(function(){t._updateSize&&(t._setElementMargin(),t._updateSize())}),_$(window).resize(function(){t._updateSize&&(t._setElementMargin(),t._updateSize())})},naji.baseMap.njMapBaseMap.prototype._activeChangeResolution=function(t){var a=this._this||this;a.njMap.getMap().getView();a.njMap.getMap().on("change:view",function(e){ol.Observable.unByKey(a.key_changeCenter),ol.Observable.unByKey(a.key_changeRotation),ol.Observable.unByKey(a.key_changeResolution),a.key_changeCenter=e.target.getView().on("change:center",t.syncMapCenter),a.key_changeRotation=e.target.getView().on("change:rotation",t.syncMapRotation),a.key_changeResolution=e.target.getView().on("change:resolution",t.syncMapZoom)})},naji.baseMap.njMapBaseMap.prototype.addBaseMapType=function(e,t){var a=this._this||this;a.baseMapList=a.baseMapList||{},t&&t.isAvailables()&&(a.baseMapList[e]={code:e,object:t})},naji.baseMap.njMapBaseMap.prototype._createView=function(e,t){var a=this._this||this,n=e.getTypeProperties(t),i=a.njMap.getMap().getView(),o={projection:n.projection,extent:n.maxExtent,center:ol.proj.transform(i.getCenter(),i.getProjection(),n.projection),zoom:i.getZoom(),rotation:i.getRotation(),zoomFactor:2,minZoom:n.minZoom,maxZoom:n.maxZoom};return t.indexOf("custom"),n.resolutions&&(o.resolutions=n.resolutions),a.nowMapView=new ol.View(o),a.nowMapView},naji.baseMap.njMapBaseMap.prototype._transformLayerProjection=function(e,t){var a=(this._this||this).njMap.getMap().getLayers().getArray();for(var n in a)if(a[n]instanceof ol.layer.Group){var i=a[n].getLayersArray();for(var o in i)r(i[o],e,t)}else r(a[n],e,t);function r(e,t,a){var n=e.getSource();if(n instanceof ol.source.TileWMS||n instanceof ol.source.ImageWMS)"EPSG:4326"===a&&(n.getParams().VERSION="1.1.0",n.updateParams(n.getParams()));else if(n instanceof ol.source.Vector){if(n instanceof ol.source.Cluster)return!1;var i=n.getFeatures();for(var o in i)i[o].getGeometry().transform(t,a)}}},naji.baseMap.njMapBaseMap.prototype._updateSize=function(){var e=this._this||this,t=e.nowBaseMapKey.split("_")[0];e.nowBaseMapKey.split("_")[1];-1<t.indexOf("custom")&&(t=e.nowBaseMapKey,e.nowBaseMapKey),e.baseMapList[t].object.updateSize()},naji.baseMap.njMapBaseMap.prototype._isBaseMapUsable=function(e){var t=this._this||this,a=!0,n=e.split("_")[0];e.split("_")[1];(-1<n.indexOf("custom")&&(n=e),t.baseMapList[n])?-1===t.baseMapList[n].object.getUsableKeys().indexOf(e)&&(a=!1):a=!1;return a},naji.baseMap.njMapBaseMap.prototype.changeBaseMap=function(e){var t=this._this||this;if(e===t.nowBaseMapKey)return!1;if(!t._isBaseMapUsable(e))return naji.njMapConfig.alert_Error(e+" undefined"),!1;var a=t.nowBaseMapKey.split("_")[0],n=t.nowBaseMapKey.split("_")[1],i=e.split("_")[0],o=e.split("_")[1];-1<a.indexOf("custom")&&(a=t.nowBaseMapKey,n=t.nowBaseMapKey),-1<i.indexOf("custom")&&(o=i=e);var r=t.baseMapList[a].object,s=t.baseMapList[i].object,l=r.getTypeProperties(n),p=s.getTypeProperties(o);if(a===i&&n!==o){s.setMapType(o,function(e){naji.njMapConfig.loading(t.njMap.getDataViewId(),e)}),(d=t.nowMapView).setMinZoom(p.minZoom),d.setMaxZoom(p.maxZoom)}else{var c=t.nowMapView.calculateExtent(t.njMap.getMap().getSize()),u=l.projection,y=p.projection;l.zoomCount,p.zoomCount;document.getElementById(t.UUID).innerHTML="",document.getElementById(t.UUID).style.background="",s.createBaseMap(t.UUID,o,function(e){naji.njMapConfig.loading(t.njMap.getDataViewId(),e)});var d=t._createView(s,o);if(t._activeChangeResolution(s),ol.proj.equivalent(ol.proj.get(u),ol.proj.get(y))||t._transformLayerProjection(u,y),t.njMap.getMap().setView(d),r.isWorlds()){if(!s.isWorlds()){var h=p.maxExtent;h=ol.proj.transformExtent(h,y,"EPSG:3857"),c=ol.proj.transformExtent(c,u,"EPSG:3857"),ol.extent.containsExtent(h,c)?(d.fit(ol.proj.transformExtent(c,"EPSG:3857",y)),s.isFactors()&&d.setZoom(d.getZoom()+1)):d.fit(p.maxExtent)}}else d.fit(ol.proj.transformExtent(c,u,y)),s.isFactors()&&d.setZoom(d.getZoom()+1)}t.setVisible(!0),t.njMap.refresh(),t.nowBaseMapKey=e,console.log("####### changeBaseMap #######"),console.log("baseMapType : "+t.nowBaseMapKey)},naji.baseMap.njMapBaseMap.prototype.getUsableBaseMapList=function(){var e=this._this||this,t=[];for(var a in e.baseMapList)t=t.concat(e.baseMapList[a].object.getUsableKeys());return t},naji.baseMap.njMapBaseMap.prototype.remove=function(e){var t=this._this||this;if(-1<e.split("_")[0].indexOf("custom")){if(t.nowBaseMapKey===e)for(var a in t.baseMapList)if(t.baseMapList.hasOwnProperty(a)){var n=t.baseMapList[a].object.getUsableKeys()[0];t.changeBaseMap(n);break}delete t.baseMapList[e]}return t.getUsableBaseMapList()},naji.baseMap.njMapBaseMap.prototype.getSelectedBaseMap=function(){return(this._this||this).nowBaseMapKey},naji.baseMap.njMapBaseMap.prototype.getOpacity=function(e){var t=this._this||this;return document.getElementById(t.UUID).style.opacity},naji.baseMap.njMapBaseMap.prototype.setOpacity=function(e){var t=this._this||this,a=document.getElementById(t.UUID);"number"==typeof e&&(a.style.opacity=e)},naji.baseMap.njMapBaseMap.prototype.getVisible=function(){var e=this._this||this;return"visible"===document.getElementById(e.UUID).style.visibility},naji.baseMap.njMapBaseMap.prototype.setVisible=function(e){var t=this._this||this,a="visible";"boolean"==typeof e&&(e||(a="hidden")),document.getElementById(t.UUID).style.visibility=a},naji.baseMap.njMapBaseMap.prototype.visibleToggle=function(){var e=this._this||this;"visible"===document.getElementById(e.UUID).style.visibility?e.setVisible(!1):e.setVisible(!0)},naji.baseMap.njMapBaseMap.prototype.getApiMap=function(){var e=this._this||this;return e.baseMapList[e.nowBaseMapKey.split("_")[0]].object.getApiMap()},naji.baseMap.njMapBaseMap.prototype._setElementMargin=function(){var e=this._this||this;if(!e.useElementMargin)return!1;var t=$("#"+e.target),a=$("#"+e.UUID),n=t.width(),i=t.height(),o=Math.round(Math.sqrt(Math.pow(t.width(),2)+Math.pow(t.height(),2))),r=Math.round(o-n),s=Math.round(o-i);r%2==1&&++r,s%2==1&&++s,a.css("width","calc(100% + "+r+"px)"),a.css("height","calc(100% + "+s+"px)"),a.css("left",-r/2),a.css("top",-s/2)}}(),function(){"use strict";naji.baseMap.njMapBaseMapBaroEmap=function(t){var i=this,a=null;return this.resolutions=null,function(){var e=t||{};if(e.resolutions=[1954.597389,977.2986945,488.64934725,244.324673625,122.1623368125,61.08116840625,30.540584203125,15.2702921015625,7.63514605078125,3.817573025390625,1.9087865126953125,.9543932563476563,.47719662817382813,.23859831408691407,.119299157043457,.0596495785217285,.0298247892608643,.0149123946304321,.0074561973152161,.003728098657608,.001864049328804,.000932024664402,.000466012332201,.0002330061661005,.0001165030830503],e.isWorld=!1,e.isFactor=!1,e.baseCode="baroEmap",e.projection="EPSG:5179",e.maxExtent=ol.proj.get("EPSG:5179").getExtent(),e.mapTypes={normal:{id:0,minZoom:0,maxZoom:13},white:{id:4,minZoom:0,maxZoom:13},colorVision:{id:1,minZoom:0,maxZoom:13}},a=naji.baseMap.njMapBaseMapDefault.call(i,e),i.checkIsAvailable("ngii.version"),!i.isAvailables());}(),naji.util.njMapUtil.objectMerge(a,{_this:i,syncMapZoom:function(e){var t=i.getSyncData(e),a=new OpenLayers.LonLat(t.center[0],t.center[1]),n=t.zoom;i.apiMap.setCenter(a,n,!1,!1)},syncMapCenter:function(e){var t=i.getSyncData(e),a=new OpenLayers.LonLat(t.center[0],t.center[1]),n=t.zoom;i.apiMap.setCenter(a,n,!1,!1)},syncMapRotation:function(e){var t=i.getSyncData(e);$("#"+i.target).css("transform","rotate("+t.rotation+"rad)")}})},naji.baseMap.njMapBaseMapBaroEmap.prototype=Object.create(naji.baseMap.njMapBaseMapDefault.prototype),naji.baseMap.njMapBaseMapBaroEmap.prototype.constructor=naji.baseMap.njMapBaseMapBaroEmap,naji.baseMap.njMapBaseMapBaroEmap.prototype.createBaseMap=function(e,t,a){var n=this._this||this;n.target=e,n.apiMap=new ngii.map(e),n.setMapType(t,a)},naji.baseMap.njMapBaseMapBaroEmap.prototype.setMapType=function(e,t){var a=this._this||this,n=e;a.mapTypes[n]||(n="normal"),a.apiMap._setMapMode(a.mapTypes[n].id),a._setTileLoadEvents(t)},naji.baseMap.njMapBaseMapBaroEmap.prototype.updateSize=function(){(this._this||this).apiMap.updateSize()},naji.baseMap.njMapBaseMapBaroEmap.prototype._setTileLoadEvents=function(e){var t=(this._this||this).apiMap._getMap().baseLayer;t.events.register("loadstart",t,function(){e.call(this,!0)}),t.events.register("loadend",t,function(){e.call(this,!1)}),t.events.register("tileloadstart",t,function(){e.call(this,!0)}),t.events.register("tileloaded",t,function(){e.call(this,!1)})}}(),function(){"use strict";naji.baseMap.njMapBaseMapBing=function(t){var n=this,a=null;return function(){var e=t||{};if(e.isWorld=!0,e.isFactor=!0,e.baseCode="bing",e.projection="EPSG:3857",e.maxExtent=ol.proj.get("EPSG:3857").getExtent(),e.mapTypes={normal:{id:"normal",layer:function(){return new ol.layer.Tile({source:new ol.source.BingMaps({culture:"ko-KR",key:window.API_KEY_BING,imagerySet:"RoadOnDemand"})})},minZoom:0,maxZoom:19},aerial:{id:"aerial",layer:function(){return new ol.layer.Tile({source:new ol.source.BingMaps({culture:"ko-KR",key:window.API_KEY_BING,imagerySet:"Aerial"})})},minZoom:1,maxZoom:19},hybrid:{id:"hybrid",layer:function(){return new ol.layer.Tile({source:new ol.source.BingMaps({culture:"ko-KR",key:window.API_KEY_BING,imagerySet:"AerialWithLabelsOnDemand"})})},minZoom:1,maxZoom:19},dark:{id:"dark",layer:function(){return new ol.layer.Tile({source:new ol.source.BingMaps({culture:"ko-KR",key:window.API_KEY_BING,imagerySet:"CanvasDark"})})},minZoom:1,maxZoom:19}},a=naji.baseMap.njMapBaseMapDefault.call(n,e),n.checkIsAvailable("new ol.layer.Tile"),!n.isAvailable);}(),naji.util.njMapUtil.objectMerge(a,{_this:n,syncMapZoom:function(e){var t=n.getSyncData(e).zoom;n.apiMap.getView().setZoom(t)},syncMapCenter:function(e){var t=n.getSyncData(e),a=ol.proj.transform(t.center,t.projection,"EPSG:3857");n.apiMap.getView().setCenter(a)},syncMapRotation:function(e){var t=n.getSyncData(e);$("#"+n.target).css("transform","rotate("+t.rotation+"rad)")}})},naji.baseMap.njMapBaseMapBing.prototype=Object.create(naji.baseMap.njMapBaseMapDefault.prototype),naji.baseMap.njMapBaseMapBing.prototype.constructor=naji.baseMap.njMapBaseMapBing,naji.baseMap.njMapBaseMapBing.prototype.createBaseMap=function(e,t,a){var n=this._this||this;n.target=e,n.apiMap=new ol.Map({layers:[],controls:[],interactions:[],target:e,view:new ol.View({center:[0,0],zoom:2})}),n.setMapType(t,a)},naji.baseMap.njMapBaseMapBing.prototype.setMapType=function(e,t){var a=this._this||this,n=e;a.mapTypes[n]||(n="normal"),a._removeAllLayer(a.apiMap.getLayers()),a.apiMap.addLayer(a.mapTypes[n].layer()),a._setTileLoadEvents(t)},naji.baseMap.njMapBaseMapBing.prototype.updateSize=function(){(this._this||this).apiMap.updateSize()},naji.baseMap.njMapBaseMapBing.prototype._removeAllLayer=function(e){var a=this._this||this;e.forEach(function(e,t){a.apiMap.removeLayer(e)}),0<a.apiMap.getLayers().getLength()&&a._removeAllLayer(a.apiMap.getLayers())},naji.baseMap.njMapBaseMapBing.prototype._setTileLoadEvents=function(e){var t=(this._this||this).apiMap.getLayers().item(0).getSource();t.on(["imageloadstart","tileloadstart"],function(){e.call(this,!0)}),t.on(["imageloadend","tileloadend"],function(){e.call(this,!1)}),t.on(["imageloaderror","tileloaderror"],function(){e.call(this,!1)})}}(),function(){"use strict";naji.baseMap.njMapBaseMapCustom=function(r){var s=this,l=null;return this.resolutions=null,this.capabilities=null,this.layer=null,function(){var e=r||{};if(s.capabilities=void 0!==e.capabilities?e.capabilities:void 0,s.layer=void 0!==e.layer?e.layer:void 0,!s.capabilities)return naji.njMapConfig.alert_Error("capabilities undefined"),s.isAvailable=!1;if(!s.layer)return naji.njMapConfig.alert_Error("layer undefined"),s.isAvailable=!1;e.isWorld=void 0===e.isWorld||e.isWorld,e.isFactor=void 0===e.isFactor||e.isFactor,e.baseCode=void 0!==e.baseMapKey?e.baseMapKey:"custom_code",e.projection=s.capabilities.serviceMetaData.crs,-1<e.projection.indexOf("urn:ogc:def:crs:EPSG:")&&(e.projection=e.projection.replace("urn:ogc:def:crs:EPSG:","EPSG"));var t=s.capabilities.olJson.Contents.Layer;for(var a in t)if(t[a].Identifier===s.layer.layer){e.maxExtent=ol.proj.transformExtent(t[a].WGS84BoundingBox,"EPSG:4326",e.projection);break}var n=s.capabilities.olJson.Contents.TileMatrixSet;for(var a in n)if(n[a].Identifier===s.layer.matrixSet){s.resolutions=[];var i=n[a].TileMatrix;for(var o in i)s.resolutions.push(264583e-9*i[o].ScaleDenominator);e.mapTypes={},e.mapTypes[e.baseCode]={id:e.baseCode,minZoom:0,resolutions:s.resolutions,maxZoom:n[a].TileMatrix.length-1};break}l=naji.baseMap.njMapBaseMapDefault.call(s,e),s.checkIsAvailable(""),s.isAvailable}(),naji.util.njMapUtil.objectMerge(l,{_this:s,syncMapZoom:function(e){var t=s.getSyncData(e).zoom;s.apiMap.getView().setZoom(t)},syncMapCenter:function(e){var t=s.getSyncData(e),a=ol.proj.transform(t.center,t.projection,s.projection);s.apiMap.getView().setCenter(a)},syncMapRotation:function(e){var t=s.getSyncData(e);$("#"+s.target).css("transform","rotate("+t.rotation+"rad)")}})},naji.baseMap.njMapBaseMapCustom.prototype=Object.create(naji.baseMap.njMapBaseMapDefault.prototype),naji.baseMap.njMapBaseMapCustom.prototype.constructor=naji.baseMap.njMapBaseMapCustom,naji.baseMap.njMapBaseMapCustom.prototype.createBaseMap=function(e,t,a){var n=this._this||this;n.target=e,n.apiMap=new ol.Map({layers:[],controls:[],interactions:[],target:e,projection:n.projection,view:new ol.View({zoom:2,center:[0,0],projection:n.projection,minZoom:n.mapTypes[t].minZoom,maxZoom:n.mapTypes[t].maxZoom,resolutions:n.mapTypes[t].resolutions})}),n.setMapType(t,a)},naji.baseMap.njMapBaseMapCustom.prototype.setMapType=function(e,t){var a=this._this||this;a.layer.setWmtsCapabilities(a.capabilities),a.layer.update(!0),a.apiMap.addLayer(a.layer.getOlLayer()),a._setTileLoadEvents(t)},naji.baseMap.njMapBaseMapCustom.prototype.updateSize=function(){(this._this||this).apiMap.updateSize()},naji.baseMap.njMapBaseMapCustom.prototype._setTileLoadEvents=function(e){var t=(this._this||this).apiMap.getLayers().item(0).getSource();if(!t)return!1;t.on(["imageloadstart","tileloadstart"],function(){e.call(this,!0)}),t.on(["imageloadend","tileloadend"],function(){e.call(this,!1)}),t.on(["imageloaderror","tileloaderror"],function(){e.call(this,!1)})}}(),function(){"use strict";naji.baseMap.njMapBaseMapDaum=function(t){var n=this,a=null;return function(){var e=t||{};if(e.isWorld=!1,e.isFactor=!1,e.baseCode="daum",e.projection="EPSG:5181",e.maxExtent=ol.proj.get("EPSG:5181").getExtent(),e.mapTypes={normal:{id:1,minZoom:1,maxZoom:14},satellite:{id:2,minZoom:1,maxZoom:15},hybrid:{id:3,minZoom:1,maxZoom:15}},a=naji.baseMap.njMapBaseMapDefault.call(n,e),n.checkIsAvailable("daum.maps.MapTypeId"),!n.isAvailable);}(),naji.util.njMapUtil.objectMerge(a,{_this:n,syncMapZoom:function(e){var t=15-n.getSyncData(e).zoom;n.apiMap.setLevel(t),n.apiMap.relayout()},syncMapCenter:function(e){var t=n.getSyncData(e),a=ol.proj.transform(t.center,t.projection,"EPSG:4326");n.apiMap.setCenter(new daum.maps.LatLng(a[1],a[0])),n.apiMap.relayout()},syncMapRotation:function(e){var t=n.getSyncData(e);$("#"+n.target).css("transform","rotate("+t.rotation+"rad)")}})},naji.baseMap.njMapBaseMapDaum.prototype=Object.create(naji.baseMap.njMapBaseMapDefault.prototype),naji.baseMap.njMapBaseMapDaum.prototype.constructor=naji.baseMap.njMapBaseMapDaum,naji.baseMap.njMapBaseMapDaum.prototype.createBaseMap=function(e,t,a){var n=this._this||this;n.target=e;var i=document.getElementById(e),o={center:new daum.maps.LatLng(33.450701,126.570667),level:3};n.apiMap=new daum.maps.Map(i,o),n.setMapType(t,a)},naji.baseMap.njMapBaseMapDaum.prototype.setMapType=function(e,t){var a=this._this||this,n=e;a.mapTypes[n]||(n="normal"),a.apiMap.setMapTypeId(a.mapTypes[n].id),a._setTileLoadEvents(t)},naji.baseMap.njMapBaseMapDaum.prototype.updateSize=function(){(this._this||this).apiMap.relayout()},naji.baseMap.njMapBaseMapDaum.prototype._setTileLoadEvents=function(e){var t=this._this||this;kakao.maps.event.addListener(t.apiMap,"bounds_changed",function(){e.call(this,!0),window.setTimeout(function(){e.call(this,!1)},500)}),kakao.maps.event.trigger(t.apiMap,"bounds_changed")}}(),function(){"use strict";naji.baseMap.njMapBaseMapGoogle=function(t){var n=this,a=null;return function(){var e=t||{};if(e.isWorld=!0,e.isFactor=!0,e.baseCode="google",e.projection="EPSG:900913",e.maxExtent=ol.proj.get("EPSG:900913").getExtent(),e.mapTypes={normal:{id:"roadmap",minZoom:0,maxZoom:21},satellite:{id:"satellite",minZoom:0,maxZoom:19},hybrid:{id:"hybrid",minZoom:0,maxZoom:19},terrain:{id:"terrain",minZoom:0,maxZoom:19}},a=naji.baseMap.njMapBaseMapDefault.call(n,e),n.checkIsAvailable("google.maps.MapTypeId"),!n.isAvailables());}(),naji.util.njMapUtil.objectMerge(a,{_this:n,syncMapZoom:function(e){var t=n.getSyncData(e).zoom;n.apiMap.setZoom(t)},syncMapCenter:function(e){var t=n.getSyncData(e),a=ol.proj.transform(t.center,t.projection,"EPSG:4326");n.apiMap.setCenter({lat:a[1],lng:a[0]})},syncMapRotation:function(e){var t=n.getSyncData(e);$("#"+n.target).css("transform","rotate("+t.rotation+"rad)")}})},naji.baseMap.njMapBaseMapGoogle.prototype=Object.create(naji.baseMap.njMapBaseMapDefault.prototype),naji.baseMap.njMapBaseMapGoogle.prototype.constructor=naji.baseMap.njMapBaseMapGoogle,naji.baseMap.njMapBaseMapGoogle.prototype.createBaseMap=function(e,t,a){var n=this._this||this;n.target=e;n.apiMap=new google.maps.Map(document.getElementById(e),{zoom:4,center:{lat:-33,lng:151},disableDefaultUI:!0}),n.setMapType(t,a)},naji.baseMap.njMapBaseMapGoogle.prototype.setMapType=function(e,t){var a=this._this||this,n=e;a.mapTypes[n]||(n="normal"),a.apiMap.setMapTypeId(a.mapTypes[n].id),a._setTileLoadEvents(t)},naji.baseMap.njMapBaseMapGoogle.prototype.updateSize=function(){var e=this._this||this;google.maps.event.trigger(e.apiMap,"resize")},naji.baseMap.njMapBaseMapGoogle.prototype._setTileLoadEvents=function(e){var t=this._this||this;google.maps.event.addListener(t.apiMap,"bounds_changed",function(){e.call(this,!0),window.setTimeout(function(){e.call(this,!1)},500)}),google.maps.event.trigger(t.apiMap,"bounds_changed")}}(),function(){"use strict";naji.baseMap.njMapBaseMapNaver=function(t){var n=this,a=null;return function(){var e=t||{};if(e.isWorld=!1,e.isFactor=!0,e.baseCode="naver",e.projection="EPSG:3857",e.maxExtent=[13833615.936057687,3779460.9620584883,14690783.774134403,4666706.57663997],e.mapTypes={normal:{id:"normal",minZoom:6,maxZoom:21},satellite:{id:"satellite",minZoom:6,maxZoom:21},hybrid:{id:"hybrid",minZoom:6,maxZoom:21},terrain:{id:"terrain",minZoom:6,maxZoom:21}},a=naji.baseMap.njMapBaseMapDefault.call(n,e),n.checkIsAvailable("naver.maps.MapTypeId"),!n.isAvailable);}(),naji.util.njMapUtil.objectMerge(a,{_this:n,syncMapZoom:function(e){var t=n.getSyncData(e).zoom;n.apiMap.setZoom(t,!1)},syncMapCenter:function(e){var t=n.getSyncData(e),a=ol.proj.transform(t.center,t.projection,"EPSG:4326");n.apiMap.setCenter(new naver.maps.LatLng(a[1],a[0]))},syncMapRotation:function(e){var t=n.getSyncData(e);$("#"+n.target).css("transform","rotate("+t.rotation+"rad)")}})},naji.baseMap.njMapBaseMapNaver.prototype=Object.create(naji.baseMap.njMapBaseMapDefault.prototype),naji.baseMap.njMapBaseMapNaver.prototype.constructor=naji.baseMap.njMapBaseMapNaver,naji.baseMap.njMapBaseMapNaver.prototype.createBaseMap=function(e,t,a){var n=this._this||this;n.target=e;var i={center:new naver.maps.LatLng(37.3595704,127.105399),level:3};n.apiMap=new naver.maps.Map(e,i),n.setMapType(t,a)},naji.baseMap.njMapBaseMapNaver.prototype.setMapType=function(e,t){var a=this._this||this,n=e;a.mapTypes[n]||(n="normal"),a.apiMap.setMapTypeId(a.mapTypes[n].id),a._setTileLoadEvents(t)},naji.baseMap.njMapBaseMapNaver.prototype.updateSize=function(){(this._this||this).apiMap.trigger("resize")},naji.baseMap.njMapBaseMapNaver.prototype._setTileLoadEvents=function(e){var t=this._this||this;naver.maps.Event.addListener(t.apiMap,"bounds_changed",function(){e.call(this,!0),window.setTimeout(function(){e.call(this,!1)},500)}),naver.maps.Event.trigger(t.apiMap,"bounds_changed")}}(),function(){"use strict";naji.baseMap.njMapBaseMapOSM=function(a){var n=this,i=null;return function(){var e=a||{},t="http://{a-c}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png";if(naji.njMapConfig.isMapProxy()&&(t=naji.njMapConfig.getProxy()+t),e.isWorld=!0,e.isFactor=!0,e.baseCode="osm",e.projection="EPSG:3857",e.maxExtent=ol.proj.get("EPSG:3857").getExtent(),e.mapTypes={normal:{id:"normal",layer:function(){return new ol.layer.Tile({source:new ol.source.OSM})},minZoom:0,maxZoom:21},gray:{id:"gray",layer:function(){return new ol.layer.Tile({source:new ol.source.XYZ({url:t,attributions:[ol.source.OSM.ATTRIBUTION]})})},minZoom:0,maxZoom:18},none:{id:"none",layer:function(){return new ol.layer.Tile},minZoom:0,maxZoom:21}},i=naji.baseMap.njMapBaseMapDefault.call(n,e),n.checkIsAvailable("new ol.layer.Tile"),!n.isAvailable);}(),naji.util.njMapUtil.objectMerge(i,{_this:n,syncMapZoom:function(e){var t=n.getSyncData(e).zoom;n.apiMap.getView().setZoom(t)},syncMapCenter:function(e){var t=n.getSyncData(e),a=ol.proj.transform(t.center,t.projection,"EPSG:3857");n.apiMap.getView().setCenter(a)},syncMapRotation:function(e){var t=n.getSyncData(e);$("#"+n.target).css("transform","rotate("+t.rotation+"rad)")}})},naji.baseMap.njMapBaseMapOSM.prototype=Object.create(naji.baseMap.njMapBaseMapDefault.prototype),naji.baseMap.njMapBaseMapOSM.prototype.constructor=naji.baseMap.njMapBaseMapOSM,naji.baseMap.njMapBaseMapOSM.prototype.createBaseMap=function(e,t,a){var n=this._this||this;n.target=e,n.apiMap=new ol.Map({layers:[],controls:[new ol.control.Attribution({collapsible:!1})],interactions:[],target:e,view:new ol.View({center:[0,0],zoom:2})}),n.setMapType(t,a)},naji.baseMap.njMapBaseMapOSM.prototype.setMapType=function(e,t){var a=this._this||this,n=e;a.mapTypes[n]||(n="normal"),a._removeAllLayer(a.apiMap.getLayers()),a.apiMap.addLayer(a.mapTypes[n].layer()),a._setTileLoadEvents(t)},naji.baseMap.njMapBaseMapOSM.prototype.updateSize=function(){(this._this||this).apiMap.updateSize()},naji.baseMap.njMapBaseMapOSM.prototype._removeAllLayer=function(e){var a=this._this||this;e.forEach(function(e,t){a.apiMap.removeLayer(e)}),0<a.apiMap.getLayers().getLength()&&a._removeAllLayer(a.apiMap.getLayers())},naji.baseMap.njMapBaseMapOSM.prototype._setTileLoadEvents=function(e){var t=(this._this||this).apiMap.getLayers().item(0).getSource();if(!t)return!1;t.on(["imageloadstart","tileloadstart"],function(){e.call(this,!0)}),t.on(["imageloadend","tileloadend"],function(){e.call(this,!1)}),t.on(["imageloaderror","tileloaderror"],function(){e.call(this,!1)})}}(),function(){"use strict";naji.baseMap.njMapBaseMapStamen=function(t){var n=this,a=null;return function(){var e=t||{};if(e.isWorld=!0,e.isFactor=!0,e.baseCode="stamen",e.projection="EPSG:3857",e.maxExtent=ol.proj.get("EPSG:3857").getExtent(),e.mapTypes={toner:{id:"toner",layer:function(){return new ol.layer.Tile({source:new ol.source.Stamen({layer:"toner"})})},minZoom:0,maxZoom:20},terrain:{id:"terrain",layer:function(){return new ol.layer.Tile({source:new ol.source.Stamen({layer:"terrain"})})},minZoom:0,maxZoom:18}},a=naji.baseMap.njMapBaseMapDefault.call(n,e),n.checkIsAvailable("ol.source.Stamen"),!n.isAvailable);}(),naji.util.njMapUtil.objectMerge(a,{_this:n,syncMapZoom:function(e){var t=n.getSyncData(e).zoom;n.apiMap.getView().setZoom(t)},syncMapCenter:function(e){var t=n.getSyncData(e),a=ol.proj.transform(t.center,t.projection,"EPSG:3857");n.apiMap.getView().setCenter(a)},syncMapRotation:function(e){var t=n.getSyncData(e);$("#"+n.target).css("transform","rotate("+t.rotation+"rad)")}})},naji.baseMap.njMapBaseMapStamen.prototype=Object.create(naji.baseMap.njMapBaseMapDefault.prototype),naji.baseMap.njMapBaseMapStamen.prototype.constructor=naji.baseMap.njMapBaseMapStamen,naji.baseMap.njMapBaseMapStamen.prototype.createBaseMap=function(e,t,a){var n=this._this||this;n.target=e,n.apiMap=new ol.Map({layers:[],controls:[new ol.control.Attribution({collapsible:!1})],interactions:[],target:e,view:new ol.View({center:[0,0],zoom:2})}),n.setMapType(t,a)},naji.baseMap.njMapBaseMapStamen.prototype.setMapType=function(e,t){var a=this._this||this,n=e;a.mapTypes[n]||(n="toner"),a._removeAllLayer(a.apiMap.getLayers()),a.apiMap.addLayer(a.mapTypes[n].layer()),a._setTileLoadEvents(t)},naji.baseMap.njMapBaseMapStamen.prototype.updateSize=function(){(this._this||this).apiMap.updateSize()},naji.baseMap.njMapBaseMapStamen.prototype._removeAllLayer=function(e){var a=this._this||this;e.forEach(function(e,t){a.apiMap.removeLayer(e)}),0<a.apiMap.getLayers().getLength()&&a._removeAllLayer(a.apiMap.getLayers())},naji.baseMap.njMapBaseMapStamen.prototype._setTileLoadEvents=function(e){var t=(this._this||this).apiMap.getLayers().item(0).getSource();if(!t)return!1;t.on(["imageloadstart","tileloadstart"],function(){e.call(this,!0)}),t.on(["imageloadend","tileloadend"],function(){e.call(this,!1)}),t.on(["imageloaderror","tileloaderror"],function(){e.call(this,!1)})}}(),function(){"use strict";naji.baseMap.njMapBaseMapTMS_vWorld=function(t){var a=this,n=null;return function(){var e=t||{};e.isWorld=!1,e.isFactor=!0,e.projection=e.projection,e.baseCode=void 0!==e.baseCode?e.baseCode:"TMS",e.maxExtent=ol.proj.get(e.projection).getExtent(),e.mapTypes={normal:{id:"normal",layer:function(){return[new ol.layer.Tile({source:new ol.source.XYZ({url:"http://xdworld.vworld.kr:8080/2d/Base/service/{z}/{x}/{y}.png"})})]},minZoom:0,maxZoom:20},satellite:{id:"SATELLITE",layer:function(){return[new ol.layer.Tile({source:new ol.source.XYZ({url:"http://xdworld.vworld.kr:8080/2d/Satellite/service/{z}/{x}/{y}.jpeg"})})]},minZoom:0,maxZoom:20},hybrid:{id:"VHYBRID",layer:function(){return[new ol.layer.Tile({source:new ol.source.XYZ({url:"http://xdworld.vworld.kr:8080/2d/Satellite/service/{z}/{x}/{y}.jpeg"})}),new ol.layer.Tile({source:new ol.source.XYZ({url:"http://xdworld.vworld.kr:8080/2d/Hybrid/service/{z}/{x}/{y}.png"})})]},minZoom:0,maxZoom:20},gray:{id:"VGRAY",layer:function(){return[new ol.layer.Tile({source:new ol.source.XYZ({url:"http://xdworld.vworld.kr:8080/2d/gray/service/{z}/{x}/{y}.png"})})]},minZoom:0,maxZoom:20},midnight:{id:"VMIDNIGHT",layer:function(){return[new ol.layer.Tile({source:new ol.source.XYZ({url:"http://xdworld.vworld.kr:8080/2d/midnight/service/{z}/{x}/{y}.png"})})]},minZoom:0,maxZoom:20}},n=naji.baseMap.njMapBaseMapDefault.call(a,e);void 0!==e.projection&&e.projection;if(a.checkIsAvailable(""),!a.isAvailable);}(),naji.util.njMapUtil.objectMerge(n,{_this:a,syncMapZoom:function(e){var t=a.getSyncData(e).zoom;a.apiMap.getView().setZoom(t)},syncMapCenter:function(e){var t=a.getSyncData(e).center;a.apiMap.getView().setCenter(t)},syncMapRotation:function(e){var t=a.getSyncData(e);$("#"+a.target).css("transform","rotate("+t.rotation+"rad)")}})},naji.baseMap.njMapBaseMapTMS_vWorld.prototype=Object.create(naji.baseMap.njMapBaseMapDefault.prototype),naji.baseMap.njMapBaseMapTMS_vWorld.prototype.constructor=naji.baseMap.njMapBaseMapTMS_vWorld,naji.baseMap.njMapBaseMapTMS_vWorld.prototype.createBaseMap=function(e,t,a){var n=this._this||this;n.target=e,n.apiMap=new ol.Map({layers:[],controls:[],interactions:[],target:e,view:new ol.View({center:[0,0],projection:n.projection,zoom:2})}),n.setMapType(t,a)},naji.baseMap.njMapBaseMapTMS_vWorld.prototype.setMapType=function(e,t){var a=this._this||this,n=e;a.mapTypes[n]||(n="normal"),a._removeAllLayer(a.apiMap.getLayers().getArray());var i=a.mapTypes[n].layer();for(var o in i)a.apiMap.addLayer(i[o]);a._setTileLoadEvents(t)},naji.baseMap.njMapBaseMapTMS_vWorld.prototype.updateSize=function(){(this._this||this).apiMap.updateSize()},naji.baseMap.njMapBaseMapTMS_vWorld.prototype._removeAllLayer=function(e){for(var t=this._this||this,a=e.length-1;0<=a;a--)t.apiMap.removeLayer(e[a])},naji.baseMap.njMapBaseMapTMS_vWorld.prototype._setTileLoadEvents=function(e){var t=(this._this||this).apiMap.getLayers().getArray();for(var a in t){var n=t[a].getSource();n.on(["tileloadstart"],function(){e.call(this,!0)}),n.on(["tileloadend"],function(){e.call(this,!1)}),n.on(["tileloaderror"],function(){e.call(this,!1)})}}}(),function(){"use strict";naji.baseMap.njMapBaseMapVWorld=function(t){var i=this,a=null;return function(){var e=t||{};if(e.isWorld=!1,e.isFactor=!0,e.baseCode="vWorld",e.projection="EPSG:900913",e.maxExtent=[12873319.534819111,3857406.4178978344,15494719.534819111,5166406.417897834],e.mapTypes={normal:{id:"VBASE",layer:function(){return[new vworld.Layers.Base("VBASE")]},minZoom:6,maxZoom:19},satellite:{id:"SATELLITE",layer:function(){var e=new vworld.Layers.Satellite("VSAT");return e.max_level=19,[e]},minZoom:6,maxZoom:19},hybrid:{id:"VHYBRID",layer:function(){var e=new vworld.Layers.Satellite("VSAT"),t=new vworld.Layers.Hybrid("VHYBRID");return e.max_level=19,t.max_level=19,[e,t]},minZoom:6,maxZoom:19},gray:{id:"VGRAY",layer:function(){return[new vworld.Layers.Gray("VGRAY")]},minZoom:6,maxZoom:18},midnight:{id:"VMIDNIGHT",layer:function(){return[new vworld.Layers.Midnight("VMIDNIGHT")]},minZoom:6,maxZoom:18}},a=naji.baseMap.njMapBaseMapDefault.call(i,e),i.checkIsAvailable("vworld.Layers.Base"),!i.isAvailable);}(),naji.util.njMapUtil.objectMerge(a,{_this:i,syncMapZoom:function(e){var t=i.getSyncData(e),a=ol.proj.transform(t.center,t.projection,"EPSG:900913");a=new OpenLayers.LonLat(t.center[0],t.center[1]);var n=t.zoom;i.apiMap.setCenter(a,n,!1,!1)},syncMapCenter:function(e){var t=i.getSyncData(e),a=ol.proj.transform(t.center,t.projection,"EPSG:900913");a=new OpenLayers.LonLat(t.center[0],t.center[1]);var n=t.zoom;i.apiMap.setCenter(a,n,!1,!1)},syncMapRotation:function(e){var t=i.getSyncData(e);$("#"+i.target).css("transform","rotate("+t.rotation+"rad)")}})},naji.baseMap.njMapBaseMapVWorld.prototype=Object.create(naji.baseMap.njMapBaseMapDefault.prototype),naji.baseMap.njMapBaseMapVWorld.prototype.constructor=naji.baseMap.njMapBaseMapVWorld,naji.baseMap.njMapBaseMapVWorld.prototype.createBaseMap=function(e,t,a){var n=this._this||this;n.target=e;var i={units:"m",controls:[],numZoomLevels:21,projection:new OpenLayers.Projection("EPSG:900913"),displayProjection:new OpenLayers.Projection("EPSG:900913")};n.apiMap=new OpenLayers.Map(e,i),n.setMapType(t,a)},naji.baseMap.njMapBaseMapVWorld.prototype.setMapType=function(e,t){var a=this._this||this,n=e;a.mapTypes[n]||(n="normal"),a._removeAllLayer(a.apiMap.layers);var i=a.mapTypes[n].layer();for(var o in i)a.apiMap.addLayer(i[o]);a._setTileLoadEvents(t)},naji.baseMap.njMapBaseMapVWorld.prototype.updateSize=function(){(this._this||this).apiMap.updateSize()},naji.baseMap.njMapBaseMapVWorld.prototype._removeAllLayer=function(e){var a=this._this||this;e.forEach(function(e,t){a.apiMap.removeLayer(e)}),0<a.apiMap.layers.length&&a._removeAllLayer(a.apiMap.layers)},naji.baseMap.njMapBaseMapVWorld.prototype._setTileLoadEvents=function(e){var t=(this._this||this).apiMap.layers;for(var a in t)t[a].events.register("loadstart",t[a],function(){e.call(this,!0)}),t[a].events.register("loadend",t[a],function(){e.call(this,!1)}),t[a].events.register("tileloadstart",t[a],function(){e.call(this,!0)}),t[a].events.register("tileloaded",t[a],function(){e.call(this,!1)})}}(),function(){"use strict";naji.animation.featureAnimationDefault=function(e){var t,a=this;return this.easing=null,this.repeat=null,this.useFade=null,this.duration=null,this.style=null,this.isStop=null,this.strokeStyle=null,this.animationType=null,t=e||{},a.animationType="string"==typeof t.animationType?t.animationType:"zoomIn",a.setEasing(t.easing),a.setRepeat(t.repeat),a.setUseFade(t.useFade),a.setDuration(t.duration),{animate:a.animate,setStyle:a.setStyle,setRepeat:a.setRepeat,setUseFade:a.setUseFade,setDuration:a.setDuration,setStrokeStyle:a.setStrokeStyle,getProperties:a.getProperties}},naji.animation.featureAnimationDefault.prototype.animate=function(e){return!1},naji.animation.featureAnimationDefault.prototype.setEasing=function(e){(this._this||this).easing="string"==typeof e?ol.easing[e]:ol.easing.linear},naji.animation.featureAnimationDefault.prototype.setRepeat=function(e){(this._this||this).repeat="number"==typeof e&&0<=e?e:1e4},naji.animation.featureAnimationDefault.prototype.setUseFade=function(e){(this._this||this).useFade="boolean"!=typeof e||e},naji.animation.featureAnimationDefault.prototype.setDuration=function(e){(this._this||this).duration="number"==typeof e&&0<=e?e:2e3},naji.animation.featureAnimationDefault.prototype.setStyle=function(e){(this._this||this).style=e},naji.animation.featureAnimationDefault.prototype.setStrokeStyle=function(e){var t=this._this||this,a=new ol.style.Style({stroke:e});t.strokeStyle=a},naji.animation.featureAnimationDefault.prototype.drawGeom=function(e,t){var a=this._this||this;a.useFade?e.context.globalAlpha=ol.easing.easeIn(e.elapsed):e.context.globalAlpha=1;for(var n=a.style,i=0;i<n.length;i++){var o=0,r=!ol.Map.prototype.getFeaturesAtPixel&&n[i].getImage();r&&(o=r.getScale(),r.setScale(e.frameState.pixelRatio*o)),e.vectorContext.setStyle(n[i]),e.vectorContext.drawGeometry(t),r&&r.setScale(o)}},naji.animation.featureAnimationDefault.prototype.getProperties=function(){var e=this._this||this;return{repeat:e.repeat,useFade:e.useFade,duration:e.duration,animationType:e.animationType}}}(),function(){"use strict";naji.animation.bounceAnimation=function(e){var t,a=this,n=null;return this.bounce=null,this.amplitude=null,(t=e||{}).animationType="bounce",a.setBounce(t.bounce),a.setAmplitude(t.amplitude),n=naji.animation.featureAnimationDefault.call(a,t),naji.util.njMapUtil.objectMerge(n,{_this:a,setBounce:a.setBounce,setAmplitude:a.setAmplitude})},naji.animation.bounceAnimation.prototype=Object.create(naji.animation.featureAnimationDefault.prototype),naji.animation.bounceAnimation.prototype.constructor=naji.animation.bounceAnimation,naji.animation.bounceAnimation.prototype.setBounce=function(e){(this._this||this).bounce="number"==typeof e&&0<=e?e:3},naji.animation.bounceAnimation.prototype.setAmplitude=function(e){(this._this||this).amplitude="number"==typeof e&&0<=e?e:40},naji.animation.bounceAnimation.prototype.animate=function(e){var t=this._this||this,a=e.frameState.extent;if(ol.extent.intersects(a,e.bbox)){var n=-Math.PI*t.bounce,i=e.geom.clone(),o=Math.abs(Math.sin(n*e.elapsed))*t.amplitude*(1-t.easing(e.elapsed))*e.frameState.viewState.resolution;i.translate(0,o),t.drawGeom(e,i)}return e.time<=t.duration},naji.animation.bounceAnimation.prototype.getProperties=function(){var e=this._this||this,t=naji.animation.featureAnimationDefault.prototype.getProperties.call(this);return naji.util.njMapUtil.objectMerge(t,{bounce:e.bounce,amplitude:e.amplitude})}}(),function(){"use strict";naji.animation.dropAnimation=function(e){var t,a=this,n=null;return this.side=null,(t=e||{}).animationType="drop",a.setSide(t.side),n=naji.animation.featureAnimationDefault.call(a,t),naji.util.njMapUtil.objectMerge(n,{_this:a,setSide:a.setSide})},naji.animation.dropAnimation.prototype=Object.create(naji.animation.featureAnimationDefault.prototype),naji.animation.dropAnimation.prototype.constructor=naji.animation.dropAnimation,naji.animation.dropAnimation.prototype.setSide=function(e){(this._this||this).side="string"==typeof e?e:"top"},naji.animation.dropAnimation.prototype.animate=function(e){var t=this._this||this,a=e.frameState.extent;if(ol.extent.intersects(a,e.bbox)){var n;"top"==t.side?n=e.extent[3]-e.bbox[1]:"bottom"==t.side&&(n=e.extent[1]-e.bbox[3]);var i=e.geom.clone();i.translate(0,n*(1-t.easing(e.elapsed))),t.drawGeom(e,i)}return e.time<=t.duration},naji.animation.dropAnimation.prototype.getProperties=function(){var e=this._this||this,t=naji.animation.featureAnimationDefault.prototype.getProperties.call(this);return naji.util.njMapUtil.objectMerge(t,{side:e.side})}}(),function(){"use strict";naji.animation.lineDashMoveAnimation=function(e){var t,a=this,n=null;return this.reverse=null,this.currentOffset=null,(t=e||{}).animationType="lineDashMove",a.currentOffset=0,n=naji.animation.featureAnimationDefault.call(a,t),naji.util.njMapUtil.objectMerge(n,{_this:a,setReverse:a.setReverse})},naji.animation.lineDashMoveAnimation.prototype=Object.create(naji.animation.featureAnimationDefault.prototype),naji.animation.lineDashMoveAnimation.prototype.constructor=naji.animation.lineDashMoveAnimation,naji.animation.lineDashMoveAnimation.prototype.animate=function(e){var t=this._this||this;if(t.repeat<e.nowNB)return!0;var a=e.frameState.extent;return ol.extent.intersects(a,e.bbox)&&(e.time<=t.duration||t.moveLineDash(),t.customDrawGeom(e,e.geom)),e.time<=t.duration},naji.animation.lineDashMoveAnimation.prototype.customDrawGeom=function(e,t){var a=this._this||this;a.useFade?e.context.globalAlpha=ol.easing.easeIn(e.elapsed):e.context.globalAlpha=1;var n=e.vectorContext;e.frameState;n.setStyle(a.lineDashStyle()),n.drawGeometry(t)},naji.animation.lineDashMoveAnimation.prototype.lineDashStyle=function(){var e=this._this||this,t=e.strokeStyle;return t.getStroke().setLineDashOffset(e.currentOffset),t},naji.animation.lineDashMoveAnimation.prototype.moveLineDash=function(){var e=this._this||this;e.reverse?(e.currentOffset-=10,e.currentOffset<=-100&&(e.currentOffset=0)):(e.currentOffset+=10,100<=e.currentOffset&&(e.currentOffset=0))},naji.animation.lineDashMoveAnimation.prototype.setReverse=function(){var e=this._this||this;e.reverse=!e.reverse},naji.animation.lineDashMoveAnimation.prototype.getProperties=function(){var e=this._this||this,t=naji.animation.featureAnimationDefault.prototype.getProperties.call(this);return naji.util.njMapUtil.objectMerge(t,{reverse:e.reverse})}}(),function(){"use strict";naji.animation.lineGradientAnimation=function(e){var t,a=this,n=null;return this.lineWidth=null,this.startColor=null,this.endColor=null,this.useSymbol=null,this.symbolIcon=null,this.njMap=null,this.uGSUtil=null,this.dummyContext=null,this.symbolSRC=null,this.symbolAnchor=null,(t=e||{}).animationType="lineGradient",n=naji.animation.featureAnimationDefault.call(a,t),a.njMap=void 0!==t.njMap?t.njMap:void 0,a.uGSUtil=naji.util.njMapGeoSpatialUtil,a.dummyContext=document.createElement("canvas").getContext("2d"),naji.util.njMapUtil.objectMerge(n,{_this:a,setStyle:a.setStyle,setnjMap:a.setnjMap})},naji.animation.lineGradientAnimation.prototype=Object.create(naji.animation.featureAnimationDefault.prototype),naji.animation.lineGradientAnimation.prototype.constructor=naji.animation.lineGradientAnimation,naji.animation.lineGradientAnimation.prototype.animate=function(e){var t=this._this||this;if(t.repeat<e.nowNB)return!0;var a=e.frameState.extent;return ol.extent.intersects(a,e.bbox)&&(e.time,t.duration,t.customDrawGeom(e,e.geom)),e.time<=t.duration},naji.animation.lineGradientAnimation.prototype.customDrawGeom=function(e,t){var a=this._this||this;a.useFade?e.context.globalAlpha=ol.easing.easeIn(e.elapsed):e.context.globalAlpha=1;for(var n=e.vectorContext,i=(e.frameState,e.cs),o=e.lens,r=e.length*e.elapsed,s=[i[0]],l=1;l<i.length;l++){if(r<=(p=o[l]))break;s.push(i[l])}if(l<i.length){var p,c=(r=(p=o[l])-r)/(p-=o[l-1]),u=i[l-1][0],y=i[l-1][1],d=i[l][0],h=i[l][1],g=[d-(d-u)*c,h-(h-y)*c];s.push(g)}var M=new ol.geom.LineString(s);void 0!==M&&(n.setStyle(a._gradientStyle(new ol.Feature({geometry:M}))),n.drawGeometry(M)),a._createSymbol(n,M)},naji.animation.lineGradientAnimation.prototype.setStyle=function(e){var t=this._this||this,a=e||{};if(void 0!==a.lineWidth&&(t.lineWidth=a.lineWidth),void 0!==a.startColor&&(t.startColor=a.startColor),void 0!==a.endColor&&(t.endColor=a.endColor),void 0!==a.useSymbol&&(t.useSymbol=a.useSymbol),void 0!==a.symbolSRC){var n=new Image;n.src=a.symbolSRC,n.onload=function(){var e=new ol.style.Icon({img:n,rotation:0,rotateWithView:!0,imgSize:[this.width,this.height],anchor:a.symbolAnchor});t.symbolIcon=new ol.style.Style({image:e})}}t.style=new ol.style.Style({stroke:new ol.style.Stroke({color:t.startColor,width:t.lineWidth})})},naji.animation.lineGradientAnimation.prototype._gradientStyle=function(e){var t,a,n=this._this||this,i=e,o=i.getGeometry().getExtent(),r=i.getGeometry().getFirstCoordinate(),s=ol.extent.getCenter(o),l=n.uGSUtil.getDegreeBtwPoints(r,s);0<=l&&l<90||-90<l&&l<0?(t=ol.extent.getTopLeft(o),a=ol.extent.getTopRight(o)):90===l?(t=ol.extent.getBottomRight(o),a=ol.extent.getTopRight(o)):90<l&&l<180||180===l||-180<l&&l<-90?(t=ol.extent.getTopRight(o),a=ol.extent.getTopLeft(o)):-90===l&&(t=ol.extent.getTopRight(o),a=ol.extent.getBottomRight(o));var p=n.njMap.getMap().getPixelFromCoordinate(t),c=n.njMap.getMap().getPixelFromCoordinate(a),u=n.dummyContext.createLinearGradient(p[0],p[1],c[0],c[1]);u.addColorStop(0,n.startColor),u.addColorStop(1,n.endColor);var y=n.style;return y.getStroke().setColor(u),y},naji.animation.lineGradientAnimation.prototype._createSymbol=function(e,t){var a=this._this||this;if(e&&t){var n=t.getCoordinates(),i=n[n.length-2],o=n[n.length-1],r=new ol.geom.Point(o);if(void 0!==r){if(a.useSymbol&&a.symbolIcon){var s=a.uGSUtil.getRadianBtwPoints(i,o);a.symbolIcon.getImage().setRotation(-s),e.setStyle(a.symbolIcon)}e.drawGeometry(r)}}},naji.animation.lineGradientAnimation.prototype.getProperties=function(){this._this;var e=naji.animation.featureAnimationDefault.prototype.getProperties.call(this);return naji.util.njMapUtil.objectMerge(e,{})},naji.animation.lineGradientAnimation.prototype.setnjMap=function(e){(this._this||this).njMap=e}}(),function(){"use strict";naji.animation.showAnimation=function(e){var t,a=this,n=null;return(t=e||{}).animationType="show",n=naji.animation.featureAnimationDefault.call(a,t),naji.util.njMapUtil.objectMerge(n,{_this:a})},naji.animation.showAnimation.prototype=Object.create(naji.animation.featureAnimationDefault.prototype),naji.animation.showAnimation.prototype.constructor=naji.animation.showAnimation,naji.animation.showAnimation.prototype.animate=function(e){var t=this._this||this,a=e.frameState.extent;return ol.extent.intersects(a,e.bbox)&&t.drawGeom(e,e.geom),e.time<=t.duration},naji.animation.showAnimation.prototype.getProperties=function(){this._this;var e=naji.animation.featureAnimationDefault.prototype.getProperties.call(this);return naji.util.njMapUtil.objectMerge(e,{})}}(),function(){"use strict";naji.animation.teleportAnimation=function(e){var t,a=this,n=null;return(t=e||{}).animationType="teleport",n=naji.animation.featureAnimationDefault.call(a,t),naji.util.njMapUtil.objectMerge(n,{_this:a})},naji.animation.teleportAnimation.prototype=Object.create(naji.animation.featureAnimationDefault.prototype),naji.animation.teleportAnimation.prototype.constructor=naji.animation.teleportAnimation,naji.animation.teleportAnimation.prototype.animate=function(e){var t=this._this||this,a=t.easing(e.elapsed);if(a){e.context.save();var n=e.frameState.extent;if(ol.extent.intersects(n,e.bbox)){var i=e.frameState.pixelRatio;e.context.globalAlpha=a,e.context.scale(a,1/a);var o=e.frameState.coordinateToPixelTransform,r=(1/a-1)*i*(o[0]*e.coord[0]+o[1]*e.coord[1]+o[4]),s=(a-1)*i*(o[2]*e.coord[0]+o[3]*e.coord[1]+o[5]);e.context.translate(r,s),t.drawGeom(e,e.geom)}e.context.restore()}return e.time<=t.duration},naji.animation.teleportAnimation.prototype.getProperties=function(){this._this;var e=naji.animation.featureAnimationDefault.prototype.getProperties.call(this);return naji.util.njMapUtil.objectMerge(e,{})}}(),function(){"use strict";naji.animation.zoomInAnimation=function(e){var t,a=this,n=null;return(t=e||{}).animationType="zoomIn",n=naji.animation.featureAnimationDefault.call(a,t),naji.util.njMapUtil.objectMerge(n,{_this:a})},naji.animation.zoomInAnimation.prototype=Object.create(naji.animation.featureAnimationDefault.prototype),naji.animation.zoomInAnimation.prototype.constructor=naji.animation.zoomInAnimation,naji.animation.zoomInAnimation.prototype.animate=function(e){var t=this._this||this,a=t.easing(e.elapsed);if(a){for(var n,i=t.style,o=[],r=0;r<i.length;r++)(n=i[r].getImage())&&(o[r]=n.getScale(),n.setScale(o[r]*a));e.context.save();var s=e.frameState.extent;if(ol.extent.intersects(s,e.bbox)){var l=e.frameState.pixelRatio,p=e.frameState.coordinateToPixelTransform,c=(1/a-1)*l*(p[0]*e.coord[0]+p[1]*e.coord[1]+p[4]),u=(1/a-1)*l*(p[2]*e.coord[0]+p[3]*e.coord[1]+p[5]);e.context.scale(a,a),e.context.translate(c,u),t.drawGeom(e,e.geom)}e.context.restore();for(r=0;r<i.length;r++)(n=i[r].getImage())&&n.setScale(o[r])}return e.time<=t.duration},naji.animation.zoomInAnimation.prototype.getProperties=function(){this._this;var e=naji.animation.featureAnimationDefault.prototype.getProperties.call(this);return naji.util.njMapUtil.objectMerge(e,{})}}(),function(){"use strict";naji.animation.zoomOutAnimation=function(e){var t,a=this,n=null;return(t=e||{}).animationType="zoomOut",n=naji.animation.featureAnimationDefault.call(a,t),naji.util.njMapUtil.objectMerge(n,{_this:a})},naji.animation.zoomOutAnimation.prototype=Object.create(naji.animation.featureAnimationDefault.prototype),naji.animation.zoomOutAnimation.prototype.constructor=naji.animation.zoomOutAnimation,naji.animation.zoomOutAnimation.prototype.animate=function(e){var t=this._this||this,a=t.easing(e.elapsed);if(a){a=1/a;for(var n,i=t.style,o=[],r=0;r<i.length;r++)(n=i[r].getImage())&&(o[r]=n.getScale(),n.setScale(o[r]*a));e.context.save();var s=e.frameState.extent;if(ol.extent.intersects(s,e.bbox)){var l=e.frameState.pixelRatio,p=e.frameState.coordinateToPixelTransform,c=(1/a-1)*l*(p[0]*e.coord[0]+p[1]*e.coord[1]+p[4]),u=(1/a-1)*l*(p[2]*e.coord[0]+p[3]*e.coord[1]+p[5]);e.context.scale(a,a),e.context.translate(c,u),t.drawGeom(e,e.geom)}e.context.restore();for(r=0;r<i.length;r++)(n=i[r].getImage())&&n.setScale(o[r])}return e.time<=t.duration},naji.animation.zoomOutAnimation.prototype.getProperties=function(){this._this;var e=naji.animation.featureAnimationDefault.prototype.getProperties.call(this);return naji.util.njMapUtil.objectMerge(e,{})}}(),function(){"use strict";naji.animation.njMapShapeAnimationDefault=function(n){var l=this;return this.sync=null,this.njMap=null,this.features=null,this.originCRS=null,this.list_animation=null,this.isStop=null,this.vectorLayer=null,this.animationType=null,this.transFormFeatures=null,this.list_PostcomposeKey=null,function(){var e=n||{};if(l.sync="boolean"!=typeof e.sync||e.sync,l.njMap=void 0!==e.njMap?e.njMap:void 0,l.features=void 0!==e.features?e.features:[],l.originCRS=void 0!==e.originCRS?e.originCRS:"EPSG:4326",l.list_animation=Array.isArray(e.animations)?e.animations:[],l.animationType="string"==typeof e.animationType?e.animationType:void 0,!l.njMap)return naji.njMapConfig.alert_Error("njMap undefined");l.isStop=!1,l.transFormFeatures=l.features,l.vectorLayer=new ol.layer.Vector({source:new ol.source.Vector}),l.vectorLayer.isStop=l.isStop,l.vectorLayer.animations=l.list_animation,l.njMap.getMap().addLayer(l.vectorLayer),l.list_PostcomposeKey=[];var t=ol.proj.get(l.originCRS),a=l.njMap.getMap().getView().getProjection();l._transformProjection(t,a),l.njMap.getMap().on("change:view",function(e){var t=e.oldValue,a=e.target.getView(),n=t.getProjection(),i=a.getProjection();if(!ol.proj.equivalent(n,i)){for(var o=l.list_PostcomposeKey,r=0;r<o.length;r++){var s=o[r];ol.Observable.unByKey(s)}l._transformProjection(n,i),l.init()}})}(),{stop:l.stop,start:l.start,destroy:l.destroy,getLayer:l.getLayer,getProperties:l.getProperties}},naji.animation.njMapShapeAnimationDefault.prototype.init=function(){var p=this._this||this;!function(){for(var e=p.transFormFeatures,t=0;t<e.length;t++){var a=e[t];if(a instanceof ol.Feature){var n=a.getGeometry();if(n instanceof ol.geom.Point||n instanceof ol.geom.LineString||n instanceof ol.geom.Polygon)l(a);else if(n instanceof ol.geom.MultiPoint)for(var i=n.getPoints(),o=0;o<i.length;o++)l(new ol.Feature({geometry:i[o]}));else if(n instanceof ol.geom.MultiLineString){var r=n.getLineStrings();for(o=0;o<r.length;o++)l(new ol.Feature({geometry:r[o]}))}else if(n instanceof ol.geom.MultiPolygon){var s=n.getPolygons();for(o=0;o<s.length;o++)l(new ol.Feature({geometry:s[o]}))}}}function l(e){var t={vectorContext:null,frameState:null,start:0,time:0,elapsed:0,extent:!1,feature:e,geom:e.getGeometry(),typeGeom:e.getGeometry().getType(),bbox:e.getGeometry().getExtent(),coord:ol.extent.getCenter(e.getGeometry().getExtent()),nowNB:0,interval:p.sync?0:Math.floor(1001*Math.random()+500)},a=p.vectorLayer.animateFeature(t);p.list_PostcomposeKey.push(a)}}()},naji.animation.njMapShapeAnimationDefault.prototype._transformProjection=function(e,t){var a=this._this||this;if(!ol.proj.equivalent(e,t)){a.transFormFeatures=[];var n,i,o=a.features.slice();for(n=0,i=o.length;n<i;++n){var r=o[n].clone().getGeometry();r&&a.transFormFeatures.push(new ol.Feature({geometry:r.transform(a.originCRS,t)}))}}},naji.animation.njMapShapeAnimationDefault.prototype.setStyles=function(e){var t=(this._this||this).list_animation;for(var a in t)t[a].setStyle(e)},naji.animation.njMapShapeAnimationDefault.prototype.setStrokeStyle=function(e){var t=(this._this||this).list_animation;for(var a in t)t[a].setStrokeStyle(e)},naji.animation.njMapShapeAnimationDefault.prototype.start=function(){(this._this||this).vectorLayer.isStop=!1},naji.animation.njMapShapeAnimationDefault.prototype.stop=function(){(this._this||this).vectorLayer.isStop=!0},naji.animation.njMapShapeAnimationDefault.prototype.destroy=function(){for(var e=this._this||this,t=e.list_PostcomposeKey,a=0;a<t.length;a++){var n=t[a];ol.Observable.unByKey(n)}e.features=[],e.transFormFeatures=[],e.njMap.getMap().removeLayer(e.vectorLayer)},naji.animation.njMapShapeAnimationDefault.prototype.getProperties=function(){var e=this._this||this,t=[],a=e.list_animation;for(var n in a)t.push(a[n].getProperties());return{animProperties:t,animationType:e.animationType}},naji.animation.njMapShapeAnimationDefault.prototype.getLayer=function(){return(this._this||this).vectorLayer}}(),function(){"use strict";naji.animation.njMapCircleAnimation=function(e){var t,a=this,n=null;return(t=e||{}).animationType="njMapCircleAnimation",n=naji.animation.njMapShapeAnimationDefault.call(a,t),a.init(),a.setStyle(t.style),naji.util.njMapUtil.objectMerge(n,{_this:a,setStyle:a.setStyle})},naji.animation.njMapCircleAnimation.prototype=Object.create(naji.animation.njMapShapeAnimationDefault.prototype),naji.animation.njMapCircleAnimation.prototype.constructor=naji.animation.njMapCircleAnimation,naji.animation.njMapCircleAnimation.prototype.setStyle=function(e){var t=this._this||this,a=[new ol.style.Style({image:e})];t.setStyles(a)}}(),function(){"use strict";naji.animation.njMapLineAnimation=function(e){var t,a=this,n=null;return(t=e||{}).animationType="njMapLineAnimation",n=naji.animation.njMapShapeAnimationDefault.call(a,t),a.init(),a.setStyle(t.style),naji.util.njMapUtil.objectMerge(n,{_this:a,setStyle:a.setStyle})},naji.animation.njMapLineAnimation.prototype=Object.create(naji.animation.njMapShapeAnimationDefault.prototype),naji.animation.njMapLineAnimation.prototype.constructor=naji.animation.njMapLineAnimation,naji.animation.njMapLineAnimation.prototype.setStyle=function(e){var t=this._this||this,a=e,n=[new ol.style.Style({stroke:new ol.style.Stroke({color:[0,0,0,0],width:0})}),new ol.style.Style({image:new ol.style.RegularShape({}),stroke:a})];t.setStrokeStyle(a),t.setStyles(n)}}(),function(){"use strict";naji.animation.njMapLineGradientAnimation=function(n){var l=this;return this.sync=null,this.njMap=null,this.features=null,this.originCRS=null,this.list_animation=null,this.isStop=null,this.vectorLayer=null,this.animationType=null,this.transFormFeatures=null,this.uGSUtil=null,this.dummyContext=null,this.list_PostcomposeKey=null,this.lineWidth=null,this.startColor=null,this.endColor=null,this.useSymbol=null,this.symbolIcon=null,function(){var e=n||{};if(l.sync=void 0===e.sync||e.sync,l.njMap=void 0!==e.njMap?e.njMap:void 0,l.features=void 0!==e.features?e.features:[],l.originCRS=void 0!==e.originCRS?e.originCRS:"EPSG:4326",l.list_animation=Array.isArray(e.animations)?e.animations:[],l.animationType="njMapLineGradientAnimation",!l.njMap)return naji.njMapConfig.alert_Error("njMap undefined");l.isStop=!1,l.transFormFeatures=l.features,l.vectorLayer=new ol.layer.Vector({source:new ol.source.Vector}),l.vectorLayer.isStop=l.isStop,l.vectorLayer.animations=l.list_animation,l.njMap.getMap().addLayer(l.vectorLayer),l.list_PostcomposeKey=[],l.uGSUtil=naji.util.njMapGeoSpatialUtil,l.dummyContext=document.createElement("canvas").getContext("2d"),l.lineWidth=2,l.startColor="white",l.endColor="black",l.useSymbol=!1;var t=ol.proj.get(l.originCRS),a=l.njMap.getMap().getView().getProjection();l._transformProjection(t,a),l._init(),l.setStyle(e.style),l.setnjMap(l.njMap),l.njMap.getMap().on("change:view",function(e){var t=e.oldValue,a=e.target.getView(),n=t.getProjection(),i=a.getProjection();if(!ol.proj.equivalent(n,i)){for(var o=l.list_PostcomposeKey,r=0;r<o.length;r++){var s=o[r];ol.Observable.unByKey(s)}l._transformProjection(n,i),l._init()}})}(),{_this:l,start:l.start,stop:l.stop,destroy:l.destroy,setStyle:l.setStyle,getLayer:l.getLayer,getProperties:l.getProperties}},naji.animation.njMapLineGradientAnimation.prototype._transformProjection=function(e,t){var a=this._this||this;if(!ol.proj.equivalent(e,t)){a.transFormFeatures=[];var n,i,o=a.features.slice();for(n=0,i=o.length;n<i;++n){var r=o[n].clone().getGeometry();r&&a.transFormFeatures.push(new ol.Feature({geometry:r.transform(a.originCRS,t)}))}}},naji.animation.njMapLineGradientAnimation.prototype._init=function(){var s=this._this||this;!function(){for(var e=s.transFormFeatures,t=0;t<e.length;t++){var a=e[t];if(a instanceof ol.Feature){var n=a.getGeometry();if(n instanceof ol.geom.LineString)r(a);else if(n instanceof ol.geom.MultiLineString)for(var i=n.getLineStrings(),o=0;o<i.length;o++)r(new ol.Feature({geometry:i[o]}))}}function r(e){var t={vectorContext:null,frameState:null,start:0,time:0,elapsed:0,extent:!1,feature:e,geom:e.getGeometry(),typeGeom:e.getGeometry().getType(),bbox:e.getGeometry().getExtent(),coord:ol.extent.getCenter(e.getGeometry().getExtent()),nowNB:0,interval:s.sync?0:Math.floor(1001*Math.random()+500)},a=e.getGeometry().getLength(),n=e.getGeometry().getCoordinates(),i=new Array(n.length);i[0]=0;for(var o=1;o<n.length;o++)i[o]=i[o-1]+s.uGSUtil.getDistanceBtwPotins(n[o],n[o-1]);t.length=a,t.cs=n,t.lens=i;var r=s.vectorLayer.animateFeature(t);s.list_PostcomposeKey.push(r)}}()},naji.animation.njMapLineGradientAnimation.prototype.setStyle=function(e){var t=(this._this||this).list_animation;for(var a in t)t[a].setStyle(e)},naji.animation.njMapLineGradientAnimation.prototype.setnjMap=function(e){var t=(this._this||this).list_animation;for(var a in t)t[a].setnjMap(e)},naji.animation.njMapLineGradientAnimation.prototype.start=function(){(this._this||this).vectorLayer.isStop=!1},naji.animation.njMapLineGradientAnimation.prototype.stop=function(){(this._this||this).vectorLayer.isStop=!0},naji.animation.njMapLineGradientAnimation.prototype.destroy=function(){for(var e=this._this||this,t=e.list_PostcomposeKey,a=0;a<t.length;a++){var n=t[a];ol.Observable.unByKey(n)}e.features=null,e.transFormFeatures=null,e.njMap.getMap().removeLayer(e.vectorLayer)},naji.animation.njMapLineGradientAnimation.prototype.getProperties=function(){var e=this._this||this,t=[],a=e.list_animation;for(var n in a)t.push(a[n].getProperties());return{animationType:e.animationType,animProperties:t}},naji.animation.njMapLineGradientAnimation.prototype.getLayer=function(){return(this._this||this).vectorLayer}}(),function(){"use strict";naji.animation.njMapPolygonAnimation=function(e){var t,a=this,n=null;return(t=e||{}).animationType="njMapPolygonAnimation",n=naji.animation.njMapShapeAnimationDefault.call(a,t),a.init(),a.setStyle(t.style),naji.util.njMapUtil.objectMerge(n,{_this:a,setStyle:a.setStyle})},naji.animation.njMapPolygonAnimation.prototype=Object.create(naji.animation.njMapShapeAnimationDefault.prototype),naji.animation.njMapPolygonAnimation.prototype.constructor=naji.animation.njMapPolygonAnimation,naji.animation.njMapPolygonAnimation.prototype.setStyle=function(e){var t=this._this||this,a=e,n=[new ol.style.Style({stroke:new ol.style.Stroke({color:[0,0,0,0],width:0}),fill:new ol.style.Fill({color:[0,0,0,0]})}),new ol.style.Style({image:new ol.style.RegularShape({}),stroke:a.getStroke(),fill:a.getFill()})];t.setStyles(n)}}(),function(){"use strict";naji.animation.njMapRegularShapeAnimation=function(e){var t,a=this,n=null;return(t=e||{}).animationType="njMapRegularShapeAnimation",n=naji.animation.njMapShapeAnimationDefault.call(a,t),a.init(),a.setStyle(t.style),naji.util.njMapUtil.objectMerge(n,{_this:a,setStyle:a.setStyle})},naji.animation.njMapRegularShapeAnimation.prototype=Object.create(naji.animation.njMapShapeAnimationDefault.prototype),naji.animation.njMapRegularShapeAnimation.prototype.constructor=naji.animation.njMapRegularShapeAnimation,naji.animation.njMapRegularShapeAnimation.prototype.setStyle=function(e){var t=this._this||this,a=e,n=[new ol.style.Style({image:a})];t.setStyles(n)}}(),function(){"use strict";naji.control.njMapControlDefault=function(a){var n=this;return this.njMap=null,this.useDragPan=null,this.cursorCssName=null,this.activeChangeListener=null,this.controlKey=null,this.interaction=null,this.compatibleDragPan=null,this.key_activeChangeListener=null,function(){var e=a||{};if(n.njMap=void 0!==e.njMap?e.njMap:void 0,n.useDragPan="boolean"==typeof e.useDragPan&&e.useDragPan,n.cursorCssName=void 0!==e.cursorCssName?e.cursorCssName:void 0,n.activeChangeListener="function"==typeof e.activeChangeListener?e.activeChangeListener:void 0,n.controlKey=naji.util.njMapUtil.generateUUID(),n.target=void 0!==e.target?e.target:void 0,void 0!==e.elementId){var t=document.createElement("div");t.id=a.elementId,t.title=a.title,t.eventType=a.type,n.element=t}if(!n.njMap)naji.njMapConfig.alert_Error("njMap undefined")}(),{destroy:n.destroy,getElement:n.getElement,setActive:n.setActive,getActive:n.getActive,getControlKey:n.getControlKey,getInteraction:n.getInteraction,setActiveChangeListener:n.setActiveChangeListener}},naji.control.njMapControlDefault.prototype._init=function(){for(var e=this._this||this,t=e.njMap.getMap(),a=t.getInteractions().getArray(),n=a.length-1;0<=n;n--)a[n]instanceof ol.interaction.DragPan&&(a[n].get("njMapDragPan")||t.removeInteraction(a[n]));e.setActiveChangeListener(e.activeChangeListener),t.addInteraction(e.interaction)},naji.control.njMapControlDefault.prototype.getControlKey=function(){return(this._this||this).controlKey},naji.control.njMapControlDefault.prototype.getInteraction=function(){return(this._this||this).interaction},naji.control.njMapControlDefault.prototype.getElement=function(){return(this._this||this).element},naji.control.njMapControlDefault.prototype.getActive=function(){return(this._this||this).interaction.getActive()},naji.control.njMapControlDefault.prototype.setActive=function(e){var t=this._this||this;if(t.interaction.getActive()&&!0===e)return!1;for(var a=t.njMap.getMap().getViewport(),n=a.classList,i=0;i<n.length;i++){var o=n[i];0===o.indexOf("cursor")&&a.classList.remove(o)}e?(a.classList.add(t.cursorCssName),t.useDragPan&&(t.compatibleDragPan?t.compatibleDragPan.setActive(!0):(t.compatibleDragPan=new ol.interaction.DragPan({kinetic:!1}),t.compatibleDragPan.set("njMapDragPan",!0),t.njMap.getMap().addInteraction(t.compatibleDragPan)))):(a.classList.add("cursor-default"),t.compatibleDragPan&&t.compatibleDragPan.setActive(!1)),t.interaction.setActive(e)},naji.control.njMapControlDefault.prototype.setActiveChangeListener=function(e){var t=this._this||this;t.interaction&&"function"==typeof e&&(ol.Observable.unByKey(t.key_activeChangeListener),t.activeChangeListener=e,t.key_activeChangeListener=t.interaction.on("change:active",function(e){t.activeChangeListener.call(this,e.target.getActive())}))},naji.control.njMapControlDefault.prototype._setElement=function(e){var t=this._this||this,a=document.createElement("div");a.id=e.elementId,a.title=e.title,t.element=a},naji.control.njMapControlDefault.prototype.destroy=function(){var e=this._this||this;e.setActive(!1),e.njMap.getMap().removeInteraction(e.interaction)}}(),function(){"use strict";naji.control.njMapDrawFeature=function(e){var t,a,n=this;return this.flag=!1,this.useModify=null,this.useSnap=null,this.freehand=null,this.drawType=null,this.featureStyle=null,this.drawingStyle=null,this.useDrawEndDisplay=null,this.vectorLayer=null,this.snapInteraction=null,this.modifyInteraction=null,this.selectInteraction=null,this.selectFeatures=null,this.textOverlay=null,a=e||{},t=naji.control.njMapControlDefault.call(n,a),n.useModify=void 0!==a.useModify&&a.useModify,n.useSnap=void 0!==a.useSnap&&a.useSnap,n.freehand=void 0!==a.freehand&&a.freehand,n.featureStyle=void 0!==a.featureStyle?a.featureStyle:void 0,n.drawingStyle=void 0!==a.drawingStyle?a.drawingStyle:n.featureStyle,n.drawType=void 0!==a.drawType?a.drawType:"LineString",n.useDrawEndDisplay=void 0===a.useDrawEndDisplay||a.useDrawEndDisplay,a.noneInit||n._init(),naji.util.njMapUtil.objectMerge(t,{_this:n,clear:n.clear,getLayer:n.getLayer,getFeatures:n.getFeatures,removeFeature:n.removeFeature})},naji.control.njMapDrawFeature.prototype=Object.create(naji.control.njMapControlDefault.prototype),naji.control.njMapDrawFeature.prototype.constructor=naji.control.njMapDrawFeature,naji.control.njMapDrawFeature.prototype._init=function(){var e,t,o=this._this||this,a=new ol.source.Vector({wrapX:!1});switch(o.vectorLayer=new ol.layer.Vector({zIndex:9999,source:a,style:o.featureStyle}),o.njMap.getMap().addLayer(o.vectorLayer),o.drawType){case"Point":e="Point",t=null;break;case"LineString":e="LineString",t=null;break;case"Polygon":e="Polygon",t=null;break;case"Circle":e="Circle",t=null;break;case"Box":e="Circle",t=ol.interaction.Draw.createBox();break;case"Text":e="Point",t=null;break;default:e="Polygon",t=null}o.interaction=new ol.interaction.Draw({type:e,source:a,freehand:o.freehand,style:o.drawingStyle,geometryFunction:t}),o.interaction.setActive(!1),o.useDrawEndDisplay||o.interaction.on("drawend",function(e){setTimeout(function(){o.clear()},1)},this),"Text"===o.drawType&&o.interaction.on("drawend",function(e){null!=o.textOverlay&&o.njMap.getMap().removeOverlay(o.textOverlay),o.vectorLayer.getSource().once("addfeature",function(e){o.removeFeature(e.feature)});var t=document.createElement("div");t.className="tooltip";var a=document.createElement("textarea");a.id="textareaElement",a.style="color: black; font-size: 12px";var n=document.createElement("button");n.title="save",n.style="color: green",n.className="tooltip-save",n.innerHTML='<i class="fa fa-check-circle-o" />',n.onclick=function(){return o.njMap.getMap().removeOverlay(o.textOverlay),e.feature.setStyle(new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.4)"}),stroke:new ol.style.Stroke({color:"#3399CC",width:1.25}),text:new ol.style.Text({font:"15px Calibri,sans-serif",fill:new ol.style.Fill({color:"#000"}),stroke:new ol.style.Stroke({color:"#fff",width:2}),text:a.value})})),o.vectorLayer.getSource().addFeature(e.feature),n.blur(),!1};var i=document.createElement("button");i.title="cancel",i.style="color: red",i.className="tooltip-cancel",i.innerHTML='<i class="fa fa-ban" />',i.onclick=function(){return o.njMap.getMap().removeOverlay(o.textOverlay),i.blur(),!1},t.appendChild(a),t.appendChild(document.createElement("br")),t.appendChild(n),t.appendChild(i),o.textOverlay=new ol.Overlay({element:t,offset:[0,0],positioning:"bottom-center"}),o.textOverlay.setPosition(e.feature.getGeometry().getLastCoordinate()),o.njMap.getMap().addOverlay(o.textOverlay)}),naji.control.njMapControlDefault.prototype._init.call(this),o.useSnap&&(o.snapInteraction=new ol.interaction.Snap({source:a}),o.njMap.getMap().addInteraction(o.snapInteraction)),o.useModify&&(o.interaction.on("drawstart",function(e){o.flag=!0,console.log("DRAW___START")}),o.interaction.on("drawend",function(e){o.flag=!1,e.feature.setId(naji.util.njMapUtil.generateUUID()),console.log("DRAW___END"),o.selectInteraction=new ol.interaction.Select({layers:function(e){return e==o.vectorLayer},condition:ol.events.condition.singleClick,wrapX:!1}),o.njMap.getMap().addInteraction(o.selectInteraction),o.selectInteraction.on("select",function(e){e.selected[0]?o.interaction.setActive(!1):o.interaction.setActive(!0)}),o.modifyInteraction=new ol.interaction.Modify({features:o.selectInteraction.getFeatures()}),o.njMap.getMap().addInteraction(o.modifyInteraction)}))},naji.control.njMapDrawFeature.prototype.setActive=function(e){var t=this._this||this;naji.control.njMapControlDefault.prototype.setActive.call(this,e),"Text"===t.drawType&&null!=t.textOverlay&&t.njMap.getMap().removeOverlay(t.textOverlay)},naji.control.njMapDrawFeature.prototype.getLayer=function(){return(this._this||this).vectorLayer},naji.control.njMapDrawFeature.prototype.getFeatures=function(){return(this._this||this).vectorLayer.getSource().getFeatures()},naji.control.njMapDrawFeature.prototype.clear=function(){(this._this||this).vectorLayer.getSource().clear()},naji.control.njMapDrawFeature.prototype.removeFeature=function(e){(this._this||this).vectorLayer.getSource().removeFeature(e)},naji.control.njMapDrawFeature.prototype.destroy=function(e){var t=this._this||this;naji.control.njMapControlDefault.prototype.destroy.call(this),t.njMap.getMap().removeInteraction(t.snapInteraction),e&&t.njMap.getMap().removeLayer(t.vectorLayer)}}(),function(){"use strict";naji.control.njMapMeasureDefault=function(e){var t,a=this,n=null;return this.sketch=null,this.overlays=null,this.destroyed=null,this.helpTooltip=null,this.continueMsg=null,this.measureTooltip=null,this.helpTooltipElement=null,this.measureTooltipElement=null,this.pointerMoveListener=null,this.sketchChangeListener=null,(t=e||{}).noneInit=!0,n=naji.control.njMapDrawFeature.call(a,t),naji.util.njMapUtil.objectMerge(n,{_this:a,clear:a.clear,destroy:a.destroy,getOverlay:a.getOverlay,setActive:a.setActive})},naji.control.njMapMeasureDefault.prototype=Object.create(naji.control.njMapDrawFeature.prototype),naji.control.njMapMeasureDefault.prototype.constructor=naji.control.njMapMeasureDefault,naji.control.njMapMeasureDefault.prototype._init=function(){var e=this._this||this;naji.control.njMapDrawFeature.prototype._init.call(this),e.overlays=[],e.destroyed=!1},naji.control.njMapMeasureDefault.prototype.createHelpTooltip=function(){var e=this._this||this;e.helpTooltip&&e.njMap.getMap().removeOverlay(e.helpTooltip),e.helpTooltipElement=document.createElement("div"),e.helpTooltipElement.className="tooltip hidden",e.helpTooltip=new ol.Overlay({element:e.helpTooltipElement,offset:[25,12],positioning:"center-left"}),e.njMap.getMap().addOverlay(e.helpTooltip)},naji.control.njMapMeasureDefault.prototype.createMeasureTooltip=function(){var e=this._this||this;e.measureTooltipElement=document.createElement("div"),e.measureTooltipElement.className="tooltip tooltip-measure",e.measureTooltip=new ol.Overlay({element:e.measureTooltipElement,offset:[0,-15],positioning:"bottom-center"}),e.overlays.push(e.measureTooltip),e.njMap.getMap().addOverlay(e.measureTooltip)},naji.control.njMapMeasureDefault.prototype.setActive=function(e){var a=this._this||this;if(a.destroyed)return!1;if(a.interaction.getActive()===e)return!1;naji.control.njMapDrawFeature.prototype.setActive.call(this,e),ol.Observable.unByKey(a.pointerMoveListener),e?(a.createHelpTooltip(),a.createMeasureTooltip(),a.pointerMoveListener=a.njMap.getMap().on("pointermove",function(e){if(e.dragging)return;var t="측정 시작할 위치 선택";a.sketch&&(t=a.continueMsg);a.helpTooltipElement.innerHTML=t,a.helpTooltip.setPosition(e.coordinate),a.helpTooltipElement.classList.remove("hidden")})):(a.helpTooltipElement&&a.helpTooltipElement.parentNode.removeChild(a.helpTooltipElement),a.measureTooltipElement&&a.measureTooltipElement.parentNode.removeChild(a.measureTooltipElement))},naji.control.njMapMeasureDefault.prototype.clear=function(){var e=this._this||this;for(var t in naji.control.njMapDrawFeature.prototype.clear.call(this),e.overlays)e.njMap.getMap().removeOverlay(e.overlays[t])},naji.control.njMapMeasureDefault.prototype.destroy=function(){var e=this._this||this;e.clear(),e.setActive(!1),e.destroyed=!0,e.njMap.getMap().removeOverlay(e.helpTooltip),ol.Observable.unByKey(e.pointerMoveListener),naji.control.njMapDrawFeature.prototype.destroy.call(this,!0)},naji.control.njMapMeasureDefault.prototype.getOverlay=function(e){var t=this._this||this,a=null;for(var n in t.overlays){if(null!=a)break;t.overlays[n].id==e&&(a=t.overlays[n])}return a},naji.control.njMapMeasureDefault.prototype.removeOverlay=function(e){var t=this._this||this,a=[];for(var n in t.overlays)t.overlays[n].id!=e?a.push(t.overlays[n]):t.njMap.getMap().removeOverlay(t.overlays[n]);t.overlays=a},naji.control.njMapMeasureDefault.prototype.removeFeature=function(e){this._this;naji.control.njMapDrawFeature.prototype.removeFeature.call(this,e)}}(),function(){"use strict";naji.control.njMapAreaMeasure=function(e){var t,a,n=this;return(a=e||{}).drawType="Polygon",a.useDrawEndDisplay=!0,a.featureStyle=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:3}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})}),a.drawingStyle=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2})}),t=naji.control.njMapMeasureDefault.call(n,a),n._init(),naji.util.njMapUtil.objectMerge(t,{_this:n})},naji.control.njMapAreaMeasure.prototype=Object.create(naji.control.njMapMeasureDefault.prototype),naji.control.njMapAreaMeasure.prototype.constructor=naji.control.njMapAreaMeasure,naji.control.njMapAreaMeasure.prototype._init=function(){var r=this._this||this;naji.control.njMapMeasureDefault.prototype._init.call(this),r.continueMsg="면적 측정",r.interaction.on("drawstart",function(e){r.sketch=e.feature;var n=e.coordinate;r.sketchChangeListener=r.sketch.getGeometry().on("change",function(e){var t=e.target,a=r._formatArea(t);n=t.getInteriorPoint().getCoordinates(),r.measureTooltipElement.innerHTML=a,r.measureTooltip.setPosition(n)})},this),r.interaction.on("drawend",function(e){var t=r.measureTooltip;r.measureTooltipElement.className="tooltip tooltip-static",r.measureTooltip.setOffset([0,-7]);var a=document.createElement("a");a.href="#",a.className="tooltip-closer",a.onclick=function(){return r.njMap.getMap().removeOverlay(t),r.removeFeature(e.feature),a.blur(),!1},r.measureTooltip.id=e.feature.getId(),r.measureTooltipElement.appendChild(a),r.sketch=null,r.measureTooltipElement=null,r.createMeasureTooltip(),ol.Observable.unByKey(r.sketchChangeListener),r.useModify&&(r.selectInteraction.on("select",function(e){if(e.selected[0]){e.selected[0].setStyle(r.drawingStyle),r.njMap.getMap().removeOverlay(r.removeOverlay(e.selected[0].getId())),r.continueMsg="면적 측정",r.setActive(!0);var t=e.selected[0].getGeometry(),a=r._formatArea(t),n=t.getInteriorPoint().getCoordinates();r.sketch=e.selected[0],r.measureTooltip.id=e.selected[0].getId(),r.measureTooltipElement.innerHTML=a,r.measureTooltip.setPosition(n)}if(e.deselected[0]){e.deselected[0].setStyle(r.featureStyle);var i=r.measureTooltip;r.measureTooltipElement.className="tooltip tooltip-static",r.measureTooltip.id=e.deselected[0].getId(),r.measureTooltip.setOffset([0,-7]);var o=document.createElement("a");o.href="#",o.className="tooltip-closer",o.onclick=function(){return r.njMap.getMap().removeOverlay(i),r.removeFeature(e.deselected[0]),o.blur(),!1},r.measureTooltipElement.appendChild(o),r.sketch=null,r.measureTooltipElement=null,r.createMeasureTooltip(),ol.Observable.unByKey(r.sketchChangeListener),r.interaction.setActive(!1),r.interaction.setActive(!0)}}),r.modifyInteraction.on("modifystart",function(e){r.sketch=e.features.getArray()[0],r.measureTooltip.id=r.sketch.getId();var n=e.coordinate;r.sketchChangeListener=r.sketch.getGeometry().on("change",function(e){var t=e.target,a=r._formatArea(t);n=t.getInteriorPoint().getCoordinates(),r.measureTooltip&&r.measureTooltipElement&&(r.measureTooltipElement.innerHTML=a,r.measureTooltip.setPosition(n))})}),r.modifyInteraction.on("modifyend",function(e){r.measureTooltip;r.measureTooltipElement.className="tooltip tooltip-measure",r.measureTooltip.id=e.features.getArray()[0].getId(),r.measureTooltip.setOffset([0,-7])}))},this)},naji.control.njMapAreaMeasure.prototype._formatArea=function(e){var t=this._this||this,a=ol.Sphere.getArea(e,{projection:t.njMap.getCRS()});return 1e4<a?Math.round(a/1e6*100)/100+" km<sup>2</sup>":Math.round(100*a)/100+" m<sup>2</sup>"}}(),function(){"use strict";naji.control.njMapCapture=function(e){var t,a,n=this;return a=e||{},t=naji.control.njMapControlDefault.call(n,a),n._init(),naji.util.njMapUtil.objectMerge(t,{_this:n,setActive:n.setActive})},naji.control.njMapCapture.prototype=Object.create(naji.control.njMapControlDefault.prototype),naji.control.njMapCapture.prototype.constructor=naji.control.njMapCapture,naji.control.njMapCapture.prototype._init=function(){var e=this._this||this;e.interaction=new ol.interaction.DragPan({kinetic:!1}),e.interaction.set("njMapCapture",!1),e.interaction.setActive(!1),naji.control.njMapControlDefault.prototype._init.call(this)},naji.control.njMapCapture.prototype.setActive=function(e){this._this;document.getElementsByClassName("ol-overlaycontainer-stopevent")[0].style.display="none",document.getElementById("toolbar").style.display="none",html2canvas(document.getElementsByClassName("mapMainDIV")[0],{useCORS:!0,logging:!1,proxy:naji.njMapConfig.getProxy()}).then(function(e){navigator.msSaveBlob?navigator.msSaveBlob(e.msToBlob(),"map.png"):e.toBlob(function(e){saveAs(e,"map.png")}),document.getElementsByClassName("ol-overlaycontainer-stopevent")[0].style.display="",document.getElementById("toolbar").style.display=""})}}(),function(){"use strict";naji.control.njMapCircleMeasure=function(e){var t,a,n=this;return(a=e||{}).drawType="Circle",a.useDrawEndDisplay=!0,a.featureStyle=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:3}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})}),a.drawingStyle=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2})}),t=naji.control.njMapMeasureDefault.call(n,a),n._init(),naji.util.njMapUtil.objectMerge(t,{_this:n})},naji.control.njMapCircleMeasure.prototype=Object.create(naji.control.njMapMeasureDefault.prototype),naji.control.njMapCircleMeasure.prototype.constructor=naji.control.njMapCircleMeasure,naji.control.njMapCircleMeasure.prototype._init=function(){var n=this._this||this;naji.control.njMapMeasureDefault.prototype._init.call(this),n.continueMsg="원 면적 측정",n.interaction.on("drawstart",function(e){n.sketch=e.feature;var t=e.feature.getGeometry().getCenter();n.measureTooltip.setPosition(t),n.sketchChangeListener=n.sketch.getGeometry().on("change",function(e){var t=e.target,a=n._formatArea(t);n.measureTooltipElement.innerHTML=a})},this),n.interaction.on("drawend",function(e){var t=n.measureTooltip;n.measureTooltipElement.className="tooltip tooltip-static",n.measureTooltip.setOffset([0,-7]);var a=document.createElement("a");a.href="#",a.className="tooltip-closer",a.onclick=function(){return n.njMap.getMap().removeOverlay(t),n.removeFeature(e.feature),a.blur(),!1},n.measureTooltipElement.appendChild(a),n.sketch=null,n.measureTooltipElement=null,n.createMeasureTooltip(),ol.Observable.unByKey(n.sketchChangeListener)},this)},naji.control.njMapCircleMeasure.prototype._formatArea=function(e){var t=(this._this||this).njMap.getCRS(),a=ol.proj.transform(e.getFirstCoordinate(),t,"EPSG:4326"),n=ol.proj.transform(e.getLastCoordinate(),t,"EPSG:4326"),i=new ol.Sphere(6378137).haversineDistance(a,n),o=i*i*Math.PI;return 1e4<o?Math.round(o/1e6*100)/100+" km<sup>2</sup>":Math.round(100*o)/100+" m<sup>2</sup>"}}(),function(){"use strict";naji.control.njMapDragPan=function(e){var t,a,n=this;return this.key_pointerup=null,this.key_pointerdrag=null,a=e||{},t=naji.control.njMapControlDefault.call(n,a),n._init(),"boolean"==typeof a.active&&n.setActive(a.active),naji.util.njMapUtil.objectMerge(t,{_this:n})},naji.control.njMapDragPan.prototype=Object.create(naji.control.njMapControlDefault.prototype),naji.control.njMapDragPan.prototype.constructor=naji.control.njMapDragPan,naji.control.njMapDragPan.prototype._init=function(){var e=this._this||this;e.njMap.getMap();e.interaction=new ol.interaction.DragPan({kinetic:!1}),e.interaction.set("njMapDragPan",!0),e.interaction.setActive(!1),naji.control.njMapControlDefault.prototype._init.call(this)},naji.control.njMapDragPan.prototype.setActive=function(e){var t=this._this||this;if(t.interaction.getActive()&&!0===e)return!1;if(naji.control.njMapControlDefault.prototype.setActive.call(this,e),e){var a=t.njMap.getMap(),n=a.getViewport(),i=a.getView().getCenter();t.key_pointerdrag=a.on("pointerdrag",function(e){var t=e.frameState.viewState.center;i[0]===t[0]&&i[1]===t[1]||(n.classList.remove("cursor-default"),n.classList.add("cursor-closeHand"))}),t.key_pointerup=a.on("pointerup",function(e){n.classList.remove("cursor-closeHand"),n.classList.add("cursor-default")})}else ol.Observable.unByKey(t.key_pointerup),ol.Observable.unByKey(t.key_pointerdrag)}}(),function(){"use strict";naji.control.njMapDragZoomIn=function(e){var t,a,n=this;return a=e||{},t=naji.control.njMapControlDefault.call(n,a),n._init(),naji.util.njMapUtil.objectMerge(t,{_this:n})},naji.control.njMapDragZoomIn.prototype=Object.create(naji.control.njMapControlDefault.prototype),naji.control.njMapDragZoomIn.prototype.constructor=naji.control.njMapDragZoomIn,naji.control.njMapDragZoomIn.prototype._init=function(){var e=this._this||this;e.interaction=new ol.interaction.DragZoom({condition:ol.events.condition.always,duration:0,out:!1}),e.interaction.setActive(!1),naji.control.njMapControlDefault.prototype._init.call(this)}}(),function(){"use strict";naji.control.njMapDragZoomOut=function(e){var t,a,n=this;return a=e||{},t=naji.control.njMapControlDefault.call(n,a),n._init(),naji.util.njMapUtil.objectMerge(t,{_this:n})},naji.control.njMapDragZoomOut.prototype=Object.create(naji.control.njMapControlDefault.prototype),naji.control.njMapDragZoomOut.prototype.constructor=naji.control.njMapDragZoomOut,naji.control.njMapDragZoomOut.prototype._init=function(){var e=this._this||this;e.interaction=new ol.interaction.DragZoom({condition:ol.events.condition.always,duration:0,out:!0}),e.interaction.setActive(!1),naji.control.njMapControlDefault.prototype._init.call(this)}}(),function(){"use strict";naji.control.njMapEditor=function(e){var t,a,n=this;return this.useSnap=null,this.freehand=null,this.drawType=null,this.featureStyle=null,this.drawingStyle=null,this.useDrawEndDisplay=null,this.vectorLayer=null,this.selectPointMoveInteraction=null,this.selectInteraction=null,this.snapInteraction=null,this.dirty={},a=e||{},t=naji.control.njMapControlDefault.call(n,a),n.useSnap=void 0!==a.useSnap&&a.useSnap,n.freehand=void 0!==a.freehand&&a.freehand,n.featureStyle=void 0!==a.featureStyle?a.featureStyle:void 0,n.drawingStyle=void 0!==a.drawingStyle?a.drawingStyle:n.featureStyle,n.drawType=void 0!==a.drawType?a.drawType:"LineString",n.useDrawEndDisplay=void 0===a.useDrawEndDisplay||a.useDrawEndDisplay,a.noneInit||n._init(),naji.util.njMapUtil.objectMerge(t,{_this:n,clear:n.clear,getLayer:n.getLayer,getFeatures:n.getFeatures,setFeatures:n.setFeatures,removeFeature:n.removeFeature})},naji.control.njMapEditor.prototype=Object.create(naji.control.njMapControlDefault.prototype),naji.control.njMapEditor.prototype.constructor=naji.control.njMapEditor,naji.control.njMapEditor.prototype._init=function(){var n=this._this||this,e=new ol.source.Vector({wrapX:!1});switch(n.vectorLayer=new ol.layer.Vector({zIndex:9999,source:e,style:n.featureStyle}),n.njMap.getMap().addLayer(n.vectorLayer),n.dirty={},n.drawType){case"Point":"Point",null;break;case"LineString":"LineString",null;break;case"Polygon":"Polygon",null;break;case"Circle":"Circle",null;break;case"Box":"Circle",ol.interaction.Draw.createBox();break;default:"Polygon",null}n.selectPointMoveInteraction=new ol.interaction.Select({condition:ol.events.condition.pointerMove}),n.njMap.getMap().addInteraction(n.selectPointMoveInteraction),n.selectInteraction=new ol.interaction.Select({style:new ol.style.Style({stroke:new ol.style.Stroke({color:"#FF2828"})})}),n.njMap.getMap().addInteraction(n.selectInteraction),n.interaction=new ol.interaction.Modify({features:this.selectInteraction.getFeatures()}),n.interaction.setActive(!1),n.selectInteraction.getFeatures().on("add",function(e){e.element.on("change",function(e){n.dirty[e.target.getId()]=!0})}),n.selectInteraction.getFeatures().on("remove",function(e){var t=e.element;if(n.dirty[t.getId()]){delete n.dirty[t.getId()];var a=t.getProperties();delete a.boundedBy,new ol.Feature(a).setId(t.getId())}}),n.useDrawEndDisplay||n.interaction.on("drawend",function(e){setTimeout(function(){n.clear()},1)},this),naji.control.njMapControlDefault.prototype._init.call(this),n.useSnap&&(n.snapInteraction=new ol.interaction.Snap({source:e}),n.njMap.getMap().addInteraction(n.snapInteraction))},naji.control.njMapEditor.prototype.getLayer=function(){return(this._this||this).vectorLayer},naji.control.njMapEditor.prototype.setFeatures=function(e){return(this._this||this).vectorLayer.getSource().setFeatures(e)},naji.control.njMapEditor.prototype.getFeatures=function(){return(this._this||this).vectorLayer.getSource().getFeatures()},naji.control.njMapEditor.prototype.clear=function(){(this._this||this).vectorLayer.getSource().clear()},naji.control.njMapEditor.prototype.removeFeature=function(e){(this._this||this).vectorLayer.getSource().removeFeature(e)},naji.control.njMapEditor.prototype.destroy=function(e){var t=this._this||this;naji.control.njMapControlDefault.prototype.destroy.call(this),t.njMap.getMap().removeInteraction(t.selectPointMoveInteraction),t.njMap.getMap().removeInteraction(t.selectInteraction),t.njMap.getMap().removeInteraction(t.snapInteraction),e&&t.njMap.getMap().removeLayer(t.vectorLayer)}}(),function(){"use strict";naji.control.njMapLengthMeasure=function(e){var t,a,n=this;return(a=e||{}).drawType="LineString",a.useDrawEndDisplay=!0,a.featureStyle=new ol.style.Style({stroke:new ol.style.Stroke({color:"#ffcc33",width:3}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})}),a.drawingStyle=new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2})}),t=naji.control.njMapMeasureDefault.call(n,a),n._init(),naji.util.njMapUtil.objectMerge(t,{_this:n})},naji.control.njMapLengthMeasure.prototype=Object.create(naji.control.njMapMeasureDefault.prototype),naji.control.njMapLengthMeasure.prototype.constructor=naji.control.njMapLengthMeasure,naji.control.njMapLengthMeasure.prototype._init=function(){var r=this._this||this;naji.control.njMapMeasureDefault.prototype._init.call(this),r.continueMsg="길이 측정",r.interaction.on("drawstart",function(e){r.sketch=e.feature;var n=e.coordinate;r.sketchChangeListener=r.sketch.getGeometry().on("change",function(e){var t=e.target,a=r._formatLength(t);n=t.getLastCoordinate(),r.measureTooltipElement.innerHTML=a,r.measureTooltip.setPosition(n)})},this),r.interaction.on("drawend",function(e){var t=r.measureTooltip;r.measureTooltipElement.className="tooltip tooltip-static",r.measureTooltip.setOffset([0,-7]);var a=document.createElement("a");a.href="#",a.className="tooltip-closer",a.onclick=function(){return r.njMap.getMap().removeOverlay(t),r.removeFeature(e.feature),a.blur(),!1},r.measureTooltip.id=e.feature.getId(),r.measureTooltipElement.appendChild(a),r.sketch=null,r.measureTooltipElement=null,r.createMeasureTooltip(),ol.Observable.unByKey(r.sketchChangeListener),r.useModify&&(r.selectInteraction.on("select",function(e){if(e.selected[0]){e.selected[0].setStyle(r.drawingStyle),r.njMap.getMap().removeOverlay(r.removeOverlay(e.selected[0].getId())),r.continueMsg="길이 측정",r.setActive(!0);var t=e.selected[0].getGeometry(),a=r._formatLength(t),n=t.getLastCoordinate();r.sketch=e.selected[0],r.measureTooltip.id=e.selected[0].getId(),r.measureTooltipElement.innerHTML=a,r.measureTooltip.setPosition(n)}if(e.deselected[0]){e.deselected[0].setStyle(r.featureStyle);var i=r.measureTooltip;r.measureTooltipElement.className="tooltip tooltip-static",r.measureTooltip.id=e.deselected[0].getId(),r.measureTooltip.setOffset([0,-7]);var o=document.createElement("a");o.href="#",o.className="tooltip-closer",o.onclick=function(){return r.njMap.getMap().removeOverlay(i),r.removeFeature(e.deselected[0]),o.blur(),!1},r.measureTooltipElement.appendChild(o),r.sketch=null,r.measureTooltipElement=null,r.createMeasureTooltip(),ol.Observable.unByKey(r.sketchChangeListener),r.interaction.setActive(!1),r.interaction.setActive(!0)}}),r.modifyInteraction.on("modifystart",function(e){r.sketch=e.features.getArray()[0],r.measureTooltip.id=r.sketch.getId();var n=e.coordinate;r.sketchChangeListener=r.sketch.getGeometry().on("change",function(e){var t=e.target,a=r._formatLength(t);n=t.getLastCoordinate(),r.measureTooltip&&r.measureTooltipElement&&(r.measureTooltipElement.innerHTML=a,r.measureTooltip.setPosition(n))})}),r.modifyInteraction.on("modifyend",function(e){r.measureTooltip;r.measureTooltipElement.className="tooltip tooltip-measure",r.measureTooltip.id=e.features.getArray()[0].getId(),r.measureTooltip.setOffset([0,-7])}))},this)},naji.control.njMapLengthMeasure.prototype._formatLength=function(e){var t=this._this||this,a=ol.Sphere.getLength(e,{projection:t.njMap.getCRS()});return 100<a?Math.round(a/1e3*100)/100+" km":Math.round(100*a)/100+" m"}}(),function(){"use strict";naji.control.njMapLocation=function(e){var t,a,n=this;return a=e||{},t=naji.control.njMapControlDefault.call(n,a),n._init(),naji.util.njMapUtil.objectMerge(t,{_this:n,setActive:n.setActive})},naji.control.njMapLocation.prototype=Object.create(naji.control.njMapControlDefault.prototype),naji.control.njMapLocation.prototype.constructor=naji.control.njMapLocation,naji.control.njMapLocation.prototype._init=function(){var e=this._this||this;e.interaction=new ol.interaction.DragPan({kinetic:!1}),e.interaction.set("njMapLocation",!1),e.interaction.setActive(!1),naji.control.njMapControlDefault.prototype._init.call(this)},naji.control.njMapLocation.prototype.setActive=function(e){this._this;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){njMap.getMap().getView().setCenter(ol.proj.transform([e.coords.longitude,e.coords.latitude],"EPSG:4326",njMap.getCRS())),njMap.getMap().getView().setZoom(15)},function(e){console.log(e.message)}):naji.njMapConfig.alert_Error("Geolocation을 지원하지 않는 브라우저 입니다.")}}(),function(){"use strict";naji.control.njMapClick=function(e){var t,a,n=this;return a=e||{},t=naji.control.njMapControlDefault.call(n,a),n._init(),naji.util.njMapUtil.objectMerge(t,{_this:n})},naji.control.njMapClick.prototype=Object.create(naji.control.njMapControlDefault.prototype),naji.control.njMapClick.prototype.constructor=naji.control.njMapClick,naji.control.njMapClick.prototype._init=function(){var a=this._this||this;a.interaction=new ol.interaction.Interaction({handleEvent:function(e){var t=!1;e.originalEvent;if(e.type==ol.MapBrowserEventType.SINGLECLICK){e.map;e.preventDefault(),t=!0,a.interaction.dispatchEvent({type:"singleClick",coordinate:e.coordinate})}return!t}}),a.interaction.setActive(!1),naji.control.njMapControlDefault.prototype._init.call(this)}}(),function(){"use strict";naji.control.njMapMousePosition=function(e){var t,a,n=this;return a=e||{},t=naji.control.njMapControlDefault.call(n,a),n._init(),"boolean"==typeof a.active&&n.setActive(a.active),naji.util.njMapUtil.objectMerge(t,{_this:n})},naji.control.njMapMousePosition.prototype=Object.create(naji.control.njMapControlDefault.prototype),naji.control.njMapMousePosition.prototype.constructor=naji.control.njMapMousePosition,naji.control.njMapMousePosition.prototype._init=function(){var e=this._this||this;e.njMap.getMap();e.interaction=new ol.interaction.DragPan({kinetic:!1}),e.interaction.set("njMapMousePosition",!0),e.interaction.setActive(!1),naji.control.njMapControlDefault.prototype._init.call(this)},naji.control.njMapMousePosition.prototype.setActive=function(e){var t=this._this||this;if(t.interaction.getActive()&&!0===e)return!1;if(naji.control.njMapControlDefault.prototype.setActive.call(this,e),e){var a=t.njMap.getMap(),n=a.getViewport(),i=a.getView().getCenter();t.key_pointerdrag=a.on("pointerdrag",function(e){var t=e.frameState.viewState.center;i[0]===t[0]&&i[1]===t[1]||(n.classList.remove("cursor-default"),n.classList.add("cursor-closeHand"))}),t.key_pointerup=a.on("pointerup",function(e){n.classList.remove("cursor-closeHand"),n.classList.add("cursor-default")})}else ol.Observable.unByKey(t.key_pointerup),ol.Observable.unByKey(t.key_pointerdrag)}}(),function(){"use strict";naji.manager.njMapControlManager=function(t){var a=this;return this.njMap=null,this.activeControl=null,this.njMapContrlObjects=null,function(){var e=t||{};if(a.njMapContrlObjects={},a.njMap=void 0!==e.njMap?e.njMap:void 0,!a.njMap)return naji.njMapConfig.alert_Error("njMap undefined");a._init(e.controls)}(),{_this:a,get:a.get,add:a.add}},naji.manager.njMapControlManager.prototype._init=function(e){var t=this._this||this;if(Array.isArray(e))for(var a in e)t.add(e[a])},naji.manager.njMapControlManager.prototype.add=function(t){var a=this._this||this;if(!(t._this instanceof naji.control.njMapControlDefault))return!1;t.getActive()&&(a.activeControl=t),t.setActive=function(e){if(t.getInteraction().getActive()&&!0===e)return!1;e&&(a.activeControl&&a.activeControl.setActive(!1),a.activeControl=t),t._this.setActive(e)},a.njMapContrlObjects[t.getControlKey()]=t},naji.manager.njMapControlManager.prototype.get=function(e){return(this._this||this).njMapContrlObjects[e]},naji.manager.njMapControlManager.prototype.clearFeature=function(e){var t=this._this||this;if(void 0!==e)void 0!==(n=t.njMapContrlObjects[e]).clear&&n.clear();else for(var a in t.njMapContrlObjects){var n;void 0!==(n=t.njMapContrlObjects[e]).clear&&n.clear()}}}(),function(){"use strict";naji.manager.njMapLayerManager=function(t){var a=this;return this.njMap=null,this.useMinMaxZoom=null,this.njMapLayerNTocObjects=null,this.key_changeResolution=null,function(){var e=t||{};if(a.njMap=void 0!==e.njMap?e.njMap:void 0,a.useMinMaxZoom=void 0===e.useMinMaxZoom||e.useMinMaxZoom,a.njMapLayerNTocObjects={},!a.njMap)return naji.njMapConfig.alert_Error("njMap undefined");a.useMinMaxZoom&&a._activeMinMaxZoom()}(),{_this:a,get:a.get,add:a.add,getAll:a.getAll,remove:a.remove,getnjMap:a.getnjMap,scaleVisibleRefresh:a._scaleVisibleRefresh}},naji.manager.njMapLayerManager.prototype._activeMinMaxZoom=function(){var t=this._this||this;t.njMap.getMap().on("change:view",function(e){ol.Observable.unByKey(t.key_changeResolution),t.key_changeResolution=e.target.getView().on("change:resolution",function(e){t._scaleVisibleRefresh()})}),t.key_changeResolution=t.njMap.getMap().getView().on("change:resolution",function(e){t._scaleVisibleRefresh()})},naji.manager.njMapLayerManager.prototype.add=function(e){var t,a=this._this||this,n=e||{},i=void 0!==n.njMapLayer?n.njMapLayer:void 0,o=void 0!==n.njMapToc?n.njMapToc:void 0,r=i.getLayerKey();a.useMinMaxZoom&&(t=i.getOlLayer().on("change:zoom",function(e){var t=a.njMap.getMap().getView();i.getMinZoom()<=t.getZoom()&&t.getZoom()<=i.getMaxZoom()?i.setScaleVisible(!0):i.setScaleVisible(!1)})),a.njMapLayerNTocObjects[r]={zoomChangeListenerKey:t,njMapLayer:i,njMapToc:o},a._scaleVisibleRefresh()},naji.manager.njMapLayerManager.prototype.get=function(e){return(this._this||this).njMapLayerNTocObjects[e]},naji.manager.njMapLayerManager.prototype.getAll=function(e){var t=this._this||this,a=[];for(var n in t.njMapLayerNTocObjects)t.njMapLayerNTocObjects.hasOwnProperty(n)&&(e?a.push(t.njMapLayerNTocObjects[n]):a.push(t.njMapLayerNTocObjects[n].njMapLayer));return a},naji.manager.njMapLayerManager.prototype.remove=function(e){var t=this._this||this,a=t.njMapLayerNTocObjects[e];t.njMap.removeLayer(e),a.njMapToc&&a.njMapToc.remove(),a.zoomChangeListenerKey&&ol.Observable.unByKey(a.zoomChangeListenerKey),delete t.njMapLayerNTocObjects[e]},naji.manager.njMapLayerManager.prototype.getnjMap=function(){return(this._this||this).njMap},naji.manager.njMapLayerManager.prototype._scaleVisibleRefresh=function(){var e=this._this||this,t=e.njMap.getMap().getView();for(var a in e.njMapLayerNTocObjects)if(e.njMapLayerNTocObjects.hasOwnProperty(a)){var n=e.njMapLayerNTocObjects[a].njMapLayer;n.getMinZoom()<=t.getZoom()&&t.getZoom()<=n.getMaxZoom()?n.setScaleVisible(!0):n.setScaleVisible(!1)}}}(),function(){"use strict";naji.manager.njMapUIControlManager=function(t){var a=this;return this.njMap=null,this.defaultControl=null,this.activeControl=null,this.njMapUIContrlObjects=null,function(){var e=t||{};if(a.defaultControl=t.defaultControl,a.njMapUIContrlObjects={},a.njMap=void 0!==e.njMap?e.njMap:void 0,!a.njMap)return naji.njMapConfig.alert_Error("njMap undefined");a._init(e.target,e.controls,e.expendTools)}(),{_this:a,get:a.get,add:a.add}},naji.manager.njMapUIControlManager.prototype._init=function(e,t,a){var n=this._this||this;if(Array.isArray(t))for(var i in t)n.add(e,t[i]);if(void 0!==a&&Array.isArray(a.controls)){var o=document.createElement("div");o.id="extendedToolbarButton",o.title="Toggle extended toolbar";o.addEventListener("click",function(e){""==this.className?(this.className="on",this.nextSibling.className="on"):(this.className="",this.nextSibling.className="")}),document.getElementById(e).appendChild(o);var r=document.createElement("div");for(var i in r.id=a.target,document.getElementById(e).appendChild(r),a.controls)n.add(a.target,a.controls[i]);var s=document.createElement("div");s.id="initializeButton",s.title="initialize";s.addEventListener("click",function(e){for(var t in n.njMapUIContrlObjects){var a=n.njMapUIContrlObjects[t];void 0!==a.clear&&a.clear(),n.njMapUIContrlObjects[t].getElement().className=""}n.activeControl=null,n.defaultControl.setActive(!0)}),document.getElementById(e).appendChild(s)}},naji.manager.njMapUIControlManager.prototype.add=function(e,t){var n=this._this||this;if(!(t._this instanceof naji.control.njMapControlDefault))return!1;var a=t._this.getElement();if(a.njMapUIContrlObjectId=t.getControlKey(),!a)return!1;a.addEventListener("click",function(e){var t=n.get(e.currentTarget.njMapUIContrlObjectId);if("none"===e.currentTarget.eventType)t.setActive(!1),n.activeControl=null,n.defaultControl.setActive(!0);else for(var a in null!==n.activeControl&&n.defaultControl.setActive(!0),t==n.activeControl?(n.activeControl=null,n.defaultControl.setActive(!0)):(n.activeControl=t,n.activeControl.setActive(!0)),n.njMapUIContrlObjects)n.njMapUIContrlObjects[a].getElement().className="",null!==n.activeControl&&n.njMapUIContrlObjects[a].getElement().njMapUIContrlObjectId==n.activeControl.getElement().njMapUIContrlObjectId&&(n.njMapUIContrlObjects[a].getElement().className="on")}),(void 0!==e?document.getElementById(e):document.getElementById("toolbar")).appendChild(a),n.njMapUIContrlObjects[t.getControlKey()]=t},naji.manager.njMapUIControlManager.prototype.get=function(e){return(this._this||this).njMapUIContrlObjects[e]}}();
//# sourceMappingURL=njMapsPlatformScript.min.js.map